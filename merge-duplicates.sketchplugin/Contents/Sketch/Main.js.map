{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/fs/index.js","webpack://exports/./node_modules/@skpm/fs/utils.js","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/d3-color/src/color.js","webpack://exports/./node_modules/d3-color/src/cubehelix.js","webpack://exports/./node_modules/d3-color/src/define.js","webpack://exports/./node_modules/d3-color/src/index.js","webpack://exports/./node_modules/d3-color/src/lab.js","webpack://exports/./node_modules/d3-color/src/math.js","webpack://exports/./node_modules/delta-e/src/dE00.js","webpack://exports/./node_modules/delta-e/src/dE76.js","webpack://exports/./node_modules/delta-e/src/dE94.js","webpack://exports/./node_modules/delta-e/src/index.js","webpack://exports/./node_modules/mocha-js-delegate/index.js","webpack://exports/./node_modules/sketch-module-google-analytics/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/execute-javascript.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/inject-client-messaging.js","webpack://exports/./node_modules/sketch-module-web-view/lib/movable-area.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./resources/mergecolorvariablesfromlist.html","webpack://exports/./resources/mergeduplicatecolorvariables.html","webpack://exports/./resources/mergeduplicatelayerstyles.html","webpack://exports/./resources/mergeduplicatesymbols.html","webpack://exports/./resources/mergeduplicatetextstyles.html","webpack://exports/./resources/mergelayerstylesfromlist.html","webpack://exports/./resources/mergeselectedsymbols.html","webpack://exports/./resources/mergesimilarcolorvariables.html","webpack://exports/./resources/mergesimilarlayerstyles.html","webpack://exports/./resources/mergesimilartextstyles.html","webpack://exports/./resources/mergetextstylesfromlist.html","webpack://exports/./resources/register.html","webpack://exports/./resources/settings.html","webpack://exports/./src/EditSettings.js","webpack://exports/./src/Helpers.js","webpack://exports/./src/Main.js","webpack://exports/./src/MergeColorVariables.js","webpack://exports/./src/MergeDuplicateSymbols.js","webpack://exports/./src/MergeLayerStyles.js","webpack://exports/./src/MergeTextStyles.js","webpack://exports/external \"buffer\"","webpack://exports/external \"events\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["Helpers","require","webviewEsIdentifier","globalSettingsFile","EditSettings","context","optionss","identifier","width","height","show","remembersWindowFrame","titleBarStyle","browserWindow","BrowserWindow","webContents","loadURL","getSettings","once","on","executeJavaScript","getLogsEnabled","getLibrariesEnabled","catch","console","error","s","clog","onShutdown","logsEnabled","librariesEnabledByDefault","_0x238c","jsonDef","MSPluginManager","webviewID","existingWebview","getWebview","close","sketch","dom","ShapePath","Text","DeltaE","D3","fs","track","document","getSelectedDocument","symbols","libraries","getLibraries","settingsFile","timingEnabled","acquiredLicense","valStatus","app","no","over","noCon","commands","mergeduplicatesymbols","mergeselectedsymbols","mergeselectedtextstyles","mergesimilartextstyles","mergeduplicatetextstyles","mergesimilarlayerstyles","mergeselectedlayerstyles","mergeduplicatelayerstyles","mergeduplicatecolorvariables","mergeselectedcolorvariables","mergesimilarcolorvariables","editsettings","sketchlocalfile","libraryPrefix","_0xfc66","curl_async","_0x1622x2","_0x1622x3","_0x1622x4","NSTask","_0x1622x5","NSPipe","_0x1622x6","setTimeout","_0x1622x7","_0x1622x8","_0x1622x9","NSString","NSUTF8StringEncoding","_0x1622xa","_0x1622xb","_0x1622xc","tryParseJSON","_0x1622xd","_0x36d1","IsInTrial","_0x20fax2","jsonFromFile","e","ExiGuthrie","_0x20fax4","Guthrie","_0x20fax6","_0x20fax7","_0x20fax8","toString","jsonString","o","JSON","parse","writeTextToFile","text","filePath","t","stringWithFormat","f","writeFileSync","stringify","encoding","readFromFile","readFileSync","mutable","read","analytics","action","res","ec","ea","shouldEnableContrastMode","color","UI","theme","getTheme","labReferenceColor","lab","labComparisonColor","color1","L","l","A","a","B","b","color2","deltaE","getDeltaE76","parseFloat","getAcquiredLicense","compareStyleArrays","name","compareColorVariableArrays","compareByName","FindSimilarTextStyles","referenceStyle","styles","checkSameFont","checkSameWeight","checkSameSize","checkSameColor","checkSameParagraphSpacing","checkSameLineHeight","checkSameAlignment","checkSameCharacterSpacing","similarStyles","forEach","style","textStyle","sameFont","fontFamily","sameWeight","fontWeight","sameSize","fontSize","sameColor","textColor","sameParagraphSpacing","paragraphSpacing","sameLineHeight","lineHeight","sameAlignment","alignment","sameCharacterSpacing","kerning","isSimilar","push","FindAllSimilarTextStyles","includeAllStylesFromExternalLibraries","stylesWithSimilarStyles","stylesAlreadyProcessed","definedTextStyles","getDefinedTextStyles","i","length","libraryName","localeCompare","indexOf","thisStyleSimilarStyles","processedStyle","unshift","FindSimilarLayerStyles","checkSameFillColor","checkSameBorderColor","checkSameBorderThickness","checkSameShadowColor","checkSameShadowParams","layerStyle","sameFillColor","fills","substring","toUpperCase","sameBorderColor","borders","sameBorderThickness","thickness","sameShadowColor","shadows","sameShadowParams","x","y","blur","spread","FindAllSimilarLayerStyles","definedLayerStyles","getDefinedLayerStyles","areColorsSimilar","tolerance","FindSimilarColorVariables","colorVariableRef","colorVariables","similarColorVariables","colorVariable","FindAllSimilarColorVariables","includeExternalLibraries","colorVariablesWithSimilarColorVariables","colorVariablesAlreadyProcessed","definedColorVariables","getDefinedColorVariables","thisColorvariableSimilarOnes","processedColorVariable","GetRecomposedSymbolName","symbolName","recomposedSymbolName","j","charAt","getSymbolInstances","symbolMaster","symbolInstances","getAllInstances","getSymbolOverrides","idsMap","symbolOverrides","allInstances","find","reducedInstances","filter","instance","hasSymbolOverrides","instanceOverrides","overrides","ov","property","isDefault","value","symbolId","override","getLayerStyleInstances","layerStyleInstances","getAllInstancesLayers","localStyle","concat","getLayerStyleOverrides","styleOverrides","hasSharedStyleOverrides","sketchObject","count","redId0","redId1","redId2","has","getTextStyleInstances","textStyleInstances","getTextStyleOverrides","countAllSymbols","includeAllSymbolsFromExternalLibraries","getSymbols","counter","lib","id","enabled","documentData","objectID","foreignSymbols","getDocument","getAllDuplicateSymbolsByName","duplicatedSymbols","namesMap","Map","symbol","symbolObject","duplicates","getLibrary","set","get","removeElement","allForeign","duplicate","isForeign","index","splice","sort","getSymbolsMap","symbolMap","duplicatedSymbol","instancesWithOverrides","getLayerStylesMap","layerStyles","layerStylesMap","log","duplicatedStyle","getSimpleLayerStylesMap","getTextStylesMap","textStyles","textStylesMap","updateAllDuplicatesWithMap","allDuplicates","symbolsMap","directInstances","FindNestedSymbolOverride","hasOverride","key","symbolID","FindNestedSharedStyleOverride","level","logger","__NSDictionaryM","key2","importSymbolFromLibrary","element","symbolReferences","library","getImportableSymbolReferencesForDocument","refToImport","ref","import","importLayerStyleFromLibrary","dlog","styleReferences","getImportableLayerStyleReferencesForDocument","importTextStyleFromLibrary","getImportableTextStyleReferencesForDocument","importColorVariableFromLibrary","colorVariableReferences","getImportableSwatchReferencesForDocument","colorVar","getReducedDuplicateData","reducedDuplicate","thumbnail","numInstances","numOverrides","getReducedLayerStyleData","isHidden","description","contrastMode","isSelected","getReducedTextStyleData","getSelectedSymbolsSession","selection","symbolObjects","docSymbol","foreignLib","getThumbnail","getReducedSymbolsSession","session","reducedSession","sessionItem","getDuplicateColorVariables","includeLibraries","allColorVariables","getAllColorVariables","nameDictionary","duplicateColorVariables","alreadyAddedIDs","colorVariableObject","getColorVariableThumbnail","Object","keys","GetSpecificLayerStyleData","ctime","totalInstances","totalOverrides","layerStyleMapItem","getOvalThumbnail","styleInstances","ctimeEnd","GetSpecificTextStyleData","textStyleMapItem","getTextThumbnail","GetSpecificSymbolData","symbolMapItem","getTextStyleDescription","sharedTextStyle","getLayerStyleDescription","sharedStyle","textInfo","getTextStyleColor","attributes","MSAttributedStringColorAttribute","hexValue","oval","shapeType","ShapeType","Oval","frame","Rectangle","parent","selectedPage","options","scales","formats","output","buffer","export","image64","remove","getAllLayerStyles","allStyles","idsPlusLibraryMap","sharedLayerStyles","sharedLayerStyle","id1","id2","layerStyleObject","id1Comparison","id2Comparison","addedBy","getAllTextStyles","redundantIdsMap","sharedTextStyles","redundantIn","textStyleObject","map","swatches","swatch","getAllDuplicateLayerStylesByName","includeAllLayerStylesFromExternalLibraries","duplicatedLayerStyles","styleObject","dup","getAllDuplicateTextStylesByName","duplicatedTextStyles","getImageData64","data","imageData","mimeType","base64EncodedStringWithOptions","getNSImageData","nsImage","cgRef","CGImageForProposedRect_context_hints","nil","newRep","NSBitmapImageRep","alloc","initWithCGImage","setSize","size","pngData","representationUsingType_properties","NSPNGFileType","component","instances","originLibrary","libDocument","getLayerWithID","message","time","timeEnd","getTimingEnabled","_0x684b","LoadSettings","module","exports","MergeSymbols","MergeLayerStyles","MergeTextStyles","MergeColorVariables","Settings","webviewRegIdentifier","globalRemainingDays","globalIsInTrial","globalIsExpired","globalIsOver","globalCommand","MergeDuplicateSymbols","onValidate","MergeSelectedSymbols","MergeSelectedTextStyles","MergeSimilarTextStyles","MergeDuplicateTextStyles","MergeSelectedLayerStyles","MergeSimilarLayerStyles","MergeDuplicateLayerStyles","MergeDuplicateColorVariables","MergeSelectedColorVariables","MergeSimilarColorVariables","_0x1647","_0x8a0ax2","_0x8a0ax3","triggerMethod","showRegistration","_0x8a0ax4","_0x8a0ax5","Date","parseInt","_0x8a0ax6","_0x8a0ax7","Math","version","pluginManager","NSApp","delegate","plugin","plugins","objectForKey","regWindow","webContentsReg","_0x4e9d","_0xf514x1","_0xf514x2","_0xf514x3","_0xf514x4","NSWorkspace","sharedWorkspace","openURL","NSURL","URLWithString","webviewMDCVIdentifier","webviewMCVFLIdentifier","webviewMSCVIdentifier","checkingAlsoLibraries","currentSelectedColorVariables","colorVariableToKeepIndex","layersChangedCounter","stylesChangedCounter","colorVariableToKeep","colorVariableToApply","colorVariablesToRemove","existingCV","sw","doUseColorSwatchesInLayers","doUseColorSwatchesInStyles","colorVariableToRemove","removeAtIndex","allLayers","layer","type","item","fillType","cvToRemove","referencingColor","stylesCanBeUpdated","lsMap","tsMap","allLayerStyles","styleAffected","styleInstance","isOutOfSyncWithSharedStyle","allTextStyles","currentStyle","pair","syncWithSharedStyle","onlyDuplicatedColorVariables","mergeSession","CalculateDuplicates","colorVariableWithDuplicates","editedMergeSession","variablesSolved","affected","isUnchecked","selectedIndex","results","layersUpdated","layerStylesUpdated","textStylesUpdated","GetMergeResultMessage","definedAllColorVariables","colorVariableCounter","editedGlobalColorVariables","isChosen","editedColorVariablesWithSimilarColorVariables","includeAllLibraries","webviewIdentifier","webviewMSSIdentifier","symbolToMerge","symbolToKeep","basePercent","totalToMerge","symbolsToRemove","symbolToApply","instancesChanged","overridesChanged","symbolsRemoved","alreadyInDoc","sym","tasksToPerform","tasksExecuted","instancesToChange","overridesToChange","instOverMap","instancesOfSymbol","externalLibrary","unlinkFromLibrary","setOverrideValue","progress","floor","message2","getParentArtboard","master","symbolToRemove","mssmergeSession","selectedLayers","layers","areAllSymbols","reducedMergeSession","mergeResults","replacedStuff","mergeSessionMap","numberOfSymbols","documentInstances","reducedSymbol","duplicatesSolved","mergedSymbols","ems","symbolWithDuplicates","mergeobject","localMergeResults","webviewMLSFLIdentifier","webviewMDLSIdentifier","webviewMSLSIdentifier","stylesToMerge","styleToKeep","stylesToRemove","styleToApply","stylesRemoved","localStyleDirectInstances","instancesOfStyle","isInDocument","sharedStylesToRemove","isMarkedForRemove","sharedStyleToRemove","styleIndex","findIndex","sL","str","onlyDuplicatedLayerStyles","reducedStyle","layerStyleWithDuplicates","styleCounter","librariesEnabled","editedGlobalLayerStyles","editedStylesWithSimilarStyles","checkSameShadowXYBlurSpread","webviewMTSFLIdentifier","webviewMDTSIdentifier","webviewMSTSIdentifier","currentSelectedStyles","ls","onlyDuplicatedTextStyles","textStyleWithDuplicates","editedGlobalTextStyles"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA,aAAa,mBAAO,CAAC,sBAAQ;AAC7B,YAAY,mBAAO,CAAC,iDAAS;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AClbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9JA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC9QA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;;AAEpC;;AAEA;AACA;;AAEP;AACA;AACA;AACA,yBAAyB,IAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAAM;AACN;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM;AACvB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM;AACvB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACyB;AACzB;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,6CAAG,OAAO,4DAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gDAAO;AACzC;AACA;;AAEe;AACf;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,uBAAuB,yDAAM,CAAC,+CAAK;AACzC;AACA,oBAAoB,kDAAQ,YAAY,kDAAQ;AAChD;AACA,GAAG;AACH;AACA,oBAAoB,gDAAM,YAAY,gDAAM;AAC5C;AACA,GAAG;AACH;AACA,iDAAiD,gDAAO;AACxD;AACA;AACA;AACA;AACA,eAAe,6CAAG;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC5DD;AAAA;AAAe;AACf;AACA;AACA,CAAC;;AAEM;AACP;AACA;AACA;AACA;;;;;;;;;;;;;ACTA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACE;AACJ;;;;;;;;;;;;;ACFpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACO;AACP;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,6CAAG,OAAO,4DAAU;AACzC;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEe;AACf;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM,CAAC,+CAAK;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6CAAG;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iCAAiC,gDAAO;AACxC;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,gDAAO;AACvB;AACA;;AAEA,0DAAM,WAAW,yDAAM,CAAC,+CAAK;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC1HD;AAAA;AAAA;AAAO;AACA;;;;;;;;;;;;;ACDM;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA,sB;;;;;;;;;;;;ACxTa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sB;;;;;;;;;;;;AC7Ca;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sB;;;;;;;;;;;;AC3Ha;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA,WAAW,mBAAO,CAAC,kDAAQ;AAC3B,WAAW,mBAAO,CAAC,kDAAQ;AAC3B,WAAW,mBAAO,CAAC,kDAAQ;;AAE3B;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4B;;;;;;;;;;;ACjGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,wDAAwD,EAAE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,uCAAuC;AACvC;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC/FA,eAAe,mBAAO,CAAC,wCAAiB;;AAExC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,+BAA+B;AACnE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,+BAA+B;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAoC,aAAa;AACjD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClmBA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,QAAQ;AACR,gBAAgB;AAChB,MAAM,eAAe;AACrB,0CAA0C,cAAc;AACxD,MAAM;AACN;AACA;;;;;;;;;;;;ACrBA,+DAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,YAAY;AACZ,gCAAgC;AAChC,wFAAwF;AACxF,qCAAqC;AACrC;AACA;AACA,mBAAmB;AACnB,YAAY;AACZ,kCAAkC;AAClC;AACA;AACA,kBAAkB;AAClB,YAAY;AACZ,UAAU,OAAO;AACjB;AACA;AACA,kBAAkB;AAClB,UAAU;AACV,QAAQ,cAAc;AACtB;AACA;AACA,kBAAkB;AAClB,QAAQ;AACR,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,sBAAsB,mBAAO,CAAC,+EAAe;AAC7C,kBAAkB,mBAAO,CAAC,+EAAe;AACzC,uBAAuB,mBAAO,CAAC,6EAAc;AAC7C,yBAAyB,mBAAO,CAAC,iGAAwB;AACzD,4BAA4B,mBAAO,CAAC,uGAA2B;AAC/D,kBAAkB,mBAAO,CAAC,iFAAgB;AAC1C,wBAAwB,mBAAO,CAAC,6FAAsB;AACtD,mBAAmB,mBAAO,CAAC,mFAAiB;;AAE5C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC1VA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,qDAAqD;AACrD,gDAAgD;AAChD,uBAAuB;AACvB;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxBA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,mBAAmB;AACnB,yDAAyD;AACzD;AACA,kCAAkC;AAClC,2CAA2C,4BAA4B,eAAe;AACtF,gCAAgC,yBAAyB,cAAc;AACvE;AACA,OAAO;AACP;AACA,8BAA8B,eAAe;AAC7C,qDAAqD,SAAS;AAC9D;AACA;AACA,QAAQ;AACR,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;AC/DA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClBA,gBAAgB,mBAAO,CAAC,oEAAmB;AAC3C,wBAAwB,mBAAO,CAAC,2FAAqB;AACrD,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,2CAA2C;AAC3C,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;;AAEV;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;ACpUA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,wBAAwB,mBAAO,CAAC,6FAAsB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA,QAAQ,kCAAkC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACrOA;AACA;;AAEA;AACA,SAAS,mBAAO,CAAC,iEAAO;AACxB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClCA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA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","file":"Main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/Main.js\");\n","// TODO: async. Should probably be done with NSFileHandle and some notifications\n// TODO: file descriptor. Needs to be done with NSFileHandle\nvar Buffer = require(\"buffer\").Buffer;\nvar utils = require(\"./utils\");\nvar parseStat = utils.parseStat;\nvar fsError = utils.fsError;\nvar fsErrorForPath = utils.fsErrorForPath;\nvar encodingFromOptions = utils.encodingFromOptions;\nvar NOT_IMPLEMENTED = utils.NOT_IMPLEMENTED;\n\nmodule.exports.constants = {\n  F_OK: 0,\n  R_OK: 4,\n  W_OK: 2,\n  X_OK: 1\n};\n\nmodule.exports.access = NOT_IMPLEMENTED(\"access\");\n\nmodule.exports.accessSync = function(path, mode) {\n  mode = mode | 0;\n  var fileManager = NSFileManager.defaultManager();\n\n  switch (mode) {\n    case 0:\n      canAccess = module.exports.existsSync(path);\n      break;\n    case 1:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 2:\n      canAccess = Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 3:\n      canAccess =\n        Boolean(Number(fileManager.isExecutableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 4:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path)));\n      break;\n    case 5:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 6:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 7:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n  }\n\n  if (!canAccess) {\n    throw new Error(\"Can't access \" + String(path));\n  }\n};\n\nmodule.exports.appendFile = NOT_IMPLEMENTED(\"appendFile\");\n\nmodule.exports.appendFileSync = function(file, data, options) {\n  if (!module.exports.existsSync(file)) {\n    return module.exports.writeFileSync(file, data, options);\n  }\n\n  var handle = NSFileHandle.fileHandleForWritingAtPath(file);\n  handle.seekToEndOfFile();\n\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  handle.writeData(nsdata);\n};\n\nmodule.exports.chmod = NOT_IMPLEMENTED(\"chmod\");\n\nmodule.exports.chmodSync = function(path, mode) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFilePosixPermissions: mode\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.chown = NOT_IMPLEMENTED(\"chown\");\nmodule.exports.chownSync = NOT_IMPLEMENTED(\"chownSync\");\n\nmodule.exports.close = NOT_IMPLEMENTED(\"close\");\nmodule.exports.closeSync = NOT_IMPLEMENTED(\"closeSync\");\n\nmodule.exports.copyFile = NOT_IMPLEMENTED(\"copyFile\");\n\nmodule.exports.copyFileSync = function(path, dest, flags) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.copyItemAtPath_toPath_error(path, dest, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.createReadStream = NOT_IMPLEMENTED(\"createReadStream\");\nmodule.exports.createWriteStream = NOT_IMPLEMENTED(\"createWriteStream\");\n\nmodule.exports.exists = NOT_IMPLEMENTED(\"exists\");\n\nmodule.exports.existsSync = function(path) {\n  var fileManager = NSFileManager.defaultManager();\n  return Boolean(Number(fileManager.fileExistsAtPath(path)));\n};\n\nmodule.exports.fchmod = NOT_IMPLEMENTED(\"fchmod\");\nmodule.exports.fchmodSync = NOT_IMPLEMENTED(\"fchmodSync\");\nmodule.exports.fchown = NOT_IMPLEMENTED(\"fchown\");\nmodule.exports.fchownSync = NOT_IMPLEMENTED(\"fchownSync\");\nmodule.exports.fdatasync = NOT_IMPLEMENTED(\"fdatasync\");\nmodule.exports.fdatasyncSync = NOT_IMPLEMENTED(\"fdatasyncSync\");\nmodule.exports.fstat = NOT_IMPLEMENTED(\"fstat\");\nmodule.exports.fstatSync = NOT_IMPLEMENTED(\"fstatSync\");\nmodule.exports.fsync = NOT_IMPLEMENTED(\"fsync\");\nmodule.exports.fsyncSync = NOT_IMPLEMENTED(\"fsyncSync\");\nmodule.exports.ftruncate = NOT_IMPLEMENTED(\"ftruncate\");\nmodule.exports.ftruncateSync = NOT_IMPLEMENTED(\"ftruncateSync\");\nmodule.exports.futimes = NOT_IMPLEMENTED(\"futimes\");\nmodule.exports.futimesSync = NOT_IMPLEMENTED(\"futimesSync\");\n\nmodule.exports.lchmod = NOT_IMPLEMENTED(\"lchmod\");\nmodule.exports.lchmodSync = NOT_IMPLEMENTED(\"lchmodSync\");\nmodule.exports.lchown = NOT_IMPLEMENTED(\"lchown\");\nmodule.exports.lchownSync = NOT_IMPLEMENTED(\"lchownSync\");\n\nmodule.exports.link = NOT_IMPLEMENTED(\"link\");\n\nmodule.exports.linkSync = function(existingPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.linkItemAtPath_toPath_error(existingPath, newPath, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(existingPath, undefined, err.value());\n  }\n};\n\nmodule.exports.lstat = NOT_IMPLEMENTED(\"lstat\");\n\nmodule.exports.lstatSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.attributesOfItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return parseStat(result);\n};\n\nmodule.exports.mkdir = NOT_IMPLEMENTED(\"mkdir\");\n\nmodule.exports.mkdirSync = function(path, options) {\n  var mode = 0o777;\n  var recursive = false;\n  if (options && options.mode) {\n    mode = options.mode;\n  }\n  if (options && options.recursive) {\n    recursive = options.recursive;\n  }\n  if (typeof options === \"number\") {\n    mode = options;\n  }\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.createDirectoryAtPath_withIntermediateDirectories_attributes_error(\n    path,\n    recursive,\n    {\n      NSFilePosixPermissions: mode\n    },\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.mkdtemp = NOT_IMPLEMENTED(\"mkdtemp\");\n\nmodule.exports.mkdtempSync = function(path) {\n  function makeid() {\n    var text = \"\";\n    var possible =\n      \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 6; i++)\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n  }\n  var tempPath = path + makeid();\n  module.exports.mkdirSync(tempPath);\n  return tempPath;\n};\n\nmodule.exports.open = NOT_IMPLEMENTED(\"open\");\nmodule.exports.openSync = NOT_IMPLEMENTED(\"openSync\");\n\nmodule.exports.read = NOT_IMPLEMENTED(\"read\");\n\nmodule.exports.readdir = NOT_IMPLEMENTED(\"readdir\");\n\nmodule.exports.readdirSync = function(path, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n  var fileManager = NSFileManager.defaultManager();\n  var paths = fileManager.subpathsAtPath(path);\n  var arr = [];\n  for (var i = 0; i < paths.length; i++) {\n    var pathName = paths[i];\n    arr.push(encoding === \"buffer\" ? Buffer.from(pathName) : String(pathName));\n  }\n  return arr;\n};\n\nmodule.exports.readFile = NOT_IMPLEMENTED(\"readFile\");\n\nmodule.exports.readFileSync = function(path, options) {\n  var encoding = encodingFromOptions(options, \"buffer\");\n  var fileManager = NSFileManager.defaultManager();\n  var data = fileManager.contentsAtPath(path);\n  if (!data) {\n    throw fsErrorForPath(path, false);\n  }\n\n  var buffer = Buffer.from(data);\n\n  if (encoding === \"buffer\") {\n    return buffer;\n  } else if (encoding === \"NSData\") {\n    return buffer.toNSData();\n  } else {\n    return buffer.toString(encoding);\n  }\n};\n\nmodule.exports.readlink = NOT_IMPLEMENTED(\"readlink\");\n\nmodule.exports.readlinkSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.destinationOfSymbolicLinkAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return String(result);\n};\n\nmodule.exports.readSync = NOT_IMPLEMENTED(\"readSync\");\n\nmodule.exports.realpath = NOT_IMPLEMENTED(\"realpath\");\nmodule.exports.realpath.native = NOT_IMPLEMENTED(\"realpath.native\");\n\nmodule.exports.realpathSync = function(path) {\n  return String(NSString.stringWithString(path).stringByResolvingSymlinksInPath());\n};\n\nmodule.exports.realpathSync.native = NOT_IMPLEMENTED(\"realpathSync.native\");\n\nmodule.exports.rename = NOT_IMPLEMENTED(\"rename\");\n\nmodule.exports.renameSync = function(oldPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.moveItemAtPath_toPath_error(oldPath, newPath, err);\n\n  var error = err.value();\n\n  if (error !== null) {\n    // if there is already a file, we need to overwrite it\n    if (\n      String(error.domain()) === \"NSCocoaErrorDomain\" &&\n      Number(error.code()) === 516\n    ) {\n      var err2 = MOPointer.alloc().init();\n      fileManager.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(\n        NSURL.fileURLWithPath(newPath),\n        NSURL.fileURLWithPath(oldPath),\n        null,\n        NSFileManagerItemReplacementUsingNewMetadataOnly,\n        null,\n        err2\n      );\n      if (err2.value() !== null) {\n        throw fsErrorForPath(oldPath, undefined, err2.value());\n      }\n    } else {\n      throw fsErrorForPath(oldPath, undefined, error);\n    }\n  }\n};\n\nmodule.exports.rmdir = NOT_IMPLEMENTED(\"rmdir\");\n\nmodule.exports.rmdirSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (!isDirectory) {\n    throw fsError(\"ENOTDIR\", {\n      path: path,\n      syscall: \"rmdir\"\n    });\n  }\n  fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, true, err.value(), \"rmdir\");\n  }\n};\n\nmodule.exports.stat = NOT_IMPLEMENTED(\"stat\");\n\n// the only difference with lstat is that we resolve symlinks\n//\n// > lstat() is identical to stat(), except that if pathname is a symbolic\n// > link, then it returns information about the link itself, not the file\n// > that it refers to.\n// http://man7.org/linux/man-pages/man2/lstat.2.html\nmodule.exports.statSync = function(path) {\n  return module.exports.lstatSync(module.exports.realpathSync(path));\n};\n\nmodule.exports.symlink = NOT_IMPLEMENTED(\"symlink\");\n\nmodule.exports.symlinkSync = function(target, path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.createSymbolicLinkAtPath_withDestinationPath_error(\n    path,\n    target,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.truncate = NOT_IMPLEMENTED(\"truncate\");\n\nmodule.exports.truncateSync = function(path, len) {\n  var hFile = NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);\n  hFile.truncateFileAtOffset(len || 0);\n  hFile.closeFile();\n};\n\nmodule.exports.unlink = NOT_IMPLEMENTED(\"unlink\");\n\nmodule.exports.unlinkSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (isDirectory) {\n    throw fsError(\"EPERM\", {\n      path: path,\n      syscall: \"unlink\"\n    });\n  }\n  var result = fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.unwatchFile = NOT_IMPLEMENTED(\"unwatchFile\");\n\nmodule.exports.utimes = NOT_IMPLEMENTED(\"utimes\");\n\nmodule.exports.utimesSync = function(path, aTime, mTime) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFileModificationDate: aTime\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.watch = NOT_IMPLEMENTED(\"watch\");\nmodule.exports.watchFile = NOT_IMPLEMENTED(\"watchFile\");\n\nmodule.exports.write = NOT_IMPLEMENTED(\"write\");\n\nmodule.exports.writeFile = NOT_IMPLEMENTED(\"writeFile\");\n\nmodule.exports.writeFileSync = function(path, data, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  nsdata.writeToFile_atomically(path, true);\n};\n\nmodule.exports.writeSync = NOT_IMPLEMENTED(\"writeSync\");\n","module.exports.parseStat = function parseStat(result) {\n  return {\n    dev: String(result.NSFileDeviceIdentifier),\n    // ino: 48064969, The file system specific \"Inode\" number for the file.\n    mode: result.NSFileType | result.NSFilePosixPermissions,\n    nlink: Number(result.NSFileReferenceCount),\n    uid: String(result.NSFileOwnerAccountID),\n    gid: String(result.NSFileGroupOwnerAccountID),\n    // rdev: 0, A numeric device identifier if the file is considered \"special\".\n    size: Number(result.NSFileSize),\n    // blksize: 4096, The file system block size for i/o operations.\n    // blocks: 8, The number of blocks allocated for this file.\n    atimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    mtimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    ctimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    birthtimeMs:\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000,\n    atime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ), // the 0.5 comes from the node source. Not sure why it's added but in doubt...\n    mtime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    ctime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    birthtime: new Date(\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    isBlockDevice: function() {\n      return result.NSFileType === NSFileTypeBlockSpecial;\n    },\n    isCharacterDevice: function() {\n      return result.NSFileType === NSFileTypeCharacterSpecial;\n    },\n    isDirectory: function() {\n      return result.NSFileType === NSFileTypeDirectory;\n    },\n    isFIFO: function() {\n      return false;\n    },\n    isFile: function() {\n      return result.NSFileType === NSFileTypeRegular;\n    },\n    isSocket: function() {\n      return result.NSFileType === NSFileTypeSocket;\n    },\n    isSymbolicLink: function() {\n      return result.NSFileType === NSFileTypeSymbolicLink;\n    }\n  };\n};\n\nvar ERRORS = {\n  EPERM: {\n    message: \"operation not permitted\",\n    errno: -1\n  },\n  ENOENT: {\n    message: \"no such file or directory\",\n    errno: -2\n  },\n  EACCES: {\n    message: \"permission denied\",\n    errno: -13\n  },\n  ENOTDIR: {\n    message: \"not a directory\",\n    errno: -20\n  },\n  EISDIR: {\n    message: \"illegal operation on a directory\",\n    errno: -21\n  }\n};\n\nfunction fsError(code, options) {\n  var error = new Error(\n    code +\n      \": \" +\n      ERRORS[code].message +\n      \", \" +\n      (options.syscall || \"\") +\n      (options.path ? \" '\" + options.path + \"'\" : \"\")\n  );\n\n  Object.keys(options).forEach(function(k) {\n    error[k] = options[k];\n  });\n\n  error.code = code;\n  error.errno = ERRORS[code].errno;\n\n  return error;\n}\n\nmodule.exports.fsError = fsError;\n\nmodule.exports.fsErrorForPath = function fsErrorForPath(\n  path,\n  shouldBeDir,\n  err,\n  syscall\n) {\n  var fileManager = NSFileManager.defaultManager();\n  var doesExist = fileManager.fileExistsAtPath(path);\n  if (!doesExist) {\n    return fsError(\"ENOENT\", {\n      path: path,\n      syscall: syscall || \"open\"\n    });\n  }\n  var isReadable = fileManager.isReadableFileAtPath(path);\n  if (!isReadable) {\n    return fsError(\"EACCES\", {\n      path: path,\n      syscall: syscall || \"open\"\n    });\n  }\n  if (typeof shouldBeDir !== \"undefined\") {\n    var isDirectory = module.exports.lstatSync(path).isDirectory();\n    if (isDirectory && !shouldBeDir) {\n      return fsError(\"EISDIR\", {\n        path: path,\n        syscall: syscall || \"read\"\n      });\n    } else if (!isDirectory && shouldBeDir) {\n      return fsError(\"ENOTDIR\", {\n        path: path,\n        syscall: syscall || \"read\"\n      });\n    }\n  }\n  return new Error(err || \"Unknown error while manipulating \" + path);\n};\n\nmodule.exports.encodingFromOptions = function encodingFromOptions(\n  options,\n  defaultValue\n) {\n  return options && options.encoding\n    ? String(options.encoding)\n    : options\n    ? String(options)\n    : defaultValue;\n};\n\nmodule.exports.NOT_IMPLEMENTED = function NOT_IMPLEMENTED(name) {\n  return function() {\n    throw new Error(\n      \"fs.\" +\n        name +\n        \" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs\"\n    );\n  };\n};\n","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? new Rgb(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? new Rgb((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color.js\";\nimport {deg2rad, rad2deg} from \"./math.js\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","export {default as color, rgb, hsl} from \"./color.js\";\nexport {default as lab, hcl, lch, gray} from \"./lab.js\";\nexport {default as cubehelix} from \"./cubehelix.js\";\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {deg2rad, rad2deg} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nvar K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * rad2deg;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * deg2rad;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","export var deg2rad = Math.PI / 180;\nexport var rad2deg = 180 / Math.PI;\n","'use strict';\r\n\r\n/**\r\n * @class dE00\r\n * @classdesc\r\n * The CIE2000 color difference algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIEDE2000\r\n * @constructs dE00\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @example\r\n * var deltaE = new dE00(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE00(x1, x2, weights) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n    \r\n    this.weights = weights || {};\r\n    this.ksubL = this.weights.lightness || 1;\r\n    this.ksubC = this.weights.chroma || 1;\r\n    this.ksubH = this.weights.hue || 1;\r\n    \r\n    // Delta L Prime\r\n    this.deltaLPrime = x2.L - x1.L;\r\n    \r\n    // L Bar\r\n    this.LBar = (x1.L + x2.L) / 2;\r\n    \r\n    // C1 & C2\r\n    this.C1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    this.C2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    \r\n    // C Bar\r\n    this.CBar = (this.C1 + this.C2) / 2;\r\n    \r\n    // A Prime 1\r\n    this.aPrime1 = x1.A +\r\n        (x1.A / 2) *\r\n        (1 - sqrt(\r\n            pow(this.CBar, 7) /\r\n            (pow(this.CBar, 7) + pow(25, 7))\r\n        ));\r\n\r\n    // A Prime 2\r\n    this.aPrime2 = x2.A +\r\n        (x2.A / 2) *\r\n        (1 - sqrt(\r\n            pow(this.CBar, 7) /\r\n            (pow(this.CBar, 7) + pow(25, 7))\r\n        ));\r\n\r\n    // C Prime 1\r\n    this.CPrime1 = sqrt(\r\n        pow(this.aPrime1, 2) +\r\n        pow(x1.B, 2)\r\n    );\r\n    \r\n    // C Prime 2\r\n    this.CPrime2 = sqrt(\r\n        pow(this.aPrime2, 2) +\r\n        pow(x2.B, 2)\r\n    );\r\n    \r\n    // C Bar Prime\r\n    this.CBarPrime = (this.CPrime1 + this.CPrime2) / 2;\r\n    \r\n    // Delta C Prime\r\n    this.deltaCPrime = this.CPrime2 - this.CPrime1;\r\n    \r\n    // S sub L\r\n    this.SsubL = 1 + (\r\n        (0.015 * pow(this.LBar - 50, 2)) /\r\n        sqrt(20 + pow(this.LBar - 50, 2))\r\n    );\r\n    \r\n    // S sub C\r\n    this.SsubC = 1 + 0.045 * this.CBarPrime;\r\n    \r\n    /**\r\n     * Properties set in getDeltaE method, for access to convenience functions\r\n     */\r\n    // h Prime 1\r\n    this.hPrime1 = 0;\r\n    \r\n    // h Prime 2\r\n    this.hPrime2 = 0;\r\n    \r\n    // Delta h Prime\r\n    this.deltahPrime = 0;\r\n    \r\n    // Delta H Prime\r\n    this.deltaHPrime = 0;\r\n    \r\n    // H Bar Prime\r\n    this.HBarPrime = 0;\r\n    \r\n    // T\r\n    this.T = 0;\r\n    \r\n    // S sub H\r\n    this.SsubH = 0;\r\n    \r\n    // R sub T\r\n    this.RsubT = 0;\r\n}\r\n\r\n/**\r\n * Returns the deltaE value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getDeltaE = function() {\r\n    var sqrt = Math.sqrt;\r\n    var sin = Math.sin;\r\n    var pow = Math.pow;\r\n    \r\n    // h Prime 1\r\n    this.hPrime1 = this.gethPrime1();\r\n    \r\n    // h Prime 2\r\n    this.hPrime2 = this.gethPrime2();\r\n    \r\n    // Delta h Prime\r\n    this.deltahPrime = this.getDeltahPrime();\r\n    \r\n    // Delta H Prime\r\n    this.deltaHPrime = 2 * sqrt(this.CPrime1 * this.CPrime2) * sin(this.degreesToRadians(this.deltahPrime) / 2);\r\n    \r\n    // H Bar Prime\r\n    this.HBarPrime = this.getHBarPrime();\r\n    \r\n    // T\r\n    this.T = this.getT();\r\n    \r\n    // S sub H\r\n    this.SsubH = 1 + 0.015 * this.CBarPrime * this.T;\r\n    \r\n    // R sub T\r\n    this.RsubT = this.getRsubT();\r\n    \r\n    // Put it all together!\r\n    var lightness = this.deltaLPrime / (this.ksubL * this.SsubL);\r\n    var chroma = this.deltaCPrime / (this.ksubC * this.SsubC);\r\n    var hue = this.deltaHPrime / (this.ksubH * this.SsubH);\r\n   \r\n    return sqrt(\r\n        pow(lightness, 2) +\r\n        pow(chroma, 2) +\r\n        pow(hue, 2) +\r\n        this.RsubT * chroma * hue\r\n    );\r\n};\r\n\r\n/**\r\n * Returns the RT variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getRsubT = function() {\r\n    var sin = Math.sin;\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    var exp = Math.exp;\r\n    \r\n    return -2 *\r\n        sqrt(\r\n            pow(this.CBarPrime, 7) /\r\n            (pow(this.CBarPrime, 7) + pow(25, 7))\r\n        ) *\r\n        sin(this.degreesToRadians(\r\n            60 *\r\n            exp(\r\n                -(\r\n                    pow(\r\n                        (this.HBarPrime - 275) / 25, 2\r\n                    )\r\n                )\r\n            )\r\n        ));\r\n};\r\n\r\n/**\r\n * Returns the T variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getT = function() {\r\n    var cos = Math.cos;\r\n    \r\n    return 1 -\r\n        0.17 * cos(this.degreesToRadians(this.HBarPrime - 30)) +\r\n        0.24 * cos(this.degreesToRadians(2 * this.HBarPrime)) +\r\n        0.32 * cos(this.degreesToRadians(3 * this.HBarPrime + 6)) -\r\n        0.20 * cos(this.degreesToRadians(4 * this.HBarPrime - 63));\r\n};\r\n\r\n/**\r\n * Returns the H Bar Prime variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getHBarPrime= function() {\r\n    var abs = Math.abs;\r\n    \r\n    if (abs(this.hPrime1 - this.hPrime2) > 180) {\r\n        return (this.hPrime1 + this.hPrime2 + 360) / 2\r\n    }\r\n    \r\n    return (this.hPrime1 + this.hPrime2) / 2\r\n};\r\n\r\n/**\r\n * Returns the Delta h Prime variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getDeltahPrime = function() {\r\n    var abs = Math.abs;\r\n    \r\n    // When either C′1 or C′2 is zero, then Δh′ is irrelevant and may be set to\r\n    // zero.\r\n    if (0 === this.C1 || 0 === this.C2) {\r\n        return 0;\r\n    }\r\n    \r\n    if (abs(this.hPrime1 - this.hPrime2) <= 180) {\r\n        return this.hPrime2 - this.hPrime1;\r\n    }\r\n    \r\n    if (this.hPrime2 <= this.hPrime1) {\r\n        return this.hPrime2 - this.hPrime1 + 360;\r\n    } else {\r\n        return this.hPrime2 - this.hPrime1 - 360;\r\n    }\r\n};\r\n\r\n/**\r\n * Returns the h Prime 1 variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.gethPrime1 = function() {\r\n    return this._gethPrimeFn(this.x1.B, this.aPrime1);\r\n};\r\n\r\n/**\r\n * Returns the h Prime 2 variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.gethPrime2 = function() {\r\n    return this._gethPrimeFn(this.x2.B, this.aPrime2);\r\n};\r\n\r\n/**\r\n * A helper function to calculate the h Prime 1 and h Prime 2 values.\r\n * @method\r\n * @private\r\n * @returns {number}\r\n */\r\ndE00.prototype._gethPrimeFn = function(x, y) {\r\n    var hueAngle;\r\n    \r\n    if (x === 0 && y === 0) {\r\n        return 0;\r\n    }\r\n    \r\n    hueAngle = this.radiansToDegrees(Math.atan2(x, y));\r\n    \r\n    if (hueAngle >= 0) {\r\n        return hueAngle;\r\n    } else {\r\n        return hueAngle + 360;\r\n    }\r\n};\r\n\r\n/**\r\n * Gives the radian equivalent of a specified degree angle.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.radiansToDegrees = function(radians) {\r\n    return radians * (180 / Math.PI);\r\n};\r\n\r\n/**\r\n * Gives the degree equivalent of a specified radian.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.degreesToRadians = function(degrees) {\r\n    return degrees * (Math.PI / 180);\r\n};\r\n\r\nmodule.exports = dE00;","'use strict';\r\n\r\n/**\r\n * @class dE76\r\n * @classdesc\r\n * The CIE76 color difference algorithm: a simple euclidean distance calculation.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE76\r\n * @constructs dE76\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @example\r\n * var deltaE = new dE76(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE76(x1, x2) {\r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n}\r\n\r\n/**\r\n * Returns the dE76 value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE76.prototype.getDeltaE = function() {\r\n    var x1 = this.x1;\r\n    var x2 = this.x2;\r\n    \r\n    return Math.sqrt(\r\n        Math.pow(x2.L - x1.L, 2) +\r\n        Math.pow(x2.A - x1.A, 2) +\r\n        Math.pow(x2.B - x1.B, 2)\r\n    );\r\n};\r\n\r\nmodule.exports = dE76;","'use strict';\r\n\r\n/**\r\n * @class dE94\r\n * @classdesc\r\n * The CIE94 algorithm: an iteration of the CIE76 algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE94\r\n * @constructs dE94\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @example\r\n * var deltaE = new dE94(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE94(x1, x2, weights) {\r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n    \r\n    this.weights = weights || {};\r\n    this.weights.lightness = this.weights.lightness || 1;\r\n    this.weights.chroma = this.weights.chroma || 1;\r\n    this.weights.hue = this.weights.hue || 1;\r\n    \r\n    if (1 === this.weights.lightness) {\r\n        this.weights.K1 = 0.045;\r\n        this.weights.K2 = 0.015;\r\n    } else {\r\n        this.weights.K1 = 0.048;\r\n        this.weights.K2 = 0.014;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the dE94 value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.getDeltaE = function() {\r\n    var x1 = this.x1;\r\n    var x2 = this.x2;\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    return sqrt(\r\n        pow(this.calculateL(x1, x2), 2) +\r\n        pow(this.calculateA(x1, x2), 2) +\r\n        pow(this.calculateB(x1, x2), 2)\r\n    );\r\n};\r\n\r\n/**\r\n * Calculates the lightness value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateL = function(x1, x2) {\r\n    return (x1.L - x2.L) / this.weights.lightness;\r\n};\r\n\r\n/**\r\n * Calculates the chroma value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateA = function(x1, x2) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    //top\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var c2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    var cab = c1 - c2;\r\n    \r\n    // bottom\r\n    var sc = 1 + (this.weights.K1 * c1);\r\n    \r\n    return cab / (this.weights.chroma * sc);\r\n};\r\n\r\n/**\r\n * Calculates the hue value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateB = function(x1, x2) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    // cab\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var c2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    var cab = c1 - c2;\r\n    \r\n    // top\r\n    var a = x1.A - x2.A;\r\n    var b = x1.B - x2.B;\r\n    var hab = sqrt(\r\n        pow(a, 2) +\r\n        pow(b, 2) -\r\n        pow(cab, 2)\r\n    );\r\n    \r\n    // bottom\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var sh = 1 + (this.weights.K2 * c1);\r\n    \r\n    return hab / sh;\r\n};\r\n\r\nmodule.exports = dE94;","'use strict';\r\n\r\n/**\r\n * @class DeltaE\r\n * @classdesc\r\n * A package of dE76, dE94, and dE00 algorithms.\r\n * @constructs DeltaE\r\n * @example\r\n * var DeltaE = new DeltaE();\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE94(labColor1, labColor2);\r\n */\r\nvar dE76 = require('./dE76');\r\nvar dE94 = require('./dE94');\r\nvar dE00 = require('./dE00');\r\n\r\nfunction DeltaE() {}\r\n\r\n/**\r\n * The CIE76 color difference algorithm: a simple euclidean distance calculation.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE76\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @returns {number} The computed dE76 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE76(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE76 = function(lab1, lab2) {\r\n    var deltaE = new dE76(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\n/**\r\n * The CIE94 algorithm: an iteration of the CIE76 algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE94\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @returns {number} The computed dE94 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE94(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE94 = function(lab1, lab2) {\r\n    var deltaE = new dE94(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\n/**\r\n * The CIE2000 color difference algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIEDE2000\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @returns {number} The computed dE00 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE00(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE00 = function(lab1, lab2) {\r\n    var deltaE = new dE00(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\nmodule.exports = new DeltaE;","/* globals MOClassDescription, NSObject, NSSelectorFromString, NSClassFromString, MOPropertyDescription */\n\nmodule.exports = function MochaDelegate(definition, superclass) {\n  var uniqueClassName =\n    'MochaJSDelegate_DynamicClass_' + NSUUID.UUID().UUIDString()\n\n  var delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(\n    uniqueClassName,\n    superclass || NSObject\n  )\n\n  // Storage\n  var handlers = {}\n  var ivars = {}\n\n  // Define an instance method\n  function setHandlerForSelector(selectorString, func) {\n    var handlerHasBeenSet = selectorString in handlers\n    var selector = NSSelectorFromString(selectorString)\n\n    handlers[selectorString] = func\n\n    /*\n      For some reason, Mocha acts weird about arguments: https://github.com/logancollins/Mocha/issues/28\n      We have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n    */\n    if (!handlerHasBeenSet) {\n      var args = []\n      var regex = /:/g\n      while (regex.exec(selectorString)) {\n        args.push('arg' + args.length)\n      }\n\n      // eslint-disable-next-line no-eval\n      var dynamicFunction = eval(\n        '(function (' +\n          args.join(', ') +\n          ') { return handlers[selectorString].apply(this, arguments); })'\n      )\n\n      delegateClassDesc.addInstanceMethodWithSelector_function(\n        selector,\n        dynamicFunction\n      )\n    }\n  }\n\n  // define a property\n  function setIvar(key, value) {\n    var ivarHasBeenSet = key in handlers\n\n    ivars[key] = value\n\n    if (!ivarHasBeenSet) {\n      delegateClassDesc.addInstanceVariableWithName_typeEncoding(key, '@')\n      var description = MOPropertyDescription.new()\n      description.name = key\n      description.typeEncoding = '@'\n      description.weak = true\n      description.ivarName = key\n      delegateClassDesc.addProperty(description)\n    }\n  }\n\n  this.getClass = function() {\n    return NSClassFromString(uniqueClassName)\n  }\n\n  this.getClassInstance = function(instanceVariables) {\n    var instance = NSClassFromString(uniqueClassName).new()\n    Object.keys(ivars).forEach(function(key) {\n      instance[key] = ivars[key]\n    })\n    Object.keys(instanceVariables || {}).forEach(function(key) {\n      instance[key] = instanceVariables[key]\n    })\n    return instance\n  }\n  // alias\n  this.new = this.getClassInstance\n\n  // Convenience\n  if (typeof definition === 'object') {\n    Object.keys(definition).forEach(\n      function(key) {\n        if (typeof definition[key] === 'function') {\n          setHandlerForSelector(key, definition[key])\n        } else {\n          setIvar(key, definition[key])\n        }\n      }\n    )\n  }\n\n  delegateClassDesc.registerClass()\n}\n","var Settings = require(\"sketch/settings\");\n\nvar kUUIDKey = \"google.analytics.uuid\";\nvar uuid = null\nvar uuid = NSUserDefaults.standardUserDefaults().objectForKey(kUUIDKey);\nif (!uuid) {\n  uuid = NSUUID.UUID().UUIDString();\n  NSUserDefaults.standardUserDefaults().setObject_forKey(uuid, kUUIDKey)\n}\n\nvar sketchVersion = Settings.version.sketch\nvar variant = sketchVersion >= 72 ? BCSketchInfo.shared().metadata().variant : MSApplicationMetadata.metadata().variant\nvar source =\n  \"Sketch \" +\n  (variant == \"NONAPPSTORE\" ? \"\" : variant + \" \") +\n  sketchVersion;\n\nfunction jsonToQueryString(json) {\n  return Object.keys(json)\n    .map(function(key) {\n      return encodeURIComponent(key) + \"=\" + encodeURIComponent(json[key]);\n    })\n    .join(\"&\");\n}\n\nfunction makeRequest(url, options) {\n  if (!url) {\n    return\n  }\n\n  if (options && options.makeRequest) {\n    return options.makeRequest(url)\n  }\n  if (options && options.debug) {\n    var request = NSURLRequest.requestWithURL(url)\n    var responsePtr = MOPointer.alloc().init();\n    var errorPtr = MOPointer.alloc().init();\n\n    var data = NSURLConnection.sendSynchronousRequest_returningResponse_error(request, responsePtr, errorPtr)\n    return data ? NSString.alloc().initWithData_encoding(data, NSUTF8StringEncoding) : errorPtr.value()\n  }\n\n  NSURLSession.sharedSession()\n    .dataTaskWithURL(url)\n    .resume();\n}\n\nmodule.exports = function(trackingId, hitType, props, options) {\n  if (!Settings.globalSettingForKey(\"analyticsEnabled\")) {\n    // the user didn't enable sharing analytics\n    return 'the user didn\\'t enable sharing analytics';\n  }\n\n  var payload = {\n    v: 1,\n    tid: trackingId,\n    ds: source,\n    cid: uuid,\n    t: hitType\n  };\n\n  if (typeof __command !== \"undefined\") {\n    payload.an = __command.pluginBundle().name();\n    payload.aid = __command.pluginBundle().identifier();\n    payload.av = __command.pluginBundle().version();\n  }\n\n  if (props) {\n    Object.keys(props).forEach(function(key) {\n      payload[key] = props[key];\n    });\n  }\n\n  var url = NSURL.URLWithString(\n    \"https://www.google-analytics.com/\" + (options && options.debug ? \"debug/\" : \"\") + \"collect?\" +\n      jsonToQueryString(payload) +\n      \"&z=\" +\n      NSUUID.UUID().UUIDString()\n  );\n\n  return makeRequest(url, options)\n};\n","function parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      typeof color.isKindOfClass === 'function' &&\n      color.isKindOfClass(NSColor)\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16)\n  var g = parseInt(hex.slice(2, 4), 16)\n  var b = parseInt(hex.slice(4, 6), 16)\n  var a = parseInt(hex.slice(6, 8), 16)\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function(browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function() {\n    return panel.close()\n  }\n\n  browserWindow.close = function() {\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      var shouldClose = true\n      browserWindow.emit('close', {\n        get defaultPrevented() {\n          return !shouldClose\n        },\n        preventDefault: function() {\n          shouldClose = false\n        },\n      })\n      if (shouldClose) {\n        panel.delegate().utils.parentWindow.endSheet(panel)\n      }\n      return\n    }\n\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (!browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n      NSApp.mainWindow().makeKeyAndOrderFront(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function() {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function() {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function() {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      return panel.delegate().utils.parentWindow.beginSheet_completionHandler(\n        panel,\n        __mocha__.createBlock_function('v16@?0q8', function() {\n          browserWindow.emit('closed')\n        })\n      )\n    }\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function() {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function() {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function() {\n    return false\n  }\n\n  browserWindow.maximize = function() {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function() {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function() {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function() {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function() {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function() {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function(fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function() {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function(aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function(bounds, animate) {\n    if (!bounds) {\n      return\n    }\n\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    const newBounds = Object.assign(browserWindow.getBounds(), bounds)\n\n    // TODO: Check size constraints since setFrame does not check it.\n    // var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(\n      newBounds.x,\n      0,\n      newBounds.width,\n      newBounds.height\n    )\n    // Flip Y coordinates based on the primary screen\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y = NSHeight(screen.frame()) - newBounds.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function() {\n    const cocoaBounds = panel.frame()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    return {\n      x: cocoaBounds.origin.x,\n      y: Math.round(NSHeight(mainScreenRect) - cocoaBounds.origin.y),\n      width: cocoaBounds.size.width,\n      height: cocoaBounds.size.height,\n    }\n  }\n\n  browserWindow.setContentBounds = function(bounds, animate) {\n    // TODO:\n    browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getContentBounds = function() {\n    // TODO:\n    return browserWindow.getBounds()\n  }\n\n  browserWindow.setSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setBounds({ width: width, height: height }, animate)\n  }\n\n  browserWindow.getSize = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setContentSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setContentBounds(\n      { width: width, height: height },\n      animate\n    )\n  }\n\n  browserWindow.getContentSize = function() {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setMinimumSize = function(width, height) {\n    const minSize = CGSizeMake(width, height)\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function() {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function(width, height) {\n    const maxSize = CGSizeMake(width, height)\n    panel.setContentMaxSize(maxSize)\n  }\n\n  browserWindow.getMaximumSize = function() {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function(resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function() {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function(movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function() {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function(minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function() {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function(maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function() {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function(fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function(closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function() {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function(top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function() {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function() {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function(x, y, animate) {\n    return browserWindow.setBounds({ x: x, y: y }, animate)\n  }\n\n  browserWindow.getPosition = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.x, bounds.y]\n  }\n\n  browserWindow.setTitle = function(title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function() {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function(flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function() {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function() {\n    return webview\n  }\n\n  browserWindow.loadURL = function(url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!https?|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url =\n          'file://' +\n          __command\n            .pluginBundle()\n            .urlForResourceNamed(url)\n            .path()\n      }\n    }\n\n    if (/^file:\\/\\/.*\\.html?$/.test(url)) {\n      // ensure URLs containing spaces are properly handled\n      url = NSString.alloc().initWithString(url)\n      url = url.stringByAddingPercentEncodingWithAllowedCharacters(\n        NSCharacterSet.URLQueryAllowedCharacterSet()\n      )\n      webview.loadFileURL_allowingReadAccessToURL(\n        NSURL.URLWithString(url),\n        NSURL.URLWithString('file:///')\n      )\n      return\n    }\n\n    const properURL = NSURL.URLWithString(url)\n    const urlRequest = NSURLRequest.requestWithURL(properURL)\n\n    webview.loadRequest(urlRequest)\n  }\n\n  browserWindow.reload = function() {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function(hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function() {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function(opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function() {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function(visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function(ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function(enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function(autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function(type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function(colorName) {\n    var color = parseHexColor(colorName)\n    webview.setValue_forKey(false, 'drawsBackground')\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function() {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function(button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n  START_MOVING_WINDOW: '__skpm_startMovingWindow',\n  EXECUTE_JAVASCRIPT: '__skpm_executeJS',\n  EXECUTE_JAVASCRIPT_SUCCESS: '__skpm_executeJS_success_',\n  EXECUTE_JAVASCRIPT_ERROR: '__skpm_executeJS_error_',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function(webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    point.x +\n    ', ' +\n    point.y +\n    '); ' +\n    'if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webview, browserWindow) {\n  function executeJavaScript(script, userGesture, callback) {\n    if (typeof userGesture === 'function') {\n      callback = userGesture\n      userGesture = false\n    }\n    var fiber = coscript.createFiber()\n\n    // if the webview is not ready yet, defer the execution until it is\n    if (\n      webview.navigationDelegate().state &&\n      webview.navigationDelegate().state.wasReady == 0\n    ) {\n      return new Promise(function(resolve, reject) {\n        browserWindow.once('ready-to-show', function() {\n          executeJavaScript(script, userGesture, callback)\n            .then(resolve)\n            .catch(reject)\n          fiber.cleanup()\n        })\n      })\n    }\n\n    return new Promise(function(resolve, reject) {\n      var requestId = Math.random()\n\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS + requestId,\n        function(res) {\n          try {\n            if (callback) {\n              callback(null, res)\n            }\n            resolve(res)\n          } catch (err) {\n            reject(err)\n          }\n          fiber.cleanup()\n        }\n      )\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_ERROR + requestId,\n        function(err) {\n          try {\n            if (callback) {\n              callback(err)\n              resolve()\n            } else {\n              reject(err)\n            }\n          } catch (err2) {\n            reject(err2)\n          }\n          fiber.cleanup()\n        }\n      )\n\n      webview.evaluateJavaScript_completionHandler(\n        module.exports.wrapScript(script, requestId),\n        null\n      )\n    })\n  }\n\n  return executeJavaScript\n}\n\nmodule.exports.wrapScript = function(script, requestId) {\n  return (\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    '(' +\n    requestId +\n    ', ' +\n    JSON.stringify(script) +\n    ')'\n  )\n}\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    ' = function(id, script) {' +\n    '  try {' +\n    '    var res = eval(script);' +\n    '    if (res && typeof res.then === \"function\" && typeof res.catch === \"function\") {' +\n    '      res.then(function (res2) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res2);' +\n    '      })' +\n    '      .catch(function (err) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '      })' +\n    '    } else {' +\n    '      window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res);' +\n    '    }' +\n    '  } catch (err) {' +\n    '    window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '  }' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar injectClientMessaging = require('./inject-client-messaging')\nvar movableArea = require('./movable-area')\nvar executeJavaScript = require('./execute-javascript')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || NSUUID.UUID().UUIDString()\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (options.modal && !options.parent) {\n    throw new Error('A modal needs to have a parent.')\n  }\n\n  // Long-running script\n  var fiber = coscript.createFiber()\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens()\n    .firstObject()\n    .frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? NSHeight(mainScreenRect) - options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  var wkwebviewConfig = WKWebViewConfiguration.alloc().init()\n  var webView = WKWebView.alloc().initWithFrame_configuration(\n    CGRectMake(0, 0, options.width || 800, options.height || 600),\n    wkwebviewConfig\n  )\n  injectClientMessaging(webView)\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView, options)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  const title =\n    options.title ||\n    (typeof __command !== 'undefined' && __command.pluginBundle()\n      ? __command.pluginBundle().name()\n      : undefined)\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  options.webPreferences = options.webPreferences || {}\n\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.devTools !== false,\n      'developerExtrasEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.javascript !== false,\n      'javaScriptEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(!!options.webPreferences.plugins, 'plugInsEnabled')\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.minimumFontSize || 0,\n      'minimumFontSize'\n    )\n\n  if (options.webPreferences.zoomFactor) {\n    webView.setMagnification(options.webPreferences.zoomFactor)\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  panel.setHidesOnDeactivate(options.hidesOnDeactivate !== false)\n\n  if (options.remembersWindowFrame) {\n    panel.setFrameAutosaveName(identifier)\n    panel.setFrameUsingName_force(panel.frameAutosaveName(), false)\n  }\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function(event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents\n          .executeJavaScript(dispatchFirstClick(webView, event))\n          .catch(() => {})\n      }\n    })\n  }\n\n  executeJavaScript.injectScript(webView)\n  movableArea.injectScript(webView)\n  movableArea.setupHandler(browserWindow)\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function() {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    fiber.cleanup()\n  })\n\n  threadDictionary[identifier] = panel\n\n  fiber.onCleanup(function() {\n    if (!browserWindow._destroyed) {\n      browserWindow.destroy()\n    }\n  })\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function(identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function(panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webView &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webView = subviews[i]\n    }\n  }\n\n  if (!webView) {\n    throw new Error('The panel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webView) {\n  var source =\n    'window.originalPostMessage = window.postMessage;' +\n    'window.postMessage = function(actionName) {' +\n    'if (!actionName) {' +\n    \"throw new Error('missing action name')\" +\n    '}' +\n    'window.webkit.messageHandlers.' +\n    CONSTANTS.JS_BRIDGE +\n    '.postMessage(' +\n    'JSON.stringify([].slice.call(arguments))' +\n    ');' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    '(function () {' +\n    \"document.addEventListener('mousedown', onMouseDown);\" +\n    '' +\n    'function shouldDrag(target) {' +\n    '  if (!target || (target.dataset || {}).appRegion === \"no-drag\") { return false }' +\n    '  if ((target.dataset || {}).appRegion === \"drag\") { return true }' +\n    '  return shouldDrag(target.parentElement)' +\n    '};' +\n    '' +\n    'function onMouseDown(e) {console.log(e);' +\n    '  if (e.button !== 0 || !shouldDrag(e.target)) { return }' +\n    '  window.postMessage(\"' +\n    CONSTANTS.START_MOVING_WINDOW +\n    '\");' +\n    '};' +\n    '})()'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n\nmodule.exports.setupHandler = function(browserWindow) {\n  var initialMouseLocation = null\n  var initialWindowPosition = null\n  var interval = null\n\n  function moveWindow() {\n    // if the user released the button, stop moving the window\n    if (!initialWindowPosition || NSEvent.pressedMouseButtons() !== 1) {\n      clearInterval(interval)\n      initialMouseLocation = null\n      initialWindowPosition = null\n      return\n    }\n\n    var mouse = NSEvent.mouseLocation()\n    browserWindow.setPosition(\n      initialWindowPosition.x + (mouse.x - initialMouseLocation.x),\n      initialWindowPosition.y + (initialMouseLocation.y - mouse.y), // y is inverted\n      false\n    )\n  }\n\n  browserWindow.webContents.on(CONSTANTS.START_MOVING_WINDOW, function() {\n    initialMouseLocation = NSEvent.mouseLocation()\n    var position = browserWindow.getPosition()\n    initialWindowPosition = {\n      x: position[0],\n      y: position[1],\n    }\n\n    interval = setInterval(moveWindow, 1000 / 60) // 60 fps\n  })\n}\n","module.exports = function(webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments)\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('mocha-js-delegate')\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar NavigationDelegateClass\nvar WebScriptHandlerClass\n\n// TODO: events\n// - 'page-favicon-updated'\n// - 'new-window'\n// - 'did-navigate-in-page'\n// - 'will-prevent-unload'\n// - 'crashed'\n// - 'unresponsive'\n// - 'responsive'\n// - 'destroyed'\n// - 'before-input-event'\n// - 'certificate-error'\n// - 'found-in-page'\n// - 'media-started-playing'\n// - 'media-paused'\n// - 'did-change-theme-color'\n// - 'update-target-url'\n// - 'cursor-changed'\n// - 'context-menu'\n// - 'select-bluetooth-device'\n// - 'paint'\n// - 'console-message'\n\nmodule.exports = function(browserWindow, panel, webview, options) {\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = new ObjCClass({\n      utils: null,\n      panel: null,\n\n      'windowDidResize:': function() {\n        this.utils.emit('resize')\n      },\n\n      'windowDidMiniaturize:': function() {\n        this.utils.emit('minimize')\n      },\n\n      'windowDidDeminiaturize:': function() {\n        this.utils.emit('restore')\n      },\n\n      'windowDidEnterFullScreen:': function() {\n        this.utils.emit('enter-full-screen')\n      },\n\n      'windowDidExitFullScreen:': function() {\n        this.utils.emit('leave-full-screen')\n      },\n\n      'windowDidMove:': function() {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      'windowShouldClose:': function() {\n        var shouldClose = 1\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function() {\n            shouldClose = 0\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function() {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function() {\n        this.utils.emit('focus', this.panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function() {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!NavigationDelegateClass) {\n    NavigationDelegateClass = new ObjCClass({\n      state: {\n        wasReady: 0,\n      },\n      utils: null,\n\n      // // Called when the web view begins to receive web content.\n      'webView:didCommitNavigation:': function(webView) {\n        this.utils.emit('will-navigate', {}, String(String(webView.URL())))\n      },\n\n      // // Called when web content begins to load in a web view.\n      'webView:didStartProvisionalNavigation:': function() {\n        this.utils.emit('did-start-navigation')\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a web view receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalNavigation:': function() {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // // Called when the web view needs to respond to an authentication challenge.\n      // 'webView:didReceiveAuthenticationChallenge:completionHandler:': function(\n      //   webView,\n      //   challenge,\n      //   completionHandler\n      // ) {\n      //   function callback(username, password) {\n      //     completionHandler(\n      //       0,\n      //       NSURLCredential.credentialWithUser_password_persistence(\n      //         username,\n      //         password,\n      //         1\n      //       )\n      //     )\n      //   }\n      //   var protectionSpace = challenge.protectionSpace()\n      //   this.utils.emit(\n      //     'login',\n      //     {},\n      //     {\n      //       method: String(protectionSpace.authenticationMethod()),\n      //       url: 'not implemented', // TODO:\n      //       referrer: 'not implemented', // TODO:\n      //     },\n      //     {\n      //       isProxy: !!protectionSpace.isProxy(),\n      //       scheme: String(protectionSpace.protocol()),\n      //       host: String(protectionSpace.host()),\n      //       port: Number(protectionSpace.port()),\n      //       realm: String(protectionSpace.realm()),\n      //     },\n      //     callback\n      //   )\n      // },\n\n      // Called when an error occurs during navigation.\n      // 'webView:didFailNavigation:withError:': function(\n      //   webView,\n      //   navigation,\n      //   error\n      // ) {},\n\n      // Called when an error occurs while the web view is loading content.\n      'webView:didFailProvisionalNavigation:withError:': function(\n        webView,\n        navigation,\n        error\n      ) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when the navigation is complete.\n      'webView:didFinishNavigation:': function() {\n        if (this.state.wasReady == 0) {\n          this.state.wasReady = 1\n          this.utils.emitBrowserEvent('ready-to-show')\n        }\n        this.utils.emit('did-navigate')\n        this.utils.emit('did-frame-navigate')\n        this.utils.emit('did-stop-loading')\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n      },\n\n      // Called when the web view’s web content process is terminated.\n      'webViewWebContentProcessDidTerminate:': function() {\n        this.utils.emit('dom-ready')\n      },\n\n      // Decides whether to allow or cancel a navigation.\n      // webView:decidePolicyForNavigationAction:decisionHandler:\n\n      // Decides whether to allow or cancel a navigation after its response is known.\n      // webView:decidePolicyForNavigationResponse:decisionHandler:\n    })\n  }\n\n  if (!WebScriptHandlerClass) {\n    WebScriptHandlerClass = new ObjCClass({\n      utils: null,\n      'userContentController:didReceiveScriptMessage:': function(_, message) {\n        var args = this.utils.parseWebArguments(String(message.body()))\n        if (!args) {\n          return\n        }\n        if (!args[0] || typeof args[0] !== 'string') {\n          return\n        }\n        args[0] = String(args[0])\n\n        this.utils.emit.apply(this, args)\n      },\n    })\n  }\n\n  var navigationDelegate = NavigationDelegateClass.new({\n    utils: {\n      setTitle: browserWindow.setTitle.bind(browserWindow),\n      emitBrowserEvent() {\n        try {\n          browserWindow.emit.apply(browserWindow, arguments)\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n    },\n    state: {\n      wasReady: 0,\n    },\n  })\n\n  webview.setNavigationDelegate(navigationDelegate)\n\n  var webScriptHandler = WebScriptHandlerClass.new({\n    utils: {\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      parseWebArguments: parseWebArguments,\n    },\n  })\n\n  webview\n    .configuration()\n    .userContentController()\n    .addScriptMessageHandler_name(webScriptHandler, CONSTANTS.JS_BRIDGE)\n\n  var utils = {\n    emit() {\n      try {\n        browserWindow.emit.apply(browserWindow, arguments)\n      } catch (err) {\n        if (\n          typeof process !== 'undefined' &&\n          process.listenerCount &&\n          process.listenerCount('uncaughtException')\n        ) {\n          process.emit('uncaughtException', err, 'uncaughtException')\n        } else {\n          console.error(err)\n          throw err\n        }\n      }\n    },\n  }\n  if (options.modal) {\n    // find the window of the document\n    var msdocument\n    if (options.parent.type === 'Document') {\n      msdocument = options.parent.sketchObject\n    } else {\n      msdocument = options.parent\n    }\n    if (msdocument && String(msdocument.class()) === 'MSDocumentData') {\n      // we only have an MSDocumentData instead of a MSDocument\n      // let's try to get back to the MSDocument\n      msdocument = msdocument.delegate()\n    }\n    utils.parentWindow = msdocument.windowForSheet()\n  }\n\n  var windowDelegate = WindowDelegateClass.new({\n    utils: utils,\n    panel: panel,\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('events')\nvar executeJavaScript = require('./execute-javascript')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n\n  webContents.loadFile = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.downloadURL = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.getURL = function() {\n    return String(webview.url())\n  }\n\n  webContents.getTitle = function() {\n    return String(webview.title())\n  }\n\n  webContents.isDestroyed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.focus = browserWindow.focus\n  webContents.isFocused = browserWindow.isFocused\n\n  webContents.isLoading = function() {\n    return !!webview.loading()\n  }\n\n  webContents.isLoadingMainFrame = function() {\n    // TODO:\n    return !!webview.loading()\n  }\n\n  webContents.isWaitingForResponse = function() {\n    return !webview.loading()\n  }\n\n  webContents.stop = function() {\n    webview.stopLoading()\n  }\n  webContents.reload = function() {\n    webview.reload()\n  }\n  webContents.reloadIgnoringCache = function() {\n    webview.reloadFromOrigin()\n  }\n  webContents.canGoBack = function() {\n    return !!webview.canGoBack()\n  }\n  webContents.canGoForward = function() {\n    return !!webview.canGoForward()\n  }\n  webContents.canGoToOffset = function(offset) {\n    return !!webview.backForwardList().itemAtIndex(offset)\n  }\n  webContents.clearHistory = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.goBack = function() {\n    webview.goBack()\n  }\n  webContents.goForward = function() {\n    webview.goForward()\n  }\n  webContents.goToIndex = function(index) {\n    var backForwardList = webview.backForwardList()\n    var backList = backForwardList.backList()\n    var backListLength = backList.count()\n    if (backListLength > index) {\n      webview.loadRequest(NSURLRequest.requestWithURL(backList[index]))\n      return\n    }\n    var forwardList = backForwardList.forwardList()\n    if (forwardList.count() > index - backListLength) {\n      webview.loadRequest(\n        NSURLRequest.requestWithURL(forwardList[index - backListLength])\n      )\n      return\n    }\n    throw new Error('Cannot go to index ' + index)\n  }\n  webContents.goToOffset = function(offset) {\n    if (!webContents.canGoToOffset(offset)) {\n      throw new Error('Cannot go to offset ' + offset)\n    }\n    webview.loadRequest(\n      NSURLRequest.requestWithURL(webview.backForwardList().itemAtIndex(offset))\n    )\n  }\n  webContents.isCrashed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setUserAgent = function(/* userAgent */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.getUserAgent = function() {\n    const userAgent = webview.customUserAgent()\n    return userAgent ? String(userAgent) : undefined\n  }\n  webContents.insertCSS = function(css) {\n    var source =\n      \"var style = document.createElement('style'); style.innerHTML = \" +\n      css.replace(/\"/, '\\\\\"') +\n      '; document.head.appendChild(style);'\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.insertJS = function(source) {\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.executeJavaScript = executeJavaScript(webview, browserWindow)\n  webContents.setIgnoreMenuShortcuts = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setAudioMuted = function(/* muted */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.isAudioMuted = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setZoomFactor = function(factor) {\n    webview.setMagnification_centeredAtPoint(factor, CGPointMake(0, 0))\n  }\n  webContents.getZoomFactor = function(callback) {\n    callback(Number(webview.magnification()))\n  }\n  webContents.setZoomLevel = function(level) {\n    // eslint-disable-next-line no-restricted-properties\n    webContents.setZoomFactor(Math.pow(1.2, level))\n  }\n  webContents.getZoomLevel = function(callback) {\n    // eslint-disable-next-line no-restricted-properties\n    callback(Math.log(Number(webview.magnification())) / Math.log(1.2))\n  }\n  webContents.setVisualZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setLayoutZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  // TODO:\n  // webContents.undo = function() {\n  //   webview.undoManager().undo()\n  // }\n  // webContents.redo = function() {\n  //   webview.undoManager().redo()\n  // }\n  // webContents.cut = webview.cut\n  // webContents.copy = webview.copy\n  // webContents.paste = webview.paste\n  // webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  // webContents.delete = webview.delete\n  // webContents.replace = webview.replaceSelectionWithText\n\n  webContents.send = function() {\n    const script =\n      'window.postMessage({' +\n      'isSketchMessage: true,' +\n      \"origin: '\" +\n      String(__command.identifier()) +\n      \"',\" +\n      'args: ' +\n      JSON.stringify([].slice.call(arguments)) +\n      '}, \"*\")'\n    webview.evaluateJavaScript_completionHandler(script, null)\n  }\n\n  webContents.getNativeWebview = function() {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function(identifier) {\n  return require('./lib').fromId(identifier) // eslint-disable-line\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  if (!module.exports.isWebviewPresent(identifier)) {\n    return\n  }\n\n  var panel = threadDictionary[identifier]\n  var webview = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webview &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webview = subviews[i]\n    }\n  }\n\n  if (!webview || !webview.evaluateJavaScript_completionHandler) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  webview.evaluateJavaScript_completionHandler(evalString, null)\n}\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/46e6e74ff91edb5a0d5bba02360d8e59.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/d266dae7d9f8d2cd31d09dd22573b0c4.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/fd1874eebfbb6c3ae6af98deb42f19cf.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/937957410dc86d5bed6e1bd95bfb62f0.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/8764b3320da4abd926c1426036684c22.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/ef0b743d0f40332338ef5a7f7762c6a4.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/a669432d11d6a89fef41e7944080a9d2.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/320f357cd4da22dee21894be9e177545.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/541e704944a23b249021551b8b24f0bc.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/f017cc6c076658185a35162886b14d24.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/9c252c8f6da78652911e1d520eee518a.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/5804ebfb5ca55988e1d4add35047b228.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/9cd69289ae1bd86abccbe64c552be182.html\";","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nconst Helpers = require(\"./Helpers\");\nconst webviewEsIdentifier = 'merge-duplicates.webviewSettings';\n\nvar globalSettingsFile;\n\nexport function EditSettings(context) {\n  const optionss = {\n    identifier: webviewEsIdentifier,\n    width: 500,\n    height: 600,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(optionss);\n  const webContents = browserWindow.webContents;\n\n\n  browserWindow.loadURL(require('../resources/settings.html'));\n  globalSettingsFile = Helpers.getSettings();\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    webContents.executeJavaScript(`AssignSettings(${Helpers.getLogsEnabled()},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewEsIdentifier);\n  });\n\n  webContents.on('AcceptSettings', (logsEnabled, librariesEnabledByDefault) => {\n    //d9-06\n    var _0x238c=[\"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\",\"\",\"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\",\"\\x70\\x61\\x74\\x68\",\"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\",\"\\x2F\\x6D\\x65\\x72\\x67\\x65\\x2E\\x6A\\x73\\x6F\\x6E\",\"\\x77\\x72\\x69\\x74\\x65\\x54\\x65\\x78\\x74\\x54\\x6F\\x46\\x69\\x6C\\x65\"];var jsonDef;if((globalSettingsFile!= null)&& (globalSettingsFile[_0x238c[0]]!= null)){jsonDef= {\"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\":_0x238c[1]+ globalSettingsFile[_0x238c[0]],\"\\x6C\\x6F\\x67\\x73\":logsEnabled,\"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\":librariesEnabledByDefault}}else {if((globalSettingsFile!= null)&& (globalSettingsFile[_0x238c[2]]!= null)){jsonDef= {\"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\":_0x238c[1]+ globalSettingsFile[_0x238c[2]],\"\\x6C\\x6F\\x67\\x73\":logsEnabled,\"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\":librariesEnabledByDefault}}};Helpers[_0x238c[6]](jsonDef,MSPluginManager[_0x238c[4]]()[_0x238c[3]]()+ _0x238c[5]);onShutdown(webviewEsIdentifier)\n    //d9-06\n  });\n}\n\nexport function onShutdown(webviewID) {\n  const existingWebview = getWebview(webviewID)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}","\nconst sketch = require('sketch');\nconst dom = require('sketch/dom');\nvar ShapePath = require('sketch/dom').ShapePath;\nvar Text = require('sketch/dom').Text;\nvar DeltaE = require('delta-e');\nvar D3 = require('d3-color');\nvar fs = require('@skpm/fs');\nvar track = require(\"sketch-module-google-analytics\");\n\nvar document = sketch.getSelectedDocument();\nvar symbols;\nvar libraries = dom.getLibraries();\n\nvar settingsFile;\nvar logsEnabled = false, timingEnabled = false;\nvar librariesEnabledByDefault = true;\nvar acquiredLicense = \"Single\";\n\nconst valStatus = {\n  app: 'app',\n  no: 'no',\n  over: 'over',\n  noCon: 'nocon'\n}\n\nconst commands = {\n  mergeduplicatesymbols: 'mergeduplicatesymbols',\n  mergeselectedsymbols: 'mergeselectedsymbols',\n  mergeselectedtextstyles: 'mergeselectedtextstyles',\n  mergesimilartextstyles: 'mergesimilartextstyles',\n  mergeduplicatetextstyles: 'mergeduplicatetextstyles',\n  mergesimilarlayerstyles: 'mergesimilarlayerstyles',\n  mergeselectedlayerstyles: 'mergeselectedlayerstyles',\n  mergeduplicatelayerstyles: 'mergeduplicatelayerstyles',\n  mergeduplicatecolorvariables: 'mergeduplicatecolorvariables',\n  mergeselectedcolorvariables: 'mergeselectedcolorvariables',\n  mergesimilarcolorvariables: 'mergesimilarcolorvariables',\n  editsettings: 'editsettings'\n}\n\nconst sketchlocalfile = \"💎 This Sketch file\";\nconst libraryPrefix = \"🔸\";\n\n//d9-03\n// var _0xade5 = [\"\\x69\\x6E\\x69\\x74\", \"\\x61\\x6C\\x6C\\x6F\\x63\", \"\\x2F\\x75\\x73\\x72\\x2F\\x62\\x69\\x6E\\x2F\\x63\\x75\\x72\\x6C\", \"\\x73\\x65\\x74\\x4C\\x61\\x75\\x6E\\x63\\x68\\x50\\x61\\x74\\x68\", \"\\x73\\x65\\x74\\x41\\x72\\x67\\x75\\x6D\\x65\\x6E\\x74\\x73\", \"\\x70\\x69\\x70\\x65\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x4F\\x75\\x74\\x70\\x75\\x74\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x45\\x72\\x72\\x6F\\x72\", \"\\x6C\\x61\\x75\\x6E\\x63\\x68\", \"\\x77\\x61\\x69\\x74\\x55\\x6E\\x74\\x69\\x6C\\x45\\x78\\x69\\x74\", \"\\x74\\x65\\x72\\x6D\\x69\\x6E\\x61\\x74\\x69\\x6F\\x6E\\x53\\x74\\x61\\x74\\x75\\x73\", \"\\x72\\x65\\x61\\x64\\x44\\x61\\x74\\x61\\x54\\x6F\\x45\\x6E\\x64\\x4F\\x66\\x46\\x69\\x6C\\x65\", \"\\x66\\x69\\x6C\\x65\\x48\\x61\\x6E\\x64\\x6C\\x65\\x46\\x6F\\x72\\x52\\x65\\x61\\x64\\x69\\x6E\\x67\", \"\\x69\\x6E\\x69\\x74\\x57\\x69\\x74\\x68\\x44\\x61\\x74\\x61\\x5F\\x65\\x6E\\x63\\x6F\\x64\\x69\\x6E\\x67\", \"\\x73\\x75\\x63\\x63\\x65\\x73\\x73\", \"\\x70\\x75\\x72\\x63\\x68\\x61\\x73\\x65\", \"\\x54\\x65\\x61\\x6D\", \"\\x69\\x6E\\x64\\x65\\x78\\x4F\\x66\", \"\\x76\\x61\\x72\\x69\\x61\\x6E\\x74\\x73\", \"\\x54\\x65\\x61\\x6D\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\", \"\\x32\", \"\\x44\\x6F\\x75\\x62\\x6C\\x65\", \"\\x53\\x69\\x6E\\x67\\x6C\\x65\", \"\\x61\\x70\\x70\", \"\\x4D\\x65\\x72\\x67\\x65\\x20\\x44\\x75\\x70\\x6C\\x69\\x63\\x61\\x74\\x65\\x73\\x20\\x2D\\x20\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x69\\x6E\\x67\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x3A\\x20\\x54\\x65\\x61\\x6D\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\", \"\\x6C\\x6F\\x67\", \"\\x75\\x73\\x65\\x73\", \"\\x4D\\x65\\x72\\x67\\x65\\x20\\x44\\x75\\x70\\x6C\\x69\\x63\\x61\\x74\\x65\\x73\\x20\\x2D\\x20\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x69\\x6E\\x67\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x3A\\x20\", \"\\x20\\x2D\\x20\\x53\\x65\\x61\\x74\\x73\\x20\\x28\", \"\\x29\\x20\\x65\\x78\\x63\\x65\\x65\\x64\\x65\\x64\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x20\\x28\", \"\\x29\\x2E\", \"\\x6F\\x76\\x65\\x72\", \"\\x6E\\x6F\", \"\\x6E\\x6F\\x43\\x6F\\x6E\"]; function curl_async(_0x8656x2, _0x8656x3) { var _0x8656x4 = NSTask[_0xade5[1]]()[_0xade5[0]](); _0x8656x4[_0xade5[3]](_0xade5[2]); _0x8656x4[_0xade5[4]](_0x8656x2); var _0x8656x5 = NSPipe[_0xade5[5]](); var _0x8656x6 = NSPipe[_0xade5[5]](); _0x8656x4[_0xade5[6]](_0x8656x5); _0x8656x4[_0xade5[7]](_0x8656x6); _0x8656x4[_0xade5[8]](); _0x8656x4[_0xade5[9]](); var _0x8656x7 = _0x8656x4[_0xade5[10]](); var _0x8656x8 = _0x8656x6[_0xade5[12]]()[_0xade5[11]](); var _0x8656x9 = NSString[_0xade5[1]]()[_0xade5[13]](_0x8656x8, NSUTF8StringEncoding); if (_0x8656x7 == 0) { var _0x8656xa = _0x8656x5[_0xade5[12]]()[_0xade5[11]](); var _0x8656xb = NSString[_0xade5[1]]()[_0xade5[13]](_0x8656xa, NSUTF8StringEncoding); var _0x8656xc = tryParseJSON(_0x8656xb); if (_0x8656xc[_0xade5[14]]) { if (!_0x8656x3) { if (_0x8656xc[_0xade5[15]] != null) { if (_0x8656xc[_0xade5[15]][_0xade5[18]][_0xade5[17]](_0xade5[16]) > 0) { acquiredLicense = _0xade5[19] } else { if (_0x8656xc[_0xade5[15]][_0xade5[18]][_0xade5[17]](_0xade5[20]) > 0) { acquiredLicense = _0xade5[21] } else { acquiredLicense = _0xade5[22] } } }; return valStatus[_0xade5[23]] } else { if (_0x8656xc[_0xade5[15]] != null) { if (_0x8656xc[_0xade5[15]][_0xade5[18]][_0xade5[17]](_0xade5[16]) > 0) { console[_0xade5[25]](_0xade5[24]); return valStatus[_0xade5[23]] } else { var _0x8656xd = 1; acquiredLicense = _0xade5[22]; if (_0x8656xc[_0xade5[15]][_0xade5[18]][_0xade5[17]](_0xade5[20]) > 0) { _0x8656xd = 2; acquiredLicense = _0xade5[21] }; if (_0x8656xc[_0xade5[26]] > _0x8656xd) { console[_0xade5[25]](_0xade5[27] + acquiredLicense + _0xade5[28] + _0x8656xc[_0xade5[26]] + _0xade5[29] + _0x8656xd + _0xade5[30]); return valStatus[_0xade5[31]] } else { console[_0xade5[25]](_0xade5[27] + acquiredLicense); return valStatus[_0xade5[23]] } } } else { return valStatus[_0xade5[23]] } } } else { return valStatus[_0xade5[32]] } } else { return valStatus[_0xade5[33]] } }\n\nvar _0xfc66 = [\"\\x69\\x6E\\x69\\x74\", \"\\x61\\x6C\\x6C\\x6F\\x63\", \"\\x2F\\x75\\x73\\x72\\x2F\\x62\\x69\\x6E\\x2F\\x63\\x75\\x72\\x6C\", \"\\x73\\x65\\x74\\x4C\\x61\\x75\\x6E\\x63\\x68\\x50\\x61\\x74\\x68\", \"\\x73\\x65\\x74\\x41\\x72\\x67\\x75\\x6D\\x65\\x6E\\x74\\x73\", \"\\x70\\x69\\x70\\x65\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x4F\\x75\\x74\\x70\\x75\\x74\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x45\\x72\\x72\\x6F\\x72\", \"\\x6C\\x61\\x75\\x6E\\x63\\x68\", \"\\x77\\x61\\x69\\x74\\x55\\x6E\\x74\\x69\\x6C\\x45\\x78\\x69\\x74\", \"\\x74\\x65\\x72\\x6D\\x69\\x6E\\x61\\x74\\x65\", \"\\x4C\\x69\\x63\\x65\\x6E\\x73\\x65\\x20\\x76\\x61\\x6C\\x69\\x64\\x61\\x74\\x69\\x6F\\x6E\\x20\\x69\\x73\\x73\\x75\\x65\\x2E\", \"\\x6C\\x6F\\x67\", \"\\x2D\\x2D\\x2D\", \"\\x61\\x70\\x70\", \"\\x74\\x65\\x72\\x6D\\x69\\x6E\\x61\\x74\\x69\\x6F\\x6E\\x53\\x74\\x61\\x74\\x75\\x73\", \"\\x72\\x65\\x61\\x64\\x44\\x61\\x74\\x61\\x54\\x6F\\x45\\x6E\\x64\\x4F\\x66\\x46\\x69\\x6C\\x65\", \"\\x66\\x69\\x6C\\x65\\x48\\x61\\x6E\\x64\\x6C\\x65\\x46\\x6F\\x72\\x52\\x65\\x61\\x64\\x69\\x6E\\x67\", \"\\x69\\x6E\\x69\\x74\\x57\\x69\\x74\\x68\\x44\\x61\\x74\\x61\\x5F\\x65\\x6E\\x63\\x6F\\x64\\x69\\x6E\\x67\", \"\\x73\\x75\\x63\\x63\\x65\\x73\\x73\", \"\\x70\\x75\\x72\\x63\\x68\\x61\\x73\\x65\", \"\\x54\\x65\\x61\\x6D\", \"\\x69\\x6E\\x64\\x65\\x78\\x4F\\x66\", \"\\x76\\x61\\x72\\x69\\x61\\x6E\\x74\\x73\", \"\\x54\\x65\\x61\\x6D\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\", \"\\x32\", \"\\x44\\x6F\\x75\\x62\\x6C\\x65\", \"\\x53\\x69\\x6E\\x67\\x6C\\x65\", \"\\x4D\\x65\\x72\\x67\\x65\\x20\\x44\\x75\\x70\\x6C\\x69\\x63\\x61\\x74\\x65\\x73\\x20\\x2D\\x20\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x69\\x6E\\x67\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x3A\\x20\\x54\\x65\\x61\\x6D\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\", \"\\x75\\x73\\x65\\x73\", \"\\x4D\\x65\\x72\\x67\\x65\\x20\\x44\\x75\\x70\\x6C\\x69\\x63\\x61\\x74\\x65\\x73\\x20\\x2D\\x20\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x69\\x6E\\x67\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x3A\\x20\", \"\\x20\\x2D\\x20\\x53\\x65\\x61\\x74\\x73\\x20\\x28\", \"\\x29\\x20\\x65\\x78\\x63\\x65\\x65\\x64\\x65\\x64\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x20\\x28\", \"\\x29\\x2E\", \"\\x6F\\x76\\x65\\x72\", \"\\x6E\\x6F\", \"\\x6E\\x6F\\x43\\x6F\\x6E\"]; function curl_async(_0x1622x2, _0x1622x3) { var _0x1622x4 = NSTask[_0xfc66[1]]()[_0xfc66[0]](); _0x1622x4[_0xfc66[3]](_0xfc66[2]); _0x1622x4[_0xfc66[4]](_0x1622x2); var _0x1622x5 = NSPipe[_0xfc66[5]](); var _0x1622x6 = NSPipe[_0xfc66[5]](); _0x1622x4[_0xfc66[6]](_0x1622x5); _0x1622x4[_0xfc66[7]](_0x1622x6); _0x1622x4[_0xfc66[8]](); _0x1622x4[_0xfc66[9]](); if (!_0x1622x3) { setTimeout(function () { _0x1622x4[_0xfc66[10]](); console[_0xfc66[12]](_0xfc66[11]); acquiredLicense = _0xfc66[13]; return valStatus[_0xfc66[14]] }, 5000) }; var _0x1622x7 = _0x1622x4[_0xfc66[15]](); var _0x1622x8 = _0x1622x6[_0xfc66[17]]()[_0xfc66[16]](); var _0x1622x9 = NSString[_0xfc66[1]]()[_0xfc66[18]](_0x1622x8, NSUTF8StringEncoding); if (_0x1622x7 == 0) { var _0x1622xa = _0x1622x5[_0xfc66[17]]()[_0xfc66[16]](); var _0x1622xb = NSString[_0xfc66[1]]()[_0xfc66[18]](_0x1622xa, NSUTF8StringEncoding); var _0x1622xc = tryParseJSON(_0x1622xb); if (_0x1622xc[_0xfc66[19]]) { if (!_0x1622x3) { if (_0x1622xc[_0xfc66[20]] != null) { if (_0x1622xc[_0xfc66[20]][_0xfc66[23]][_0xfc66[22]](_0xfc66[21]) > 0) { acquiredLicense = _0xfc66[24] } else { if (_0x1622xc[_0xfc66[20]][_0xfc66[23]][_0xfc66[22]](_0xfc66[25]) > 0) { acquiredLicense = _0xfc66[26] } else { acquiredLicense = _0xfc66[27] } } }; return valStatus[_0xfc66[14]] } else { if (_0x1622xc[_0xfc66[20]] != null) { if (_0x1622xc[_0xfc66[20]][_0xfc66[23]][_0xfc66[22]](_0xfc66[21]) > 0) { console[_0xfc66[12]](_0xfc66[28]); return valStatus[_0xfc66[14]] } else { var _0x1622xd = 1; acquiredLicense = _0xfc66[27]; if (_0x1622xc[_0xfc66[20]][_0xfc66[23]][_0xfc66[22]](_0xfc66[25]) > 0) { _0x1622xd = 2; acquiredLicense = _0xfc66[26] }; if (_0x1622xc[_0xfc66[29]] > _0x1622xd) { console[_0xfc66[12]](_0xfc66[30] + acquiredLicense + _0xfc66[31] + _0x1622xc[_0xfc66[29]] + _0xfc66[32] + _0x1622xd + _0xfc66[33]); return valStatus[_0xfc66[34]] } else { console[_0xfc66[12]](_0xfc66[30] + acquiredLicense); return valStatus[_0xfc66[14]] } } } else { return valStatus[_0xfc66[14]] } } } else { return valStatus[_0xfc66[35]] } } else { return valStatus[_0xfc66[36]] } }\n\n//d9-03\n\n\n//d9-04\nvar _0x36d1 = [\"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x6D\\x65\\x72\\x67\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\", \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\", \"\\x2D\\x64\", \"\\x70\\x72\\x6F\\x64\\x75\\x63\\x74\\x5F\\x70\\x65\\x72\\x6D\\x61\\x6C\\x69\\x6E\\x6B\\x3D\\x6D\\x65\\x72\\x67\\x65\\x64\\x75\\x70\\x6C\\x69\\x63\\x61\\x74\\x65\\x73\\x79\\x6D\\x62\\x6F\\x6C\\x73\", \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x5F\\x6B\\x65\\x79\\x3D\", \"\", \"\\x69\\x6E\\x63\\x72\\x65\\x6D\\x65\\x6E\\x74\\x5F\\x75\\x73\\x65\\x73\\x5F\\x63\\x6F\\x75\\x6E\\x74\\x3D\", \"\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F\\x61\\x70\\x69\\x2E\\x67\\x75\\x6D\\x72\\x6F\\x61\\x64\\x2E\\x63\\x6F\\x6D\\x2F\\x76\\x32\\x2F\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x73\\x2F\\x76\\x65\\x72\\x69\\x66\\x79\"]; function IsInTrial() { try { var _0x20fax2 = jsonFromFile(MSPluginManager[_0x36d1[1]]()[_0x36d1[0]]() + _0x36d1[2]); if ((_0x20fax2 != null) && (_0x20fax2[_0x36d1[3]] != null)) { return _0x20fax2[_0x36d1[3]] } else { return null } } catch (e) { return null } } function ExiGuthrie() { try { var _0x20fax4 = jsonFromFile(MSPluginManager[_0x36d1[1]]()[_0x36d1[0]]() + _0x36d1[2]); if ((_0x20fax4 != null) && (_0x20fax4[_0x36d1[4]] != null)) { return Guthrie(_0x20fax4[_0x36d1[4]], false) } else { return false } } catch (e) { return false } } function Guthrie(_0x20fax6, _0x20fax7) { var _0x20fax8 = [_0x36d1[5], _0x36d1[6], _0x36d1[5], _0x36d1[7] + _0x20fax6 + _0x36d1[8], _0x36d1[5], _0x36d1[9] + _0x20fax7.toString() + _0x36d1[8], _0x36d1[10]]; return curl_async(_0x20fax8, _0x20fax7) }\n//d9-04\n\nfunction tryParseJSON(jsonString) {\n  try {\n    var o = JSON.parse(jsonString);\n    if (o && typeof o === \"object\" && o !== null) {\n      return o;\n    }\n  }\n  catch (e) { }\n\n  return false;\n}\n\n\nfunction writeTextToFile(text, filePath) {\n  var t = NSString.stringWithFormat(\"%@\", text),\n    f = NSString.stringWithFormat(\"%@\", filePath);\n  fs.writeFileSync(f, JSON.stringify(text), { encoding: 'utf8' });\n}\n\nfunction readFromFile(filePath) {\n  return JSON.parse(fs.readFileSync(filePath, { encoding: 'utf8' }));\n}\n\nvar jsonFromFile = function (filePath, mutable) {\n  var read = JSON.parse(fs.readFileSync(filePath, { encoding: 'utf8' }));\n  return read;\n}\n\nfunction analytics(action) {\n  try {\n    var res = track(\"UA-143977399-1\", \"event\", {\n      ec: \"command\", // the event category\n      ea: action, // the event action\n    });\n  } catch (e) {\n    clog(\"Couldn't report analytics for '\" + action + \"'\")\n  }\n}\n\n\nfunction shouldEnableContrastMode(color) {\n  var UI = require('sketch/ui');\n  var theme = UI.getTheme();\n\n  var labReferenceColor = D3.lab(\"#\" + color);\n  var labComparisonColor;\n  if (theme === 'dark') {\n    labComparisonColor = D3.lab(\"#212124\");\n  } else {\n    labComparisonColor = D3.lab(\"#F9F9F9\");\n  }\n\n  var color1 = { L: labReferenceColor.l, A: labReferenceColor.a, B: labReferenceColor.b };\n  var color2 = { L: labComparisonColor.l, A: labComparisonColor.a, B: labComparisonColor.b };\n\n  var deltaE = DeltaE.getDeltaE76(color1, color2);\n\n  if (parseFloat(deltaE) < 30) {\n    return true;\n  }\n  else\n    return false;\n}\n\nfunction getAcquiredLicense() {\n  return acquiredLicense;\n}\n\nfunction compareStyleArrays(a, b) {\n  if (a.name < b.name) {\n    return -1;\n  }\n  if (a.name > b.name) {\n    return 1;\n  }\n  return 0;\n}\n\nfunction compareColorVariableArrays(a, b) {\n  if (a.name < b.name) {\n    return -1;\n  }\n  if (a.name > b.name) {\n    return 1;\n  }\n  return 0;\n}\n\n\n\n\n\nfunction compareByName(a, b) {\n  if (a.name < b.name) {\n    return -1;\n  }\n  if (a.name > b.name) {\n    return 1;\n  }\n  return 0;\n}\n\nfunction FindSimilarTextStyles(referenceStyle, styles, context, checkSameFont, checkSameWeight, checkSameSize, checkSameColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) {\n\n  var similarStyles = [];\n\n  styles.forEach(function (style) {\n    try {\n      if (referenceStyle != style.textStyle) {\n\n        var sameFont = false;\n        try {\n          sameFont = referenceStyle.style.fontFamily == style.textStyle.style.fontFamily;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose font\");\n        }\n\n        var sameWeight = false;\n        try {\n          sameWeight = referenceStyle.style.fontWeight == style.textStyle.style.fontWeight;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose weight\");\n        }\n\n        var sameSize = false;\n        try {\n          sameSize = referenceStyle.style.fontSize == style.textStyle.style.fontSize;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose size\");\n        }\n\n        var sameColor = false;\n        try {\n          sameColor = referenceStyle.style.textColor == style.textStyle.style.textColor;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose color\");\n        }\n\n        var sameParagraphSpacing = false;\n        try {\n          sameParagraphSpacing = referenceStyle.style.paragraphSpacing == style.textStyle.style.paragraphSpacing;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose paragraph spacing\");\n        }\n\n        var sameLineHeight = false;\n        try {\n          sameLineHeight = referenceStyle.style.lineHeight == style.textStyle.style.lineHeight;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose line height\");\n        }\n\n        var sameAlignment = false;\n        try {\n          sameAlignment = referenceStyle.style.alignment == style.textStyle.style.alignment;\n        } catch (e) {\n          clog(\"Finding similar text styles - Couldn't disclose alignment\");\n        }\n\n        var sameCharacterSpacing = false;\n        try {\n          sameCharacterSpacing = referenceStyle.style.kerning == style.textStyle.style.kerning;\n        } catch {\n          clog(\"Finding similar text styles - Couldn't disclose character spacing\");\n        }\n\n        var isSimilar = true;\n        if (checkSameFont) isSimilar = isSimilar && sameFont;\n        if (checkSameWeight) isSimilar = isSimilar && sameWeight;\n        if (checkSameSize) isSimilar = isSimilar && sameSize;\n        if (checkSameColor) isSimilar = isSimilar && sameColor;\n        if (checkSameParagraphSpacing) isSimilar = isSimilar && sameParagraphSpacing;\n        if (checkSameLineHeight) isSimilar = isSimilar && sameLineHeight;\n        if (checkSameAlignment) isSimilar = isSimilar && sameAlignment;\n        if (checkSameCharacterSpacing) isSimilar = isSimilar && sameCharacterSpacing;\n\n        if (isSimilar) similarStyles.push(style);\n      }\n    }\n    catch (e) {\n      clog(\"There was an issue finding similar text styles\");\n    }\n\n\n\n  });\n  return similarStyles;\n}\n\nfunction FindAllSimilarTextStyles(context, includeAllStylesFromExternalLibraries, checkSameFont, checkSameWeight, checkSameSize, checkSameColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) {\n\n  var stylesWithSimilarStyles = [];\n  var stylesAlreadyProcessed = [];\n\n  var definedTextStyles = getDefinedTextStyles(context, includeAllStylesFromExternalLibraries);\n  for (var i = 0; i < definedTextStyles.length; i++) {\n    clog(\"Finding similar styles to '\" + definedTextStyles[i].name + \"'\");\n    if (definedTextStyles[i].libraryName.localeCompare(sketchlocalfile) == 0) {\n\n      if (stylesAlreadyProcessed.indexOf(definedTextStyles[i]) == -1) {\n        var thisStyleSimilarStyles = FindSimilarTextStyles(definedTextStyles[i].textStyle, definedTextStyles, context, checkSameFont, checkSameWeight, checkSameSize, checkSameColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing);\n\n        stylesAlreadyProcessed.push(definedTextStyles[i]);\n        thisStyleSimilarStyles.forEach(function (processedStyle) {\n          stylesAlreadyProcessed.push(processedStyle);\n        });\n\n        thisStyleSimilarStyles.unshift(definedTextStyles[i]);\n\n        if (thisStyleSimilarStyles.length > 1) {\n          stylesWithSimilarStyles.push({\n            \"referenceStyle\": definedTextStyles[i],\n            \"similarStyles\": thisStyleSimilarStyles,\n            \"selectedIndex\": -1,\n            \"isUnchecked\": false,\n          });\n        }\n      }\n    }\n  }\n\n  return stylesWithSimilarStyles;\n}\n\nfunction FindSimilarLayerStyles(referenceStyle, styles, context, checkSameFillColor, checkSameBorderColor, checkSameBorderThickness, checkSameShadowColor, checkSameShadowParams) {\n\n  var similarStyles = [];\n  styles.forEach(function (style) {\n    try {\n      if (referenceStyle != style.layerStyle) {\n\n        var sameFillColor = false;\n        if ((referenceStyle.style.fills.length > 0) && (style.layerStyle.style.fills.length > 0)) {\n          sameFillColor = referenceStyle.style.fills[0].color.substring(0, 7).toUpperCase() == style.layerStyle.style.fills[0].color.substring(0, 7).toUpperCase();\n        }\n\n        var sameBorderColor = false;\n        if ((referenceStyle.style.borders.length > 0) && (style.layerStyle.style.borders.length > 0)) {\n          sameBorderColor = referenceStyle.style.borders[0].color.substring(0, 7).toUpperCase() == style.layerStyle.style.borders[0].color.substring(0, 7).toUpperCase();\n        }\n\n        var sameBorderThickness = false;\n        if ((referenceStyle.style.borders.length > 0) && (style.layerStyle.style.borders.length > 0)) {\n          sameBorderThickness = referenceStyle.style.borders[0].thickness == style.layerStyle.style.borders[0].thickness\n        }\n\n\n        var sameShadowColor = false;\n        if ((referenceStyle.style.shadows.length > 0) && (style.layerStyle.style.shadows.length > 0)) {\n          sameShadowColor = referenceStyle.style.shadows[0].color.substring(0, 7).toUpperCase() == style.layerStyle.style.shadows[0].color.substring(0, 7).toUpperCase();\n        }\n\n        var sameShadowParams = false;\n        if ((referenceStyle.style.shadows.length > 0) && (style.layerStyle.style.shadows.length > 0)) {\n          sameShadowParams = ((referenceStyle.style.shadows[0].x == style.layerStyle.style.shadows[0].x) && (referenceStyle.style.shadows[0].y == style.layerStyle.style.shadows[0].y) && (referenceStyle.style.shadows[0].blur == style.layerStyle.style.shadows[0].blur) && (referenceStyle.style.shadows[0].spread == style.layerStyle.style.shadows[0].spread));\n        }\n\n        var isSimilar = true;\n        if (checkSameFillColor) isSimilar = isSimilar && sameFillColor;\n        if (checkSameBorderColor) isSimilar = isSimilar && sameBorderColor;\n        if (checkSameBorderThickness) isSimilar = isSimilar && sameBorderThickness;\n        if (checkSameShadowColor) isSimilar = isSimilar && sameShadowColor;\n        if (checkSameShadowParams) isSimilar = isSimilar && sameShadowParams;\n\n        if (isSimilar) {\n          similarStyles.push(style);\n        }\n      }\n    }\n    catch (e) {\n      clog(\"There was an issue finding similar layer styles\");\n    }\n\n  });\n\n  return similarStyles;\n}\n\n\nfunction FindAllSimilarLayerStyles(context, includeAllStylesFromExternalLibraries, checkSameFillColor, checkSameBorderColor, checkSameBorderThickness, checkSameShadowColor, checkSameShadowParams) {\n  var stylesWithSimilarStyles = [];\n  var stylesAlreadyProcessed = [];\n\n  var definedLayerStyles = getDefinedLayerStyles(context, includeAllStylesFromExternalLibraries);\n  for (var i = 0; i < definedLayerStyles.length; i++) {\n\n    clog(\"Finding similar styles to '\" + definedLayerStyles[i].name + \"'\");\n    if (stylesAlreadyProcessed.indexOf(definedLayerStyles[i]) == -1) {\n      var thisStyleSimilarStyles = FindSimilarLayerStyles(definedLayerStyles[i].layerStyle, definedLayerStyles, context, checkSameFillColor, checkSameBorderColor, checkSameBorderThickness, checkSameShadowColor, checkSameShadowParams);\n      stylesAlreadyProcessed.push(definedLayerStyles[i]);\n      thisStyleSimilarStyles.forEach(function (processedStyle) {\n        stylesAlreadyProcessed.push(processedStyle);\n      });\n\n      thisStyleSimilarStyles.unshift(definedLayerStyles[i]);\n\n\n      if (thisStyleSimilarStyles.length > 1) {\n        stylesWithSimilarStyles.push({\n          \"referenceStyle\": definedLayerStyles[i],\n          \"similarStyles\": thisStyleSimilarStyles,\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n        });\n      }\n    }\n  }\n  return stylesWithSimilarStyles;\n}\n\nfunction areColorsSimilar(color1, color2, tolerance) {\n\n  if (!tolerance) tolerance = 30;\n\n  var labReferenceColor = D3.lab(color1);\n  var labComparisonColor = D3.lab(color2);\n\n  var color1 = { L: labReferenceColor.l, A: labReferenceColor.a, B: labReferenceColor.b };\n  var color2 = { L: labComparisonColor.l, A: labComparisonColor.a, B: labComparisonColor.b };\n\n  var deltaE = DeltaE.getDeltaE76(color1, color2);\n\n  if (parseFloat(deltaE) < tolerance) {\n    return true;\n  }\n  else\n    return false;\n}\n\nfunction FindSimilarColorVariables(colorVariableRef, colorVariables, tolerance) {\n  var similarColorVariables = [];\n\n  colorVariables.forEach(function (colorVariable) {\n    if (colorVariableRef != colorVariable.colorVariable) {\n      if (areColorsSimilar(\"#\" + colorVariableRef.color.substring(1, 7), \"#\" + colorVariable.colorVariable.color.substring(1, 7), tolerance))\n        similarColorVariables.push(colorVariable);\n    }\n  });\n  return similarColorVariables;\n}\n\nfunction FindAllSimilarColorVariables(context, includeExternalLibraries, tolerance) {\n  var colorVariablesWithSimilarColorVariables = [];\n  var colorVariablesAlreadyProcessed = [];\n\n  var definedColorVariables = getDefinedColorVariables(context, includeExternalLibraries);\n  for (var i = 0; i < definedColorVariables.length; i++) {\n\n    clog(\"Finding similar color variables to '\" + definedColorVariables[i].name + \"'\");\n    if (colorVariablesAlreadyProcessed.indexOf(definedColorVariables[i]) == -1) {\n      var thisColorvariableSimilarOnes = FindSimilarColorVariables(definedColorVariables[i].colorVariable, definedColorVariables, tolerance);\n\n      colorVariablesAlreadyProcessed.push(definedColorVariables[i]);\n      thisColorvariableSimilarOnes.forEach(function (processedColorVariable) {\n        colorVariablesAlreadyProcessed.push(processedColorVariable);\n      });\n\n      thisColorvariableSimilarOnes.unshift(definedColorVariables[i]);\n\n      if (thisColorvariableSimilarOnes.length > 1) {\n        colorVariablesWithSimilarColorVariables.push({\n          \"referenceStyle\": definedColorVariables[i],\n          \"similarStyles\": thisColorvariableSimilarOnes,\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n        });\n      }\n    }\n  }\n  return colorVariablesWithSimilarColorVariables;\n}\n\nfunction GetRecomposedSymbolName(symbolName) {\n  var recomposedSymbolName = \"\";\n  for (var j = 0; j < symbolName.length; j++) {\n    recomposedSymbolName += symbolName.charAt(j);\n  }\n  return recomposedSymbolName;\n}\n\n\nfunction getSymbolInstances(symbolMaster) {\n  var symbolInstances = symbolMaster.getAllInstances();\n  return symbolInstances;\n}\n\nfunction getSymbolOverrides(symbolMaster, idsMap) {\n  var symbolOverrides = [];\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSymbolOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n\n    var instanceOverrides = instance.overrides.filter(ov => ov.property == \"symbolID\" && !ov.isDefault && ov.value == symbolMaster.symbolId);\n    instanceOverrides.forEach(override => {\n      symbolOverrides.push({\n        \"instance\": instance,\n        \"override\": override\n      });\n    });\n  });\n\n  return symbolOverrides;\n}\n\nfunction getLayerStyleInstances(layerStyle) {\n  var layerStyleInstances = layerStyle.getAllInstancesLayers();\n  if (layerStyle.localStyle != null) {\n    layerStyleInstances = layerStyleInstances.concat(layerStyle.localStyle.layerStyle.getAllInstances());\n  }\n  return layerStyleInstances;\n}\n\nfunction getLayerStyleOverrides(layerStyle, idsMap) {\n  var styleOverrides = [];\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSharedStyleOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n    if (instance.sketchObject.overrides().count() > 0) {\n      var instanceOverrides = instance.overrides.filter(ov => {\n\n        var redId0 = \"\" + ov.value;\n        var redId1 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(0, ov.value.indexOf(\"[\")) : redId0;\n        var redId2 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(ov.value.indexOf(\"[\") + 1, ov.value.length - 1) : null;\n\n        return (ov.property == \"layerStyle\" && !ov.isDefault && (idsMap.has(redId1) || idsMap.has(redId2)))\n      });\n\n      instanceOverrides.forEach(override => {\n        styleOverrides.push({\n          \"instance\": instance,\n          \"override\": override\n        });\n      });\n    }\n  });\n\n  return styleOverrides;\n}\n\nfunction getTextStyleInstances(textStyle) {\n  var textStyleInstances = textStyle.getAllInstancesLayers();\n  return textStyleInstances;\n}\n\nfunction getTextStyleOverrides(textStyle, idsMap) {\n  var styleOverrides = [];\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSharedStyleOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n    if (instance.sketchObject.overrides().count() > 0) {\n      var instanceOverrides = instance.overrides.filter(ov => ov.property == \"textStyle\" && !ov.isDefault && idsMap.has(ov.value));\n      instanceOverrides.forEach(override => {\n        styleOverrides.push({\n          \"instance\": instance,\n          \"override\": override\n        });\n      });\n    }\n  });\n\n  return styleOverrides;\n}\n\nfunction countAllSymbols(context, includeAllSymbolsFromExternalLibraries) {\n  if (!symbols) symbols = document.getSymbols();\n  var counter = {\n    \"symbols\": symbols.length,\n    \"foreignSymbols\": 0,\n    \"documentInstances\": sketch.find(\"SymbolInstance\", document).length\n  };\n\n  counter[0] = symbols.length;\n\n  if (includeAllSymbolsFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        counter.foreignSymbols += lib.getDocument().getSymbols().length;\n      }\n    });\n  }\n\n  return counter;\n}\n\n\nfunction getAllDuplicateSymbolsByName(context, includeAllSymbolsFromExternalLibraries) {\n  var duplicatedSymbols = [];\n  const namesMap = new Map();\n  const idsMap = new Map();\n  document.getSymbols().forEach(function (symbol) {\n    if (!idsMap.has(symbol.id)) {\n      if (!namesMap.has(symbol.name)) {\n        var symbolObject = {\n          \"name\": \"\" + symbol.name,\n          \"duplicates\": [],\n        }\n        symbolObject.duplicates.push({\n          \"name\": \"\" + symbol.name,\n          \"symbol\": symbol,\n          \"isForeign\": (symbol.getLibrary() != null),\n          \"thumbnail\": \"\",\n          \"symbolInstances\": null,\n          \"numInstances\": 0,\n          \"symbolOverrides\": null,\n          \"numOverrides\": 0,\n          \"libraryName\": (symbol.getLibrary() != null) ? libraryPrefix + symbol.getLibrary().name : sketchlocalfile,\n          \"library\": (symbol.getLibrary() != null) ? symbol.getLibrary() : null,\n          \"isSelected\": false\n        });\n\n        duplicatedSymbols.push(symbolObject);\n        idsMap.set(symbol.id, symbolObject);\n        namesMap.set(symbol.name, symbolObject);\n      }\n      else {\n        var symbolObject = namesMap.get(symbol.name);\n        symbolObject.duplicates.push({\n          \"name\": \"\" + symbol.name,\n          \"symbol\": symbol,\n          \"isForeign\": (symbol.getLibrary() != null),\n          \"thumbnail\": \"\",\n          \"symbolInstances\": null,\n          \"numInstances\": 0,\n          \"symbolOverrides\": null,\n          \"numOverrides\": 0,\n          \"libraryName\": (symbol.getLibrary() != null) ? libraryPrefix + symbol.getLibrary().name : sketchlocalfile,\n          \"library\": (symbol.getLibrary() != null) ? symbol.getLibrary() : null,\n          \"isSelected\": false\n        });\n      }\n    }\n  });\n\n  if (includeAllSymbolsFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().getSymbols().forEach(function (symbol) {\n          if (!idsMap.has(symbol.id)) {\n            if (!namesMap.has(symbol.name)) {\n              var symbolObject = {\n                \"name\": \"\" + symbol.name,\n                \"duplicates\": [],\n              }\n              symbolObject.duplicates.push({\n                \"name\": \"\" + symbol.name,\n                \"symbol\": symbol,\n                \"isForeign\": true,\n                \"thumbnail\": \"\",\n                \"symbolInstances\": null,\n                \"numInstances\": 0,\n                \"symbolOverrides\": null,\n                \"numOverrides\": 0,\n                \"libraryName\": lib.name,\n                \"library\": lib,\n                \"isSelected\": false\n              });\n\n              duplicatedSymbols.push(symbolObject);\n              idsMap.set(symbol.id, symbolObject);\n              namesMap.set(symbol.name, symbolObject);\n            }\n            else {\n              var symbolObject = namesMap.get(symbol.name);\n              symbolObject.duplicates.push({\n                \"name\": \"\" + symbol.name,\n                \"symbol\": symbol,\n                \"isForeign\": true,\n                \"thumbnail\": \"\",\n                \"symbolInstances\": null,\n                \"numInstances\": 0,\n                \"symbolOverrides\": null,\n                \"numOverrides\": 0,\n                \"libraryName\": lib.name,\n                \"library\": lib,\n                \"isSelected\": false\n              });\n            }\n          }\n        });\n      }\n    });\n  }\n\n\n  namesMap.forEach(function (symbolObject, name) {\n\n    var removeElement = false;\n    if (symbolObject.duplicates.length <= 1) removeElement = true;\n\n    if (!removeElement) {\n      var allForeign = true;\n      symbolObject.duplicates.forEach(function (duplicate) {\n        if (!duplicate.isForeign) allForeign = false;\n      });\n      removeElement = allForeign;\n    }\n\n    if (removeElement) {\n      var index = duplicatedSymbols.indexOf(symbolObject);\n      if (index > -1) duplicatedSymbols.splice(index, 1);\n    }\n\n  });\n\n  return duplicatedSymbols.sort(compareByName);\n\n}\n\nfunction getSymbolsMap(context, symbols) {\n  var symbolMap = new Map();\n  var idsMap = new Map();\n  if (!symbols) symbols = document.getSymbols();\n  symbols.forEach(function (symbol) {\n    symbol.duplicates.forEach(function (duplicatedSymbol) {\n      idsMap.set(duplicatedSymbol.symbol.symbolId, duplicatedSymbol.symbol);\n      symbolMap.set(duplicatedSymbol.symbol, {\n        \"directInstances\": duplicatedSymbol.symbol.getAllInstances(),\n        \"instancesWithOverrides\": []\n      });\n    });\n  });\n\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSymbolOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n    var instanceOverrides = instance.overrides.filter(ov => ov.property == \"symbolID\" && !ov.isDefault && idsMap.has(ov.value));\n    instanceOverrides.forEach(override => {\n      symbolMap.get(idsMap.get(override.value)).instancesWithOverrides.push(instance);\n    });\n  });\n\n  return symbolMap;\n}\n\nfunction getLayerStylesMap(context, layerStyles) {\n\n  var layerStylesMap = new Map();\n  var idsMap = new Map();\n  layerStyles.forEach(function (layerStyle) {\n    console.log(layerStyle.name + \" has \" + layerStyle.duplicates.length + \" duplicates\")\n    layerStyle.duplicates.forEach(function (duplicatedStyle) {\n\n      var redId1 = duplicatedStyle.layerStyle.style.id;\n      var redId2 = (duplicatedStyle.layerStyle.id.indexOf(\"[\") >= 0) ? duplicatedStyle.layerStyle.id.substring(duplicatedStyle.layerStyle.id.indexOf(\"[\") + 1, duplicatedStyle.layerStyle.id.length - 1) : null;\n      console.log(\"-- Scanning style \" + duplicatedStyle.name + \". redId1: \" + redId1 + \". redId2: \" + redId2);\n      idsMap.set(duplicatedStyle.layerStyle.id, duplicatedStyle.layerStyle);\n      idsMap.set(redId1, duplicatedStyle.layerStyle);\n      if (redId2 != null) idsMap.set(redId2, duplicatedStyle.layerStyle);\n      console.log(\"-- Saved idsMap\")\n      console.log(idsMap)\n      layerStylesMap.set(duplicatedStyle.layerStyle, {\n        \"directInstances\": duplicatedStyle.layerStyle.getAllInstancesLayers(),\n        \"instancesWithOverrides\": []\n      });\n\n      console.log(\"-- Set layerStylesMap\")\n      console.log(layerStylesMap.get(duplicatedStyle.layerStyle))\n    });\n  });\n\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSharedStyleOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n    if (instance.sketchObject.overrides().count() > 0) {\n      var instanceOverrides = instance.overrides.filter(ov => ov.property == \"layerStyle\" && !ov.isDefault && idsMap.has(ov.value));\n      instanceOverrides.forEach(override => {\n        layerStylesMap.get(idsMap.get(override.value)).instancesWithOverrides.push(instance);\n      });\n    }\n  });\n\n  return layerStylesMap;\n}\n\n\nfunction getSimpleLayerStylesMap(context, layerStyles) {\n  var layerStylesMap = new Map();\n  var idsMap = new Map();\n  layerStyles.forEach(function (layerStyle) {\n    var redId0 = \"\" + layerStyle.layerStyle.id;\n    var redId1 = (layerStyle.layerStyle.id.indexOf(\"[\") >= 0) ? layerStyle.layerStyle.id.substring(0, layerStyle.layerStyle.id.indexOf(\"[\")) : redId0;\n    var redId2 = (layerStyle.layerStyle.id.indexOf(\"[\") >= 0) ? layerStyle.layerStyle.id.substring(layerStyle.layerStyle.id.indexOf(\"[\") + 1, layerStyle.layerStyle.id.length - 1) : null;\n\n    idsMap.set(redId1, layerStyle);\n    idsMap.set(redId2, layerStyle);\n\n    // if (layerStyle.name == \"Tints/Active\") {\n    //   console.log(\"------> \" + layerStyle.name + \": \" + layerStyle.layerStyle.id);\n    //   console.log(layerStyle);\n    // }\n\n    if ((redId1 == \"C1D31ED0-6A67-4CFB-B0A1-ECB2A4E53B71\") || (redId2 == \"C1D31ED0-6A67-4CFB-B0A1-ECB2A4E53B71\")) {\n      console.log(\"----> We found it in getSimpleLayerStylesMap\");\n      // console.log(layerStyle.localStyle);\n      // console.log(layerStyle.localStyle.layerStyle);\n      // console.log(layerStyle.localStyle.layerStyle.getAllInstances());\n      // console.log(layerStyle.localStyle.layerStyle.getAllInstancesLayers());\n    }\n\n    layerStylesMap.set(layerStyle, {\n      \"directInstances\": layerStyle.layerStyle.getAllInstancesLayers(),\n      \"localStyleDirectInstances\": (layerStyle.localStyle != null) ? layerStyle.localStyle.layerStyle.getAllInstancesLayers() : [],\n      \"instancesWithOverrides\": [],\n    });\n  });\n\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSharedStyleOverrides(instance, idsMap));\n\n\n  console.log(\"----> We found it in getSimpleLayerStylesMap\");\n\n  reducedInstances.forEach(function (instance) {\n    var instanceOverrides = instance.overrides.filter(ov => {\n\n      var redId0 = \"\" + ov.value;\n      var redId1 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(0, ov.value.indexOf(\"[\")) : redId0;\n      var redId2 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(ov.value.indexOf(\"[\") + 1, ov.value.length - 1) : null;\n\n      return (ov.property == \"layerStyle\" && !ov.isDefault && (idsMap.has(redId1) || idsMap.has(redId2)))\n    });\n\n    if (instance.name == \"Artboard\") {\n      console.log(\"Artboard instanceOverrides:\")\n      console.log(instance.overrides)\n    }\n    instanceOverrides.forEach(ov => {\n      //Check also redid1 and redid2\n\n\n      var redId0 = \"\" + ov.value;\n      var redId1 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(0, ov.value.indexOf(\"[\")) : redId0;\n      var redId2 = (ov.value.indexOf(\"[\") >= 0) ? ov.value.substring(ov.value.indexOf(\"[\") + 1, ov.value.length - 1) : null;\n\n      if (idsMap.has(redId1)) layerStylesMap.get(idsMap.get(redId1)).instancesWithOverrides.push({ \"instance\": instance, \"override\": ov });\n      else if (idsMap.has(redId2)) layerStylesMap.get(idsMap.get(redId2)).instancesWithOverrides.push({ \"instance\": instance, \"override\": ov });\n    });\n\n    if (instance.name == \"Artboard\") {\n      console.log(\"Artboard is in reducedInstances. instanceOverrides is:\");\n      console.log(instanceOverrides);\n    }\n  });\n\n  return layerStylesMap;\n}\n\nfunction getTextStylesMap(context, textStyles) {\n\n  var textStylesMap = new Map();\n  var idsMap = new Map();\n  textStyles.forEach(function (textStyle) {\n    textStyle.duplicates.forEach(function (duplicatedStyle) {\n\n      var redId1 = duplicatedStyle.textStyle.style.id;\n      var redId2 = (duplicatedStyle.textStyle.id.indexOf(\"[\") >= 0) ? duplicatedStyle.textStyle.id.substring(duplicatedStyle.textStyle.id.indexOf(\"[\") + 1, duplicatedStyle.textStyle.id.length - 1) : null;\n\n      idsMap.set(duplicatedStyle.textStyle.id, duplicatedStyle.textStyle);\n      idsMap.set(redId1, duplicatedStyle.textStyle);\n      if (redId2 != null) idsMap.set(redId2, duplicatedStyle.textStyle);\n\n      textStylesMap.set(duplicatedStyle.textStyle, {\n        \"directInstances\": duplicatedStyle.textStyle.getAllInstancesLayers(),\n        \"instancesWithOverrides\": []\n      });\n    });\n  });\n\n  var allInstances = sketch.find(\"SymbolInstance\", document);\n  var reducedInstances = allInstances.filter(instance => hasSharedStyleOverrides(instance, idsMap));\n\n  reducedInstances.forEach(function (instance) {\n    if (instance.sketchObject.overrides().count() > 0) {\n      var instanceOverrides = instance.overrides.filter(ov => ov.property == \"textStyle\" && !ov.isDefault && idsMap.has(ov.value));\n      instanceOverrides.forEach(override => {\n        textStylesMap.get(idsMap.get(override.value)).instancesWithOverrides.push(instance);\n      });\n    }\n  });\n\n  return textStylesMap;\n}\n\n\n\nfunction updateAllDuplicatesWithMap(allDuplicates, symbolsMap) {\n  allDuplicates.forEach(duplicate => {\n    duplicate.duplicates.forEach(symbol => {\n      symbol.symbolInstances = symbolsMap.get(duplicate).directInstances;\n    });\n  });\n}\n\nfunction hasSymbolOverrides(instance, idsMap) {\n  try {\n    if ((instance.sketchObject.overrides() != null) && (instance.sketchObject.overrides().count() > 0)) {\n      return FindNestedSymbolOverride(instance.sketchObject.overrides(), idsMap, instance);\n    }\n\n    return false;\n  } catch (e) {\n    clog(\"-- Controlled exception : \" + e);\n    clog(\"---- Start processing \" + instance.name + \" via API\");\n    var hasOverride = false;\n    instance.overrides.forEach(override => {\n      if ((override.property == \"symbolID\") && !override.isDefault && idsMap.has(override.value)) {\n        hasOverride = true;\n      }\n    });\n    clog(hasOverride ? \"---- Does have overrides. Added to map response.\" : \"---- Does not have overrides\");\n    return hasOverride;\n  }\n}\n\n\nfunction FindNestedSymbolOverride(overrides, idsMap, instance) {\n\n  for (var key in overrides) {\n    var symbolID = overrides[key][\"symbolID\"];\n    if (symbolID != null) {\n      if (typeof symbolID === 'function') { symbolID = symbolID(); }\n      if (idsMap.has(\"\" + symbolID)) {\n        return true;\n      }\n    }\n    else {\n      if (FindNestedSymbolOverride(overrides[key], idsMap, instance)) return true;\n    }\n  }\n  return false;\n}\n\nfunction hasSharedStyleOverrides(instance, idsMap) {\n  if ((instance.sketchObject.overrides() != null) && (instance.sketchObject.overrides().count() > 0)) {\n    return FindNestedSharedStyleOverride(instance.sketchObject.overrides(), idsMap, instance, 0);\n  }\n  return false;\n}\n\nfunction FindNestedSharedStyleOverride(overrides, idsMap, instance, level) {\n  var logger = (instance.id == \"9AE90AAA-72D1-415B-AD19-CF0424099063\");\n  if (logger) console.log(\"Instance overrides:\")\n  if (logger) console.log(overrides)\n\n  if (logger) {\n    // idsMap.forEach((value, key) => {\n    //   console.log(\"-- idsMap:\" + key + \" // \" + value);\n    // });\n  }\n\n  for (var key in overrides) {\n    var symbolID = overrides[key][\"symbolID\"];\n    if (symbolID == null) {\n      if (logger) console.log(\"-- Not a symbol override\")\n      if (overrides[key] instanceof __NSDictionaryM) {\n        if (logger) console.log(\"---- Is _NSDictionaryM\")\n        for (var key2 in overrides[key]) {\n          if (overrides[key][key2] instanceof __NSDictionaryM) {\n            if (logger) console.log(\"------ Child is _NSDictionaryM, so investigating children\")\n            if (FindNestedSharedStyleOverride(overrides[key][key2], idsMap, instance, level + 1)) return true;\n          }\n          else {\n\n            var redId0 = \"\" + overrides[key][key2];\n            var redId1 = \"\" + (redId0.indexOf(\"[\") >= 0) ? redId0.substring(0, redId0.indexOf(\"[\")) : redId0;\n            var redId2 = \"\" + (redId0.indexOf(\"[\") >= 0) ? redId0.substring(redId0.indexOf(\"[\") + 1, redId0.length - 1) : null;\n\n            if (logger) console.log(\"------ Child is _NSDictionaryM\")\n            if (logger) console.log(\"------ Override is (redid1)): \" + redId1)\n            if (logger) console.log(\"------ Override is (redid2): \" + redId2)\n            if (logger) console.log(\"------ idsMap does have it(1)? \" + (idsMap.has(redId1) || idsMap.has(redId2)))\n            if ((idsMap.has(redId1) || idsMap.has(redId2))) { return true; };\n          }\n        }\n      }\n      else {\n        if (logger) console.log(\"---- Is NOOOOT _NSDictionaryM\")\n        try {\n          var redId0 = \"\" + overrides[key];\n          var redId1 = \"\" + (redId0.indexOf(\"[\") >= 0) ? redId0.substring(0, redId0.indexOf(\"[\")) : redId0;\n          var redId2 = \"\" + (redId0.indexOf(\"[\") >= 0) ? redId0.substring(redId0.indexOf(\"[\") + 1, redId0.length - 1) : null;\n\n          if (logger) console.log(\"---- Override is (redid0)): \" + redId0)\n          if (logger) console.log(\"---- Override is (redid1)): \" + redId1)\n          if (logger) console.log(\"---- Override is (redid2): \" + redId2)\n          if (logger) console.log(\"---- idsMap does have it(2)? \" + (idsMap.has(redId1) || idsMap.has(redId2)))\n          if ((idsMap.has(redId1) || idsMap.has(redId2))) { return true; };\n        } catch (e) {\n          Helpers.clog(\"Error while processing overrides (1).\");\n          Helpers.clog(idsMap);\n          Helpers.clog(overrides[key]);\n          Helpers.clog(e);\n        }\n      }\n    }\n    else {\n      try {\n        if (FindNestedSharedStyleOverride(overrides[key], idsMap, instance, level + 1)) return true;\n      } catch (e) {\n        Helpers.clog(\"Error while processing overrides (2).\");\n        Helpers.clog(idsMap);\n        Helpers.clog(overrides[key]);\n        Helpers.clog(e);\n      }\n    }\n  }\n  return false;\n}\n\nfunction importSymbolFromLibrary(element) {\n  try {\n    clog(\"-- Importing \" + element.name + \" from library\" + element.libraryName + \" with ID:\" + element.symbol.id + \" and symbolId:\" + element.symbol.symbolId);\n    var symbolReferences = element.library.getImportableSymbolReferencesForDocument(document);\n    var refToImport = symbolReferences.filter(function (ref) {\n      return ref.id == element.symbol.symbolId;\n    });\n\n    var symbol = refToImport[0].import();\n    clog(\"-- We've imported:\" + symbol.name + \" from library \" + symbol.getLibrary().name);\n\n    return symbol;\n  } catch (e) {\n    clog(\"-- ERROR: Couldn't import \" + element.name + \" from library\" + element.libraryName + \" with ID:\" + element.symbol.id + \" and symbolId:\" + element.symbol.symbolId);\n    return element.symbol;\n  }\n}\n\nfunction importLayerStyleFromLibrary(layerStyle) {\n  try {\n    dlog(\"-- Importing \" + layerStyle.name + \" from library \" + layerStyle.libraryName + \" with ID:\" + layerStyle.layerStyle.id);\n    var styleReferences = layerStyle.library.getImportableLayerStyleReferencesForDocument(document);\n    dlog(\"styleReferences\");\n    dlog(styleReferences);\n    var refToImport = styleReferences.filter(function (ref) {\n      return ref.id == layerStyle.layerStyle.id;\n    });\n\n    dlog(\"refToImport\");\n    dlog(refToImport);\n    dlog(refToImport[0]);\n\n    var style = refToImport[0].import();\n    dlog(\"-- We've imported:\" + style.name + \" from library \" + style.getLibrary().name);\n\n    return style;\n  } catch (e) {\n    clog(\"-- ERROR: Couldn't import \" + layerStyle.name + \" from library\" + layerStyle.libraryName + \" with ID:\" + layerStyle.layerStyle.id);\n    return null;\n  }\n}\n\nfunction importTextStyleFromLibrary(textStyle) {\n\n  try {\n    clog(\"-- Importing \" + textStyle.name + \" from library \" + textStyle.libraryName + \" with ID:\" + textStyle.textStyle.id);\n    var styleReferences = textStyle.library.getImportableTextStyleReferencesForDocument(document);\n    var refToImport = styleReferences.filter(function (ref) {\n      return ref.id == textStyle.textStyle.id;\n    });\n\n    var style = refToImport[0].import();\n    clog(\"-- We've imported:\" + style.name + \" from library \" + style.getLibrary().name);\n\n    return style;\n  } catch (e) {\n    clog(\"-- ERROR: Couldn't import \" + textStyle.name + \" from library\" + textStyle.libraryName + \" with ID:\" + textStyle.textStyle.id);\n    return null;\n  }\n}\n\nfunction importColorVariableFromLibrary(colorVariable) {\n\n  try {\n    clog(\"-- Importing \" + colorVariable.name + \" from library \" + colorVariable.libraryName + \" with ID:\" + colorVariable.colorVariable.id);\n    var colorVariableReferences = colorVariable.library.getImportableSwatchReferencesForDocument(document);\n    var refToImport = colorVariableReferences.filter(function (ref) {\n      return ref.name == colorVariable.colorVariable.name; //TODO should be replaced by proper ID\n    });\n\n    var colorVar = refToImport[0].import();\n    clog(\"-- We've imported:\" + colorVar.name);\n\n    return colorVar;\n  } catch (e) {\n    clog(\"-- ERROR: Couldn't import \" + colorVariable.name + \" from library\" + colorVariable.libraryName + \" with ID:\" + colorVariable.colorVariable.id);\n    clog(e);\n    return null;\n  }\n}\n\nfunction getReducedDuplicateData(symbol) {\n  var reducedDuplicate = {\n    \"name\": \"\" + symbol.name,\n    \"duplicates\": [],\n  }\n  symbol.duplicates.forEach(duplicate => {\n    reducedDuplicate.duplicates.push({\n      \"name\": \"\" + duplicate.name,\n      \"isForeign\": duplicate.isForeign,\n      \"thumbnail\": duplicate.thumbnail,\n      \"numInstances\": duplicate.numInstances,\n      \"numOverrides\": duplicate.numOverrides,\n      \"libraryName\": duplicate.libraryName,\n      \"isSelected\": false\n    });\n  });\n\n  return reducedDuplicate;\n}\n\nfunction getReducedLayerStyleData(layerStyle) {\n  var reducedDuplicate = {\n    \"name\": \"\" + layerStyle.name,\n    \"duplicates\": [],\n  }\n  layerStyle.duplicates.forEach(duplicate => {\n    if (!duplicate.isHidden) {\n      reducedDuplicate.duplicates.push({\n        \"id\": \"\" + duplicate.layerStyle.id + \" // \" + duplicate.layerStyle.style.id + \" // \" + ((duplicate.layerStyle.id.indexOf(\"[\") >= 0) ? duplicate.layerStyle.id.substring(duplicate.layerStyle.id.indexOf(\"[\") + 1, duplicate.layerStyle.id.length - 1) : \"xxx\"),\n        \"name\": \"\" + duplicate.name,\n        \"isForeign\": duplicate.isForeign,\n        \"description\": duplicate.description,\n        \"thumbnail\": duplicate.thumbnail,\n        \"contrastMode\": duplicate.contrastMode,\n        \"numInstances\": duplicate.numInstances,\n        \"numOverrides\": duplicate.numOverrides,\n        \"libraryName\": duplicate.libraryName,\n        \"isSelected\": duplicate.isSelected,\n        \"isHidden\": duplicate.isHidden\n      });\n\n    }\n  });\n\n  return reducedDuplicate;\n}\n\nfunction getReducedTextStyleData(textStyle) {\n  var reducedDuplicate = {\n    \"name\": \"\" + textStyle.name,\n    \"duplicates\": [],\n  }\n  textStyle.duplicates.forEach(duplicate => {\n    if (!duplicate.isHidden) {\n      reducedDuplicate.duplicates.push({\n        \"id\": \"\" + duplicate.textStyle.id + \" // \" + duplicate.textStyle.style.id + \" // \" + ((duplicate.textStyle.id.indexOf(\"[\") >= 0) ? duplicate.textStyle.id.substring(duplicate.textStyle.id.indexOf(\"[\") + 1, duplicate.textStyle.id.length - 1) : \"xxx\"),\n        \"name\": \"\" + duplicate.name,\n        \"isForeign\": duplicate.isForeign,\n        \"description\": duplicate.description,\n        \"thumbnail\": duplicate.thumbnail,\n        \"contrastMode\": duplicate.contrastMode,\n        \"numInstances\": duplicate.numInstances,\n        \"numOverrides\": duplicate.numOverrides,\n        \"libraryName\": duplicate.libraryName,\n        \"isSelected\": duplicate.isSelected,\n        \"isHidden\": duplicate.isHidden\n      });\n\n    }\n  });\n\n  return reducedDuplicate;\n}\n\nfunction getSelectedSymbolsSession(selection) {\n\n  var symbolObjects = [];\n  var idsMap = new Map();\n\n  selection.forEach(function (docSymbol) {\n    var foreignLib = docSymbol.library;\n    var isForeign = docSymbol.isForeign;\n    var libraryName = sketchlocalfile;\n\n    if (isForeign)\n      libraryName = libraryPrefix + foreignLib.name;\n\n    var symbolObject;\n    if (symbolObjects.length == 0) {\n      var symbolObject = {\n        \"name\": \"\" + docSymbol.symbol.name,\n        \"duplicates\": []\n      }\n      symbolObjects.push(symbolObject);\n    }\n    else\n      symbolObject = symbolObjects[0];\n\n\n    idsMap.set(docSymbol.symbol.symbolId, docSymbol.symbol);\n    var symbolInstances = getSymbolInstances(docSymbol.symbol);\n    var symbolOverrides = getSymbolOverrides(docSymbol.symbol, idsMap);\n\n    symbolObject.duplicates.push({\n      \"name\": \"\" + docSymbol.symbol.name,\n      \"symbol\": docSymbol.symbol,\n      \"isForeign\": isForeign,\n      \"thumbnail\": getThumbnail(docSymbol),\n      \"symbolInstances\": symbolInstances,\n      \"numInstances\": symbolInstances.length,\n      \"symbolOverrides\": symbolOverrides,\n      \"numOverrides\": symbolOverrides.length,\n      \"libraryName\": libraryName,\n      \"library\": foreignLib,\n      \"isSelected\": false\n    });\n  });\n\n  return symbolObjects.sort(compareByName);\n\n}\n\n\nfunction getReducedSymbolsSession(session) {\n\n  var reducedSession = [];\n  session.forEach(sessionItem => {\n    var symbolObject = {\n      \"name\": \"\" + sessionItem.name,\n      \"duplicates\": []\n    }\n    sessionItem.duplicates.forEach(duplicate => {\n      symbolObject.duplicates.push({\n        \"name\": \"\" + duplicate.name,\n        \"isForeign\": duplicate.isForeign,\n        \"thumbnail\": duplicate.thumbnail,\n        \"numInstances\": duplicate.numInstances,\n        \"numOverrides\": duplicate.numOverrides,\n        \"libraryName\": duplicate.libraryName,\n        \"library\": duplicate.library,\n        \"isSelected\": duplicate.isSelected\n      })\n    });\n    reducedSession.push(symbolObject);\n  });\n\n  return reducedSession;\n\n}\n\nfunction getDuplicateColorVariables(context, includeLibraries) {\n\n  var allColorVariables = getAllColorVariables(includeLibraries);\n  var nameDictionary = {};\n  var duplicateColorVariables = [];\n  var alreadyAddedIDs = [];\n  allColorVariables.forEach(function (colorVariable) {\n\n    var colorVariableObject = {\n      \"colorVariable\": colorVariable.colorVariable,\n      \"name\": \"\" + colorVariable.name,\n      \"color\": \"\" + colorVariable.color,\n      \"isForeign\": colorVariable.isForeign,\n      \"thumbnail\": colorVariable.thumbnail,\n      \"libraryName\": colorVariable.libraryName,\n      \"library\": colorVariable.library,\n      \"isSelected\": false,\n      \"isChosen\": false,\n      \"description\": \"\" + colorVariable.color,\n      \"thumbnail\": getColorVariableThumbnail(colorVariable.colorVariable),\n      \"contrastMode\": shouldEnableContrastMode(colorVariable.colorVariable.color.substring(1, 7)),\n      \"duplicates\": [],\n      \"isSelected\": false\n    }\n\n    alreadyAddedIDs.push(\"\" + colorVariable.colorVariable.id);\n\n    if (nameDictionary[colorVariable.name] == null) {\n      duplicateColorVariables.push(colorVariableObject);\n      colorVariableObject.duplicates.push({\n        \"colorVariable\": colorVariable.colorVariable,\n        \"name\": \"\" + colorVariable.name,\n        \"color\": \"\" + colorVariable.color,\n        \"isForeign\": colorVariable.isForeign,\n        \"thumbnail\": colorVariable.thumbnail,\n        \"libraryName\": colorVariable.libraryName,\n        \"library\": colorVariable.library,\n        \"isSelected\": false,\n        \"isChosen\": false,\n        \"description\": \"\" + colorVariable.color,\n        \"thumbnail\": getColorVariableThumbnail(colorVariable.colorVariable),\n        \"contrastMode\": shouldEnableContrastMode(colorVariable.colorVariable.color.substring(1, 7)),\n        \"duplicates\": null,\n        \"isSelected\": false\n      });\n      nameDictionary[colorVariable.name] = colorVariableObject;\n    }\n    else {\n      nameDictionary[colorVariable.name].duplicates.push(colorVariableObject);\n    }\n  });\n\n  Object.keys(nameDictionary).forEach(function (key) {\n\n    var removeElement = false;\n    if (nameDictionary[key].duplicates.length <= 1) removeElement = true;\n\n    if (!removeElement) {\n      var allForeign = true;\n      nameDictionary[key].duplicates.forEach(function (duplicate) {\n        if (!duplicate.isForeign) allForeign = false;\n      });\n      if (allForeign) {\n        removeElement = true;\n      }\n    }\n\n    if (removeElement) {\n      var index = duplicateColorVariables.indexOf(nameDictionary[key]);\n      if (index > -1) duplicateColorVariables.splice(index, 1);\n      nameDictionary[key] = null;\n    }\n\n  });\n\n  return duplicateColorVariables;\n}\n\nfunction GetSpecificLayerStyleData(layerStyle, layerStylesMap) {\n  ctime(\"GetSpecificLayerStyleData\");\n  var totalInstances = 0;\n  var totalOverrides = 0;\n  layerStyle.duplicates.forEach(duplicate => {\n    var layerStyleMapItem = layerStylesMap.get(duplicate.layerStyle);\n    duplicate.thumbnail = getOvalThumbnail(duplicate.layerStyle);\n    duplicate.styleInstances = layerStyleMapItem.directInstances;\n    duplicate.numInstances = layerStyleMapItem.directInstances.length;\n    duplicate.styleOverrides = layerStyleMapItem.instancesWithOverrides;\n    duplicate.numOverrides = layerStyleMapItem.instancesWithOverrides.length;\n\n\n    totalInstances += duplicate.numInstances;\n    totalOverrides += duplicate.numOverrides;\n  });\n\n  clog(\"-- Found \" + totalInstances + \" instances, \" + totalOverrides + \" overrides, and created \" + layerStyle.duplicates.length + \" thumbnails\");\n  ctimeEnd(\"GetSpecificLayerStyleData\");\n}\n\nfunction GetSpecificTextStyleData(textStyle, textStylesMap) {\n  ctime(\"GetSpecificTextStyleData\");\n  var totalInstances = 0;\n  var totalOverrides = 0;\n  textStyle.duplicates.forEach(duplicate => {\n    var textStyleMapItem = textStylesMap.get(duplicate.textStyle);\n    duplicate.thumbnail = getTextThumbnail(duplicate.textStyle);\n    duplicate.styleInstances = textStyleMapItem.directInstances;\n    duplicate.numInstances = textStyleMapItem.directInstances.length;\n    duplicate.styleOverrides = textStyleMapItem.instancesWithOverrides;\n    duplicate.numOverrides = textStyleMapItem.instancesWithOverrides.length;\n\n\n    totalInstances += duplicate.numInstances;\n    totalOverrides += duplicate.numOverrides;\n  });\n\n  clog(\"-- Found \" + totalInstances + \" instances, \" + totalOverrides + \" overrides, and created \" + textStyle.duplicates.length + \" thumbnails\");\n  ctimeEnd(\"GetSpecificTextStyleData\");\n}\n\nfunction GetSpecificSymbolData(symbol, symbolsMap) {\n  ctime(\"GetSpecificSymbolData\");\n  var totalInstances = 0;\n  var totalOverrides = 0;\n  symbol.duplicates.forEach(duplicate => {\n    var symbolMapItem = symbolsMap.get(duplicate.symbol);\n    duplicate.thumbnail = getThumbnail(duplicate);\n    duplicate.symbolInstances = symbolMapItem.directInstances;\n    duplicate.numInstances = symbolMapItem.directInstances.length;\n    duplicate.symbolOverrides = symbolMapItem.instancesWithOverrides;\n    duplicate.numOverrides = symbolMapItem.instancesWithOverrides.length;\n\n    totalInstances += duplicate.numInstances;\n    totalOverrides += duplicate.numOverrides;\n  });\n  clog(\"-- Found \" + totalInstances + \" instances, \" + totalOverrides + \" overrides, and created \" + symbol.duplicates.length + \" thumbnails\");\n  ctimeEnd(\"GetSpecificSymbolData\");\n}\n\nfunction getTextStyleDescription(sharedTextStyle) {\n  return sharedTextStyle.style.fontFamily + \" \" + sharedTextStyle.style.fontSize + \"pt\" + \" - \" + sharedTextStyle.style.alignment;\n}\n\nfunction getLayerStyleDescription(sharedStyle) {\n  var textInfo = \"\";\n\n  if (sharedStyle.style.fills.length > 0) {\n    textInfo += \"Fill\" + ((!sharedStyle.style.fills[0].enabled) ? \" (disabled)\" : \"\") + \": \" + sharedStyle.style.fills[0].color.substring(0, 7).toUpperCase();\n  }\n  else\n    textInfo += \"No fill\";\n\n  textInfo += \" - \";\n\n  if (sharedStyle.style.borders.length > 0) {\n    textInfo += \"Border\" + ((!sharedStyle.style.borders[0].enabled) ? \" (disabled)\" : \"\") + \": \" + sharedStyle.style.borders[0].color.substring(0, 7).toUpperCase();\n  }\n  else\n    textInfo += \"No border\";\n\n  return textInfo;\n}\n\nfunction getTextStyleColor(style) {\n  if (style.style().textStyle().attributes().MSAttributedStringColorAttribute) {\n    return style.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue().toString();\n  }\n  else\n    return \"000000\";\n}\n\nfunction getOvalThumbnail(sharedStyle) {\n  const oval = new ShapePath({\n    shapeType: ShapePath.ShapeType.Oval,\n    frame: new sketch.Rectangle(0, 0, 300, 300),\n    style: sharedStyle.style,\n    parent: document.selectedPage\n  });\n  try {\n    const options = { scales: '1', formats: 'png', output: false };\n    var buffer = sketch.export(oval, options);\n    var image64 = buffer.toString('base64');\n    oval.remove();\n    return image64;\n  } catch (e) {\n    oval.remove();\n    return \"\";\n  }\n}\n\n\n\nfunction getTextThumbnail(sharedStyle) {\n  var text = new Text({\n    text: 'The quick brown fox',\n    frame: new sketch.Rectangle(0, 0, 600, 100),\n    style: sharedStyle.style,\n    parent: document.selectedPage\n  })\n  try {\n    const options = { scales: '5', formats: 'png', output: false };\n    var buffer = sketch.export(text, options);\n    var image64 = buffer.toString('base64');\n    text.remove();\n    return image64;\n  } catch (e) {\n    text.remove();\n    return \"\";\n  }\n}\n\nfunction getColorVariableThumbnail(colorVariable) {\n  const oval = new ShapePath({\n    shapeType: ShapePath.ShapeType.Oval,\n    frame: new sketch.Rectangle(0, 0, 300, 300),\n    style: {\n      fills: [{ color: colorVariable.color }],\n    },\n    parent: document.selectedPage\n  });\n  try {\n    const options = { scales: '1', formats: 'png', output: false };\n    var buffer = sketch.export(oval, options);\n    var image64 = buffer.toString('base64');\n    oval.remove();\n    return image64;\n  } catch (e) {\n    oval.remove();\n    return \"\";\n  }\n}\n\nfunction getAllLayerStyles(includeAllStylesFromExternalLibraries) {\n  var allStyles = [];\n  const idsMap = new Map();\n  const idsPlusLibraryMap = new Map();\n\n  if (includeAllStylesFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().sharedLayerStyles.forEach(function (sharedLayerStyle) {\n          if (sharedLayerStyle.getLibrary() == null) {\n            var id1 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(0, sharedLayerStyle.id.indexOf(\"[\")) : sharedLayerStyle.id;\n            var id2 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(sharedLayerStyle.id.indexOf(\"[\") + 1, sharedLayerStyle.id.length - 1) : null;\n\n            var layerStyleObject = {\n              \"layerStyle\": sharedLayerStyle,\n              \"name\": \"\" + sharedLayerStyle.name,\n              \"libraryName\": libraryPrefix + lib.name,\n              \"library\": lib,\n              \"isForeign\": true,\n              \"isSelected\": false,\n              \"isChosen\": false,\n              \"description\": getLayerStyleDescription(sharedLayerStyle),\n              \"thumbnail\": getOvalThumbnail(sharedLayerStyle),\n              \"numInstances\": 0,\n              \"numOverrides\": 0,\n              \"isSelected\": false,\n              \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n              \"isHidden\": false,\n              \"addedBy\": \"🟠\" + ((sharedLayerStyle.getLibrary() != null) ? \" 🪐\" : \"L\"),\n              \"styleId\": id1 + \" - \" + id2,\n              \"localStyle\": null\n            }\n\n            if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"🟠 Tints/Active ids are:\" + id1 + \" - \" + id2)\n\n            if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"--> Added it to layerStyles\");\n            allStyles.push(layerStyleObject);\n            idsMap.set(id1 + \"---\" + lib.id, layerStyleObject);\n            if (id2) idsMap.set(id2 + \"---\" + lib.id, layerStyleObject);\n          }\n        });\n      }\n    });\n  }\n\n  document.sharedLayerStyles.forEach(function (sharedLayerStyle) {\n    var id1 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(0, sharedLayerStyle.id.indexOf(\"[\")) : sharedLayerStyle.id;\n    var id2 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(sharedLayerStyle.id.indexOf(\"[\") + 1, sharedLayerStyle.id.length - 1) : null;\n\n\n    var id1Comparison = id1 + ((sharedLayerStyle.getLibrary() != null) ? \"---\" + sharedLayerStyle.getLibrary().id : \"\");\n    var id2Comparison = id2 + ((sharedLayerStyle.getLibrary() != null) ? \"---\" + sharedLayerStyle.getLibrary().id : \"\");\n\n    // if (sharedLayerStyle.name.includes(\"Ultraviolet/500\")) {\n    //   console.log(sharedLayerStyle.name + \": \" + sharedLayerStyle.id);\n    //   console.log(sharedLayerStyle.sketchObject.isForeign());\n\n    //   if (!idsMap.has(id1Comparison) && !idsMap.has(id2Comparison)) {\n    //     console.log(\"-- Adding it to list\");\n    //   }\n    //   else {\n    //     if (idsMap.get(id2Comparison)) {\n    //       console.log(\"-- Hit id2Comparison\");\n    //     }\n    //     if (idsMap.get(id1Comparison)) {\n    //       console.log(\"-- Hit id1Comparison\");\n    //     }\n    //   }\n    // }\n\n    var layerStyleObject = {\n      \"layerStyle\": sharedLayerStyle,\n      \"name\": \"\" + sharedLayerStyle.name,\n      \"libraryName\": (sharedLayerStyle.getLibrary() != null) ? libraryPrefix + sharedLayerStyle.getLibrary().name : sketchlocalfile,\n      \"library\": sharedLayerStyle.getLibrary(),\n      \"isForeign\": (sharedLayerStyle.getLibrary() != null),\n      \"isSelected\": false,\n      \"isChosen\": false,\n      \"description\": getLayerStyleDescription(sharedLayerStyle),\n      \"thumbnail\": getOvalThumbnail(sharedLayerStyle),\n      \"numInstances\": 0,\n      \"numOverrides\": 0,\n      \"isSelected\": false,\n      \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n      \"isHidden\": (sharedLayerStyle.getLibrary() != null),\n      \"addedBy\": \"🔵\" + ((sharedLayerStyle.getLibrary() != null) ? \" 🪐\" : \"L\"),\n      \"styleId\": id1 + \" - \" + id2,\n      \"localStyle\": null\n    }\n\n    if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"🔵 Tints/Active ids are:\" + id1 + \" - \" + id2)\n\n    if (!idsMap.has(id1Comparison) && !idsMap.has(id2Comparison)) {\n      allStyles.push(layerStyleObject);\n      idsMap.set(id1Comparison, layerStyleObject);\n      if (id2) idsMap.set(id2Comparison, layerStyleObject);\n      if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"--> Added it to layerStyles\");\n    }\n    else {\n      if (idsMap.get(id2Comparison)) {\n        if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"--> Didn't add it. Matches id2comparison\");\n        idsMap.get(id2Comparison).localStyle = layerStyleObject;\n        idsMap.get(id2Comparison).addedBy += \"👻\";\n      }\n      if (idsMap.get(id1Comparison)) {\n        if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"--> Didn't add it. Matches id1comparison\");\n        idsMap.get(id1Comparison).localStyle = layerStyleObject;\n        idsMap.get(id1Comparison).addedBy += \"👻\";\n      }\n\n      if (sharedLayerStyle.name == \"Tints/Active\") console.log(\"--> End comparisons if\");\n    }\n  });\n\n  //console.log(allStyles.sort(compareStyleArrays))\n  return allStyles.sort(compareStyleArrays);\n\n}\n\n\nfunction getAllTextStyles(includeAllStylesFromExternalLibraries) {\n  var allStyles = [];\n  const idsMap = new Map();\n  const redundantIdsMap = new Map();\n\n  document.sharedTextStyles.forEach(function (sharedTextStyle) {\n    var library = sharedTextStyle.getLibrary();\n    if (!idsMap.has(sharedTextStyle.id)) {\n      var redId1 = sharedTextStyle.style.id;\n      var redId2 = (sharedTextStyle.id.indexOf(\"[\") >= 0) ? sharedTextStyle.id.substring(sharedTextStyle.id.indexOf(\"[\") + 1, sharedTextStyle.id.length - 1) : null;\n      var redundantIn = false;\n      if (redId2 != null)\n        redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n      else\n        redundantIn = redundantIdsMap.has(redId1);\n\n      var textStyleObject = {\n        \"textStyle\": sharedTextStyle,\n        \"name\": \"\" + sharedTextStyle.name,\n        \"libraryName\": (library != null) ? libraryPrefix + library.name : sketchlocalfile,\n        \"library\": library,\n        \"isForeign\": (library != null),\n        \"isSelected\": false,\n        \"isChosen\": false,\n        \"description\": getTextStyleDescription(sharedTextStyle),\n        \"thumbnail\": getTextThumbnail(sharedTextStyle),\n        \"numInstances\": 0,\n        \"numOverrides\": 0,\n        \"isSelected\": false,\n        \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n        \"isHidden\": redundantIn\n      }\n\n      allStyles.push(textStyleObject);\n      idsMap.set(sharedTextStyle.style.id, true);\n      redundantIdsMap.set(redId1, textStyleObject);\n      if (redId2 != null) redundantIdsMap.set(redId2, textStyleObject);\n    }\n  });\n\n  if (includeAllStylesFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().sharedTextStyles.forEach(function (sharedTextStyle) {\n          if (!idsMap.has(sharedTextStyle.style.id)) {\n            var redId1 = sharedTextStyle.style.id;\n            var redId2 = (sharedTextStyle.id.indexOf(\"[\") >= 0) ? sharedTextStyle.id.substring(sharedTextStyle.id.indexOf(\"[\") + 1, sharedTextStyle.id.length - 1) : null;\n            var redundantIn = false;\n            if (redId2 != null)\n              redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n            else\n              redundantIn = redundantIdsMap.has(redId1)\n\n            var textStyleObject = {\n              \"textStyle\": sharedTextStyle,\n              \"name\": \"\" + sharedTextStyle.name,\n              \"libraryName\": libraryPrefix + lib.name,\n              \"library\": lib,\n              \"isForeign\": true,\n              \"isSelected\": false,\n              \"isChosen\": false,\n              \"description\": getTextStyleDescription(sharedTextStyle),\n              \"thumbnail\": getTextThumbnail(sharedTextStyle),\n              \"numInstances\": 0,\n              \"numOverrides\": 0,\n              \"isSelected\": false,\n              \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n              \"isHidden\": redundantIn\n            }\n            allStyles.push(textStyleObject);\n            idsMap.set(sharedTextStyle.style.id, true);\n            redundantIdsMap.set(redId1, textStyleObject);\n            if (redId2 != null) redundantIdsMap.set(redId2, textStyleObject);\n          }\n        });\n      }\n    });\n  }\n\n  return allStyles.sort(compareStyleArrays);;\n\n}\n\n\nfunction getAllColorVariables(includeAllStylesFromExternalLibraries) {\n  var allColorVariables = [];\n  const map = new Map();\n\n  document.swatches.forEach(function (swatch) {\n\n    var colorVariableObject = {\n      \"colorVariable\": swatch,\n      \"name\": \"\" + swatch.name,\n      \"color\": \"\" + swatch.color.substring(0, 7),\n      \"libraryName\": sketchlocalfile,\n      \"library\": null,\n      \"isForeign\": false,\n      \"isSelected\": false,\n      \"isChosen\": false,\n      \"description\": \"\" + swatch.color.substring(0, 7),\n      \"thumbnail\": getColorVariableThumbnail(swatch),\n      \"contrastMode\": shouldEnableContrastMode(swatch.color.substring(1, 7)),\n      \"duplicates\": [],\n      \"isSelected\": false\n    }\n\n    allColorVariables.push(colorVariableObject);\n    map.set(swatch.id, true);\n  });\n\n  if (includeAllStylesFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().swatches.forEach(function (swatch) {\n          if (!map.has(swatch.id)) {\n            var colorVariableObject = {\n              \"colorVariable\": swatch,\n              \"name\": \"\" + swatch.name,\n              \"color\": \"\" + swatch.color.substring(0, 7),\n              \"libraryName\": libraryPrefix + lib.name,\n              \"library\": lib,\n              \"isForeign\": true,\n              \"isSelected\": false,\n              \"isChosen\": false,\n              \"description\": \"\" + swatch.color.substring(0, 7),\n              \"thumbnail\": getColorVariableThumbnail(swatch),\n              \"contrastMode\": shouldEnableContrastMode(swatch.color.substring(1, 7)),\n              \"duplicates\": [],\n              \"isSelected\": false\n            }\n            allColorVariables.push(colorVariableObject);\n          }\n        });\n      }\n    });\n  }\n\n  return allColorVariables;\n\n}\n\n\nfunction getAllDuplicateLayerStylesByName(context, includeAllLayerStylesFromExternalLibraries) {\n  var duplicatedLayerStyles = [];\n  const namesMap = new Map();\n  const idsMap = new Map();\n  const redundantIdsMap = new Map();\n  document.sharedLayerStyles.forEach(function (sharedLayerStyle) {\n\n    if (!idsMap.has(sharedLayerStyle.id)) {\n      var redId1 = sharedLayerStyle.style.id;\n      var redId2 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(sharedLayerStyle.id.indexOf(\"[\") + 1, sharedLayerStyle.id.length - 1) : null;\n      var redundantIn = false;\n      if (redId2 != null)\n        redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n      else\n        redundantIn = redundantIdsMap.has(redId1)\n\n      if (!namesMap.has(sharedLayerStyle.name)) {\n\n        var styleObject = {\n          \"name\": \"\" + sharedLayerStyle.name,\n          \"duplicates\": [],\n        }\n        styleObject.duplicates.push({\n          \"name\": \"\" + sharedLayerStyle.name,\n          \"layerStyle\": sharedLayerStyle,\n          \"libraryName\": (sharedLayerStyle.getLibrary() != null) ? libraryPrefix + sharedLayerStyle.getLibrary().name : sketchlocalfile,\n          \"library\": (sharedLayerStyle.getLibrary() != null) ? sharedLayerStyle.getLibrary() : null,\n          \"isForeign\": (sharedLayerStyle.getLibrary() != null),\n          \"isSelected\": false,\n          \"isChosen\": false,\n          \"description\": getLayerStyleDescription(sharedLayerStyle),\n          \"thumbnail\": \"\",\n          \"isSelected\": false,\n          \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n          \"styleInstances\": null,\n          \"numInstances\": 0,\n          \"styleOverrides\": null,\n          \"numOverrides\": 0,\n          \"isHidden\": redundantIn\n        });\n\n        duplicatedLayerStyles.push(styleObject);\n        idsMap.set(sharedLayerStyle.id, styleObject);\n        namesMap.set(sharedLayerStyle.name, styleObject);\n      }\n      else {\n        var styleObject = namesMap.get(sharedLayerStyle.name);\n        styleObject.duplicates.push({\n          \"name\": \"\" + sharedLayerStyle.name,\n          \"layerStyle\": sharedLayerStyle,\n          \"libraryName\": (sharedLayerStyle.getLibrary() != null) ? libraryPrefix + sharedLayerStyle.getLibrary().name : sketchlocalfile,\n          \"library\": (sharedLayerStyle.getLibrary() != null) ? sharedLayerStyle.getLibrary() : null,\n          \"isForeign\": (sharedLayerStyle.getLibrary() != null),\n          \"isSelected\": false,\n          \"isChosen\": false,\n          \"description\": getLayerStyleDescription(sharedLayerStyle),\n          \"thumbnail\": \"\",\n          \"isSelected\": false,\n          \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n          \"styleInstances\": null,\n          \"numInstances\": 0,\n          \"styleOverrides\": null,\n          \"numOverrides\": 0,\n          \"isHidden\": redundantIn\n        });\n      }\n\n      redundantIdsMap.set(redId1, styleObject);\n      if (redId2 != null) redundantIdsMap.set(redId2, styleObject);\n    }\n  });\n\n  if (includeAllLayerStylesFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().sharedLayerStyles.forEach(function (sharedLayerStyle) {\n          if (!idsMap.has(sharedLayerStyle.id)) {\n            var redId1 = sharedLayerStyle.style.id;\n            var redId2 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(sharedLayerStyle.id.indexOf(\"[\") + 1, sharedLayerStyle.id.length - 1) : null;\n            var redundantIn = false;\n            if (redId2 != null)\n              redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n            else\n              redundantIn = redundantIdsMap.has(redId1)\n\n            if (!namesMap.has(sharedLayerStyle.name)) {\n\n              var styleObject = {\n                \"name\": \"\" + sharedLayerStyle.name,\n                \"duplicates\": [],\n              }\n              styleObject.duplicates.push({\n                \"name\": \"\" + sharedLayerStyle.name,\n                \"layerStyle\": sharedLayerStyle,\n                \"libraryName\": libraryPrefix + lib.name,\n                \"library\": lib,\n                \"isForeign\": true,\n                \"isSelected\": false,\n                \"isChosen\": false,\n                \"description\": getLayerStyleDescription(sharedLayerStyle),\n                \"thumbnail\": \"\",\n                \"isSelected\": false,\n                \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n                \"styleInstances\": null,\n                \"numInstances\": 0,\n                \"styleOverrides\": null,\n                \"numOverrides\": 0,\n                \"isHidden\": redundantIn\n              });\n\n              duplicatedLayerStyles.push(styleObject);\n              idsMap.set(sharedLayerStyle.id, styleObject);\n              namesMap.set(sharedLayerStyle.name, styleObject);\n            }\n            else {\n              var styleObject = namesMap.get(sharedLayerStyle.name);\n              styleObject.duplicates.push({\n                \"name\": \"\" + sharedLayerStyle.name,\n                \"layerStyle\": sharedLayerStyle,\n                \"libraryName\": libraryPrefix + lib.name,\n                \"library\": lib,\n                \"isForeign\": true,\n                \"isSelected\": false,\n                \"isChosen\": false,\n                \"description\": getLayerStyleDescription(sharedLayerStyle),\n                \"thumbnail\": \"\",\n                \"isSelected\": false,\n                \"contrastMode\": (sharedLayerStyle.style.fills.length > 0) ? shouldEnableContrastMode(sharedLayerStyle.style.fills[0].color.substring(1, 7)) : false,\n                \"styleInstances\": null,\n                \"numInstances\": 0,\n                \"styleOverrides\": null,\n                \"numOverrides\": 0,\n                \"isHidden\": redundantIn\n              });\n            }\n\n            redundantIdsMap.set(redId1, styleObject);\n            if (redId2 != null) redundantIdsMap.set(redId2, styleObject);\n          }\n        });\n      }\n    });\n  }\n\n\n  namesMap.forEach(function (styleObject, name) {\n\n    var removeElement = false;\n    if (styleObject.duplicates.length <= 1) removeElement = true;\n    if (!removeElement && (styleObject.duplicates.filter(dup => !dup.isHidden).length <= 1)) {\n      removeElement = true;\n    }\n\n    if (!removeElement) {\n      var allForeign = true;\n      styleObject.duplicates.forEach(function (duplicate) {\n        if (!duplicate.isForeign) allForeign = false;\n      });\n      removeElement = allForeign;\n    }\n\n    if (removeElement) {\n      var index = duplicatedLayerStyles.indexOf(styleObject);\n      if (index > -1) duplicatedLayerStyles.splice(index, 1);\n    }\n\n  });\n\n  return duplicatedLayerStyles.sort(compareByName);\n\n}\n\n\nfunction getAllDuplicateTextStylesByName(context, includeAllStylesFromExternalLibraries) {\n  var duplicatedTextStyles = [];\n  const namesMap = new Map();\n  const idsMap = new Map();\n  const redundantIdsMap = new Map();\n  document.sharedTextStyles.forEach(function (sharedTextStyle) {\n\n    if (!idsMap.has(sharedTextStyle.id)) {\n      var redId1 = sharedTextStyle.style.id;\n      var redId2 = (sharedTextStyle.id.indexOf(\"[\") >= 0) ? sharedTextStyle.id.substring(sharedTextStyle.id.indexOf(\"[\") + 1, sharedTextStyle.id.length - 1) : null;\n      var redundantIn = false;\n      if (redId2 != null)\n        redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n      else\n        redundantIn = redundantIdsMap.has(redId1)\n\n      if (!namesMap.has(sharedTextStyle.name)) {\n\n        var styleObject = {\n          \"name\": \"\" + sharedTextStyle.name,\n          \"duplicates\": [],\n        }\n        styleObject.duplicates.push({\n          \"name\": \"\" + sharedTextStyle.name,\n          \"textStyle\": sharedTextStyle,\n          \"libraryName\": (sharedTextStyle.getLibrary() != null) ? libraryPrefix + sharedTextStyle.getLibrary().name : sketchlocalfile,\n          \"library\": (sharedTextStyle.getLibrary() != null) ? sharedTextStyle.getLibrary() : null,\n          \"isForeign\": (sharedTextStyle.getLibrary() != null),\n          \"isSelected\": false,\n          \"isChosen\": false,\n          \"description\": getTextStyleDescription(sharedTextStyle),\n          \"thumbnail\": \"\",\n          \"isSelected\": false,\n          \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n          \"styleInstances\": null,\n          \"numInstances\": 0,\n          \"styleOverrides\": null,\n          \"numOverrides\": 0,\n          \"isHidden\": redundantIn\n        });\n\n        duplicatedTextStyles.push(styleObject);\n        idsMap.set(sharedTextStyle.id, styleObject);\n        namesMap.set(sharedTextStyle.name, styleObject);\n      }\n      else {\n        var styleObject = namesMap.get(sharedTextStyle.name);\n        styleObject.duplicates.push({\n          \"name\": \"\" + sharedTextStyle.name,\n          \"textStyle\": sharedTextStyle,\n          \"libraryName\": (sharedTextStyle.getLibrary() != null) ? libraryPrefix + sharedTextStyle.getLibrary().name : sketchlocalfile,\n          \"library\": (sharedTextStyle.getLibrary() != null) ? sharedTextStyle.getLibrary() : null,\n          \"isForeign\": (sharedTextStyle.getLibrary() != null),\n          \"isSelected\": false,\n          \"isChosen\": false,\n          \"description\": getTextStyleDescription(sharedTextStyle),\n          \"thumbnail\": \"\",\n          \"isSelected\": false,\n          \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n          \"styleInstances\": null,\n          \"numInstances\": 0,\n          \"styleOverrides\": null,\n          \"numOverrides\": 0,\n          \"isHidden\": redundantIn\n        });\n      }\n\n      redundantIdsMap.set(redId1, styleObject);\n      if (redId2 != null) redundantIdsMap.set(redId2, styleObject);\n    }\n  });\n\n  if (includeAllStylesFromExternalLibraries) {\n    libraries.forEach(function (lib) {\n      if (lib && lib.id && lib.enabled && context.document.documentData() && context.document.documentData().objectID().toString().localeCompare(lib.id) != 0) {\n        lib.getDocument().sharedTextStyles.forEach(function (sharedTextStyle) {\n          if (!idsMap.has(sharedTextStyle.id)) {\n            var redId1 = sharedTextStyle.style.id;\n            var redId2 = (sharedTextStyle.id.indexOf(\"[\") >= 0) ? sharedTextStyle.id.substring(sharedTextStyle.id.indexOf(\"[\") + 1, sharedTextStyle.id.length - 1) : null;\n            var redundantIn = false;\n            if (redId2 != null)\n              redundantIn = redundantIdsMap.has(redId1) || redundantIdsMap.has(redId2);\n            else\n              redundantIn = redundantIdsMap.has(redId1)\n\n            if (!namesMap.has(sharedTextStyle.name)) {\n\n              var styleObject = {\n                \"name\": \"\" + sharedTextStyle.name,\n                \"duplicates\": [],\n              }\n              styleObject.duplicates.push({\n                \"name\": \"\" + sharedTextStyle.name,\n                \"textStyle\": sharedTextStyle,\n                \"libraryName\": libraryPrefix + lib.name,\n                \"library\": lib,\n                \"isForeign\": true,\n                \"isSelected\": false,\n                \"isChosen\": false,\n                \"description\": getTextStyleDescription(sharedTextStyle),\n                \"thumbnail\": \"\",\n                \"isSelected\": false,\n                \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n                \"styleInstances\": null,\n                \"numInstances\": 0,\n                \"styleOverrides\": null,\n                \"numOverrides\": 0,\n                \"isHidden\": redundantIn\n              });\n\n              duplicatedTextStyles.push(styleObject);\n              idsMap.set(sharedTextStyle.id, styleObject);\n              namesMap.set(sharedTextStyle.name, styleObject);\n            }\n            else {\n              var styleObject = namesMap.get(sharedTextStyle.name);\n              styleObject.duplicates.push({\n                \"name\": \"\" + sharedTextStyle.name,\n                \"textStyle\": sharedTextStyle,\n                \"libraryName\": libraryPrefix + lib.name,\n                \"library\": lib,\n                \"isForeign\": true,\n                \"isSelected\": false,\n                \"isChosen\": false,\n                \"description\": getTextStyleDescription(sharedTextStyle),\n                \"thumbnail\": \"\",\n                \"isSelected\": false,\n                \"contrastMode\": shouldEnableContrastMode(sharedTextStyle.style.textColor.substring(1, 7)),\n                \"styleInstances\": null,\n                \"numInstances\": 0,\n                \"styleOverrides\": null,\n                \"numOverrides\": 0,\n                \"isHidden\": redundantIn\n              });\n            }\n\n            redundantIdsMap.set(redId1, styleObject);\n            if (redId2 != null) redundantIdsMap.set(redId2, styleObject);\n          }\n        });\n      }\n    });\n  }\n\n\n  namesMap.forEach(function (styleObject, name) {\n\n    var removeElement = false;\n    if (styleObject.duplicates.length <= 1) removeElement = true;\n\n    if (!removeElement) {\n      var allForeign = true;\n      styleObject.duplicates.forEach(function (duplicate) {\n        if (!duplicate.isForeign) allForeign = false;\n      });\n      removeElement = allForeign;\n    }\n\n    if (removeElement) {\n      var index = duplicatedTextStyles.indexOf(styleObject);\n      if (index > -1) duplicatedTextStyles.splice(index, 1);\n    }\n\n  });\n\n  return duplicatedTextStyles.sort(compareByName);\n\n}\n\nfunction getDefinedLayerStyles(context, includeAllStylesFromExternalLibraries) {\n  var layerStyles = getAllLayerStyles(includeAllStylesFromExternalLibraries);\n  return layerStyles.sort(compareStyleArrays);\n  ;\n}\nfunction getDefinedTextStyles(context, includeAllStylesFromExternalLibraries) {\n  var textStyles = getAllTextStyles(includeAllStylesFromExternalLibraries);\n  return textStyles.sort(compareStyleArrays);\n  ;\n}\nfunction getDefinedColorVariables(context, includeAllStylesFromExternalLibraries) {\n  var colorVariables = getAllColorVariables(includeAllStylesFromExternalLibraries);\n  return colorVariables.sort(compareColorVariableArrays);\n  ;\n}\n\nfunction getImageData64(data) {\n  var imageData = data;\n  var mimeType = \"image/png\";\n  return NSString.stringWithFormat(\n    \"data:%@;base64,%@\",\n    mimeType,\n    imageData.base64EncodedStringWithOptions(0)\n  );\n}\n\nfunction getNSImageData(nsImage) {\n  var data = nsImage\n  var cgRef = nsImage.CGImageForProposedRect_context_hints(null, nil, nil);\n  var newRep = NSBitmapImageRep.alloc().initWithCGImage(cgRef);\n  newRep.setSize(nsImage.size());   // if you want the same resolution\n  var pngData = newRep.representationUsingType_properties(NSPNGFileType, nil);\n  return getImageData64(pngData)\n}\n\nfunction getThumbnail(element) {\n  var component = element.symbol;\n  if (element.isForeign) {\n    try {\n\n      var instances = element.symbol.getAllInstances();\n      if (instances.length > 0) {\n        clog(\"---- Foreign. Getting image using first instance.\");\n        component = instances[0];\n      }\n      else {\n        clog(\"---- Foreign. Getting image using library reference.\");\n        var originLibrary = element.library;\n        var libDocument = originLibrary.getDocument();\n        component = libDocument.getLayerWithID(element.symbol.id);\n      }\n    } catch (e) {\n      clog(\"---- ERROR: Couldn't load (foreign symbol) \" + element.symbol.name + \" library document.\")\n    }\n  }\n  try {\n    const options = { scales: '3', formats: 'png', output: false };\n    var buffer = sketch.export(component, options);\n    var image64 = buffer.toString('base64');\n    return image64;\n  } catch (e) {\n    return \"\";\n  }\n}\n\nfunction clog(message) {\n  if (logsEnabled)\n    console.log(message);\n}\n\nfunction dlog(message) {\n  console.log(message);\n}\n\nfunction ctime(message) {\n  if (timingEnabled)\n    console.time(message);\n}\n\nfunction ctimeEnd(message) {\n  if (timingEnabled)\n    console.timeEnd(message);\n}\n\nfunction getLogsEnabled() {\n  return logsEnabled;\n}\n\nfunction getTimingEnabled() {\n  return timingEnabled;\n}\n\nfunction getLibrariesEnabled() {\n  return librariesEnabledByDefault;\n}\n\n\n\nfunction getSettings() {\n  return settingsFile;\n}\n\n//d9-05\nvar _0x684b = [\"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x6D\\x65\\x72\\x67\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x6C\\x6F\\x67\\x73\", \"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\", \"\\x6C\\x6F\\x67\"]; function LoadSettings() { try { settingsFile = readFromFile(MSPluginManager[_0x684b[1]]()[_0x684b[0]]() + _0x684b[2]); if ((settingsFile != null) && (settingsFile[_0x684b[3]] != null)) { logsEnabled = settingsFile[_0x684b[3]] }; if ((settingsFile != null) && (settingsFile[_0x684b[4]] != null)) { librariesEnabledByDefault = settingsFile[_0x684b[4]] } } catch (e) { console[_0x684b[5]](e); return null } }\n//d9-05\n\nmodule.exports = { getSymbolInstances, compareStyleArrays, FindAllSimilarTextStyles, FindSimilarTextStyles, FindAllSimilarLayerStyles, FindSimilarLayerStyles, getAllLayerStyles, getDefinedTextStyles, IsInTrial, ExiGuthrie, Guthrie, valStatus, writeTextToFile, commands, getSelectedSymbolsSession, GetSpecificSymbolData, GetSpecificLayerStyleData, GetSpecificTextStyleData, shouldEnableContrastMode, countAllSymbols, writeTextToFile, readFromFile, LoadSettings, clog, getLogsEnabled, getSettings, getLibrariesEnabled, getAcquiredLicense, document, importSymbolFromLibrary, importLayerStyleFromLibrary, getSymbolOverrides, getSymbolInstances, importTextStyleFromLibrary, getDefinedColorVariables, importColorVariableFromLibrary, getDuplicateColorVariables, FindAllSimilarColorVariables, analytics, getAllDuplicateSymbolsByName, getSymbolsMap, updateAllDuplicatesWithMap, ctime, ctimeEnd, sketchlocalfile, getTimingEnabled, getReducedDuplicateData, getReducedSymbolsSession, getAllDuplicateLayerStylesByName, getLayerStylesMap, getReducedLayerStyleData, getLayerStyleInstances, getLayerStyleOverrides, getAllTextStyles, getAllDuplicateTextStylesByName, getSimpleLayerStylesMap, dlog, getTextStylesMap, getReducedTextStyleData, getTextStyleInstances, getTextStyleOverrides, sketch };","const MergeSymbols = require(\"./MergeDuplicateSymbols\");\nconst MergeLayerStyles = require(\"./MergeLayerStyles\");\nconst MergeTextStyles = require(\"./MergeTextStyles\");\nconst MergeColorVariables = require(\"./MergeColorVariables\");\nconst Settings = require(\"./EditSettings\");\nconst sketch = require('sketch')\n\nconst Helpers = require(\"./Helpers\");\nimport BrowserWindow from 'sketch-module-web-view';\nimport { getWebview } from 'sketch-module-web-view/remote';\nimport UI from 'sketch/ui'\nconst webviewRegIdentifier = 'merge-duplicates.webviewReg';\n\nvar globalRemainingDays = 0;\nvar globalIsInTrial = false;\nvar globalIsExpired = false;\nvar globalIsOver = false;\n\nvar globalCommand;\n\n\nexport function MergeDuplicateSymbols(context) {\n  Helpers.analytics(\"MergeDuplicateSymbols\");\n  globalCommand = Helpers.commands.mergeduplicatesymbols;\n  onValidate(context);\n};\n\nexport function MergeSelectedSymbols(context) {\n  Helpers.analytics(\"MergeSelectedSymbols\");\n  globalCommand = Helpers.commands.mergeselectedsymbols;\n  onValidate(context);\n};\n\nexport function MergeSelectedTextStyles(context) {\n  Helpers.analytics(\"MergeSelectedTextStyles\");\n  globalCommand = Helpers.commands.mergeselectedtextstyles;\n  onValidate(context);\n};\n\nexport function MergeSimilarTextStyles(context) {\n  Helpers.analytics(\"MergeSimilarTextStyles\");\n  globalCommand = Helpers.commands.mergesimilartextstyles;\n  onValidate(context);\n};\n\nexport function MergeDuplicateTextStyles(context) {\n  Helpers.analytics(\"MergeDuplicateTextStyles\");\n  globalCommand = Helpers.commands.mergeduplicatetextstyles;\n  onValidate(context);\n};\n\nexport function MergeSelectedLayerStyles(context) {\n  Helpers.analytics(\"MergeSelectedLayerStyles\");\n  globalCommand = Helpers.commands.mergeselectedlayerstyles;\n  onValidate(context);\n};\n\nexport function MergeSimilarLayerStyles(context) {\n  Helpers.analytics(\"MergeSimilarLayerStyles\");\n  globalCommand = Helpers.commands.mergesimilarlayerstyles;\n  onValidate(context);\n};\n\nexport function MergeDuplicateLayerStyles(context) {\n  Helpers.analytics(\"MergeDuplicateLayerStyles\");\n  globalCommand = Helpers.commands.mergeduplicatelayerstyles;\n  onValidate(context);\n};\n\nexport function MergeDuplicateColorVariables(context) {\n  Helpers.analytics(\"MergeDuplicateColorVariables\");\n  globalCommand = Helpers.commands.mergeduplicatecolorvariables;\n  onValidate(context);\n};\n\nexport function MergeSelectedColorVariables(context) {\n  Helpers.analytics(\"MergeSelectedColorVariables\");\n  globalCommand = Helpers.commands.mergeselectedcolorvariables;\n  onValidate(context);\n};\n\nexport function MergeSimilarColorVariables(context) {\n  Helpers.analytics(\"MergeSimilarColorVariables\");\n  globalCommand = Helpers.commands.mergesimilarcolorvariables;\n  onValidate(context);\n};\n\nexport function EditSettings(context) {\n  Helpers.analytics(\"EditSettings\");\n  globalCommand = Helpers.commands.editsettings;\n  onValidate(context);\n};\n\n\n\n//d9-01\nvar _0x1647 = [\"\\x61\\x70\\x70\", \"\\x76\\x61\\x6C\\x53\\x74\\x61\\x74\\x75\\x73\", \"\\x6E\\x6F\\x43\\x6F\\x6E\", \"\\x6F\\x76\\x65\\x72\", \"\\x6E\\x6F\\x77\", \"\\x61\\x62\\x73\", \"\\x66\\x6C\\x6F\\x6F\\x72\"]; function onValidate(_0x8a0ax2) { var _0x8a0ax3 = Helpers.ExiGuthrie(); if ((_0x8a0ax3 == Helpers[_0x1647[1]][_0x1647[0]]) || (_0x8a0ax3 == Helpers[_0x1647[1]][_0x1647[2]])) { triggerMethod(_0x8a0ax2) } else { if (_0x8a0ax3 == Helpers[_0x1647[1]][_0x1647[3]]) { globalIsOver = true; showRegistration(_0x8a0ax2) } else { var _0x8a0ax4 = Helpers.IsInTrial(); var _0x8a0ax5 = new Date(parseInt(_0x8a0ax4)); if (_0x8a0ax4 != null) { var _0x8a0ax6 = _0x8a0ax5 - Date[_0x1647[4]](); var _0x8a0ax7 = Math[_0x1647[6]](Math[_0x1647[5]](_0x8a0ax6 / (1000 * 3600 * 24))); globalRemainingDays = 7 - _0x8a0ax7; if (globalRemainingDays > 0) { globalIsInTrial = true } else { globalIsExpired = true }; showRegistration(_0x8a0ax2) } else { showRegistration(_0x8a0ax2) } } } }\n//d9-01\n\nexport function triggerMethod(context) {\n\n  Helpers.LoadSettings();\n\n  Helpers.clog(\"Sketch version:\" + sketch.version.sketch);\n  var version = \"\";\n  try {\n    let pluginManager = NSApp.delegate().pluginManager();\n    let plugin = pluginManager.plugins().objectForKey('com.oodesign.mergeduplicatesymbols');\n    version = plugin.version();\n  }\n  catch (e) {\n    version = \"Unable to identify version. 8+\";\n  }\n  Helpers.clog(\"Merge Duplicates version: \" + version);\n  Helpers.clog(\"License: \" + Helpers.getAcquiredLicense());\n\n  switch (globalCommand) {\n    case Helpers.commands.mergeduplicatesymbols:\n      MergeSymbols.MergeDuplicateSymbols(context);\n      break;\n    case Helpers.commands.mergeselectedsymbols:\n      MergeSymbols.MergeSelectedSymbols(context);\n      break;\n    case Helpers.commands.mergeduplicatetextstyles:\n      MergeTextStyles.MergeDuplicateTextStyles(context);\n      break;\n    case Helpers.commands.mergeselectedtextstyles:\n      MergeTextStyles.MergeSelectedTextStyles(context);\n      break;\n    case Helpers.commands.mergesimilartextstyles:\n      MergeTextStyles.MergeSimilarTextStyles(context);\n      break;\n    case Helpers.commands.mergeduplicatelayerstyles:\n      MergeLayerStyles.MergeDuplicateLayerStyles(context);\n      break;\n    case Helpers.commands.mergeselectedlayerstyles:\n      MergeLayerStyles.MergeSelectedLayerStyles(context);\n      break;\n    case Helpers.commands.mergesimilarlayerstyles:\n      MergeLayerStyles.MergeSimilarLayerStyles(context);\n      break;\n    case Helpers.commands.mergeduplicatecolorvariables:\n      MergeColorVariables.MergeDuplicateColorVariables(context);\n      break;\n    case Helpers.commands.mergeselectedcolorvariables:\n      MergeColorVariables.MergeSelectedColorVariables(context);\n      break;\n    case Helpers.commands.mergesimilarcolorvariables:\n      MergeColorVariables.MergeSimilarColorVariables(context);\n      break;\n    case Helpers.commands.editsettings:\n      Settings.EditSettings(context);\n      break;\n  }\n}\n\n\n\nexport function showRegistration(context) {\n\n  var options = {\n    identifier: webviewRegIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    titleBarStyle: 'hidden'\n  }\n\n  var regWindow = new BrowserWindow(options)\n\n  const webContentsReg = regWindow.webContents;\n\n  //d9-02\n  var _0x4e9d = [\"\\x72\\x65\\x61\\x64\\x79\\x2D\\x74\\x6F\\x2D\\x73\\x68\\x6F\\x77\", \"\\x65\\x72\\x72\\x6F\\x72\", \"\\x63\\x61\\x74\\x63\\x68\", \"\\x53\\x65\\x74\\x54\\x72\\x69\\x61\\x6C\\x4D\\x6F\\x64\\x65\\x28\", \"\\x73\\x74\\x72\\x69\\x6E\\x67\\x69\\x66\\x79\", \"\\x29\", \"\\x65\\x78\\x65\\x63\\x75\\x74\\x65\\x4A\\x61\\x76\\x61\\x53\\x63\\x72\\x69\\x70\\x74\", \"\\x53\\x65\\x74\\x45\\x78\\x70\\x69\\x72\\x65\\x64\\x4D\\x6F\\x64\\x65\\x28\\x29\", \"\\x53\\x65\\x74\\x4F\\x76\\x65\\x72\\x4D\\x6F\\x64\\x65\\x28\\x29\", \"\\x73\\x68\\x6F\\x77\", \"\\x6F\\x6E\\x63\\x65\", \"\\x64\\x69\\x64\\x2D\\x66\\x69\\x6E\\x69\\x73\\x68\\x2D\\x6C\\x6F\\x61\\x64\", \"\\x6F\\x6E\", \"\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x4B\\x65\\x79\", \"\\x61\\x70\\x70\", \"\\x76\\x61\\x6C\\x53\\x74\\x61\\x74\\x75\\x73\", \"\", \"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x6D\\x65\\x72\\x67\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x77\\x72\\x69\\x74\\x65\\x54\\x65\\x78\\x74\\x54\\x6F\\x46\\x69\\x6C\\x65\", \"\\x53\\x68\\x6F\\x77\\x52\\x65\\x67\\x69\\x73\\x74\\x72\\x61\\x74\\x69\\x6F\\x6E\\x43\\x6F\\x6D\\x70\\x6C\\x65\\x74\\x65\\x28\\x29\", \"\\x6F\\x76\\x65\\x72\", \"\\x53\\x65\\x74\\x4F\\x76\\x65\\x72\\x4D\\x6F\\x64\\x65\\x49\\x6E\\x52\\x65\\x67\\x28\\x29\", \"\\x53\\x68\\x6F\\x77\\x52\\x65\\x67\\x69\\x73\\x74\\x72\\x61\\x74\\x69\\x6F\\x6E\\x46\\x61\\x69\\x6C\\x28\\x29\", \"\\x53\\x74\\x61\\x72\\x74\\x54\\x72\\x69\\x61\\x6C\", \"\\x6E\\x6F\\x77\", \"\\x53\\x68\\x6F\\x77\\x54\\x72\\x69\\x61\\x6C\\x53\\x74\\x61\\x72\\x74\\x65\\x64\\x28\\x29\", \"\\x43\\x6F\\x6E\\x74\\x69\\x6E\\x75\\x65\\x54\\x72\\x69\\x61\\x6C\", \"\\x4C\\x65\\x74\\x73\\x53\\x74\\x61\\x72\\x74\\x54\\x72\\x69\\x61\\x6C\", \"\\x4C\\x65\\x74\\x73\\x53\\x74\\x61\\x72\\x74\"]; regWindow[_0x4e9d[10]](_0x4e9d[0], () => { if (globalIsInTrial) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[3]}${JSON[_0x4e9d[4]](globalRemainingDays)}${_0x4e9d[5]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }; if (globalIsExpired) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[7]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }; if (globalIsOver) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[8]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }; regWindow[_0x4e9d[9]]() }); webContentsReg[_0x4e9d[12]](_0x4e9d[11], () => { if (globalIsInTrial) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[3]}${JSON[_0x4e9d[4]](globalRemainingDays)}${_0x4e9d[5]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }; if (globalIsExpired) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[7]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }; if (globalIsOver) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[8]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) } }); webContentsReg[_0x4e9d[12]](_0x4e9d[13], (_0xf514x1) => { var _0xf514x2 = Helpers.Guthrie(_0xf514x1, true); if (_0xf514x2 == Helpers[_0x4e9d[15]][_0x4e9d[14]]) { var _0xf514x3 = { \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\": _0x4e9d[16] + _0xf514x1 }; Helpers[_0x4e9d[20]](_0xf514x3, MSPluginManager[_0x4e9d[18]]()[_0x4e9d[17]]() + _0x4e9d[19]); webContentsReg[_0x4e9d[6]](`${_0x4e9d[21]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) } else { if (_0xf514x2 == Helpers[_0x4e9d[15]][_0x4e9d[22]]) { webContentsReg[_0x4e9d[6]](`${_0x4e9d[8]}`)[_0x4e9d[2]](console[_0x4e9d[1]]); webContentsReg[_0x4e9d[6]](`${_0x4e9d[23]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) } else { webContentsReg[_0x4e9d[6]](`${_0x4e9d[24]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) } } }); webContentsReg[_0x4e9d[12]](_0x4e9d[25], (_0xf514x1) => { var _0xf514x4 = { \"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\": _0x4e9d[16] + Date[_0x4e9d[26]]() }; Helpers[_0x4e9d[20]](_0xf514x4, MSPluginManager[_0x4e9d[18]]()[_0x4e9d[17]]() + _0x4e9d[19]); webContentsReg[_0x4e9d[6]](`${_0x4e9d[27]}`)[_0x4e9d[2]](console[_0x4e9d[1]]) }); webContentsReg[_0x4e9d[12]](_0x4e9d[28], () => { onShutdown(webviewRegIdentifier); triggerMethod(context) }); webContentsReg[_0x4e9d[12]](_0x4e9d[29], () => { globalIsInTrial = true; globalRemainingDays = 7; onShutdown(webviewRegIdentifier); triggerMethod(context) }); webContentsReg[_0x4e9d[12]](_0x4e9d[30], () => { globalIsInTrial = false; onShutdown(webviewRegIdentifier); triggerMethod(context) })\n  //d9-02\n\n  webContentsReg.on('nativeLog', s => {\n    Helpers.clog(s);\n  })\n\n  webContentsReg.on('OpenPluginWeb', s => {\n    NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(\"http://www.mergeduplicates.com\"));\n  })\n\n  webContentsReg.on('Cancel', () => {\n    onShutdown(webviewRegIdentifier);\n  });\n\n  regWindow.loadURL(require('../resources/register.html'));\n}\n\n\nexport function onShutdown(webviewID) {\n  const existingWebview = getWebview(webviewID)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nimport { clog } from './Helpers';\nconst sketch = require('sketch');\nvar UI = require('sketch/ui')\nconst Helpers = require(\"./Helpers\");\n\nconst webviewMDCVIdentifier = 'merge-duplicatecolorvariables.webview'\nconst webviewMCVFLIdentifier = 'merge-colorvariablesfromlist.webview'\nconst webviewMSCVIdentifier = 'merge-similarcolorvariables.webview'\n\nvar checkingAlsoLibraries = false;\nvar currentSelectedColorVariables = [];\n\nfunction MergeColorVariables(context, colorVariableToKeepIndex) {\n  var layersChangedCounter = 0;\n  var stylesChangedCounter = [];\n  var colorVariableToKeep = currentSelectedColorVariables[colorVariableToKeepIndex];\n  var colorVariableToApply = colorVariableToKeep.colorVariable;\n  var colorVariablesToRemove = [];\n  Helpers.clog(\"Merging color variables. Keep '\" + colorVariableToKeep.name + \"'\");\n\n  if (colorVariableToKeep.isForeign) {\n    var existingCV = Helpers.document.swatches.filter(function (sw) {\n      return sw.id == colorVariableToKeep.colorVariable.id;\n    });\n    if (existingCV.length <= 0) {\n      Helpers.clog(\"Importing color variable from library \" + colorVariableToKeep.libraryName);\n      colorVariableToApply = Helpers.importColorVariableFromLibrary(colorVariableToKeep);\n    }\n    else\n      Helpers.clog(\"Color variable not imported (as it's already in document)\");\n  }\n\n  for (var i = 0; i < currentSelectedColorVariables.length; i++) {\n    if (i != colorVariableToKeepIndex) {\n      colorVariablesToRemove.push(currentSelectedColorVariables[i].colorVariable);\n    }\n  }\n\n  //currentSelectedColorVariables.forEach(function (colorVariable) {\n  layersChangedCounter = doUseColorSwatchesInLayers(colorVariableToApply, colorVariablesToRemove);\n  stylesChangedCounter = doUseColorSwatchesInStyles(colorVariableToApply, colorVariablesToRemove);\n  //});\n\n  colorVariablesToRemove.forEach(function (colorVariableToRemove) {\n    var removeAtIndex = -1;\n\n    Helpers.clog(\"Removing color variable \" + colorVariableToRemove.name);\n    for (var i = 0; i < Helpers.document.swatches.length; i++) {\n      if (Helpers.document.swatches[i].id == colorVariableToRemove.id) removeAtIndex = i;\n    }\n    if (removeAtIndex > -1) Helpers.document.swatches.splice(removeAtIndex, 1);\n  });\n\n  return {\n    \"layersUpdated\": layersChangedCounter,\n    \"layerStylesUpdated\": stylesChangedCounter[0],\n    \"textStylesUpdated\": stylesChangedCounter[1],\n  };\n}\n\nfunction doUseColorSwatchesInLayers(colorVariable, colorVariablesToRemove) {\n  // When you open an existing document in Sketch 69, the color assets in the document will be migrated to Color Swatches. However, layers using those colors will not be changed to use the new swatches. This plugin takes care of this\n  const allLayers = sketch.find('*') // TODO: optimise this query: ShapePath, SymbolMaster, Text, SymbolInstance\n  const map = new Map();\n\n  allLayers.forEach(layer => {\n    if (layer.type != \"Slice\") {\n      layer.style.fills\n        .concat(layer.style.borders)\n        .filter(item => item.fillType == 'Color')\n        .forEach(item => {\n          colorVariablesToRemove.forEach(cvToRemove => {\n            if (item.color == cvToRemove.color) {\n              item.color = colorVariable.referencingColor;\n              if (!map.has(layer)) map.set(layer, true);\n            }\n          });\n        })\n      // Previous actions don't work for Text Layer colors that are colored using TextColor, so let's fix that:\n      if (layer.style.textColor) {\n        colorVariablesToRemove.forEach(cvToRemove => {\n          if (layer.style.textColor == cvToRemove.color)\n            layer.style.textColor = colorVariable.referencingColor;\n        });\n      }\n    }\n  });\n\n  Helpers.clog(\"Affected layers \" + map.size)\n\n  return map.size;\n}\n\nfunction doUseColorSwatchesInStyles(colorVariable, colorVariablesToRemove) {\n  // This method traverses all Layer and Text Styles, and makes sure they use Color Swatches that exist in the document.\n  const stylesCanBeUpdated = []\n  const lsMap = new Map();\n  const tsMap = new Map();\n\n  const allLayerStyles = Helpers.document.sharedLayerStyles\n  allLayerStyles.forEach(style => {\n    var styleAffected = false;\n    style.getAllInstances().forEach(styleInstance => {\n      if (!styleInstance.isOutOfSyncWithSharedStyle(style)) {\n        stylesCanBeUpdated.push({ instance: styleInstance, style: style })\n      }\n    })\n    style.style.fills.concat(style.style.borders).forEach(item => {\n      if (item.fillType == 'Color') {\n        colorVariablesToRemove.forEach(cvToRemove => {\n          if (item.color == cvToRemove.color) {\n            item.color = colorVariable.referencingColor;\n            if (!lsMap.has(style)) lsMap.set(style, true);\n          }\n        });\n      }\n    })\n    // TODO: This could also work with gradients...\n  })\n\n  const allTextStyles = Helpers.document.sharedTextStyles\n  allTextStyles.forEach(style => {\n    var styleAffected = false;\n    style.getAllInstances().forEach(styleInstance => {\n      if (!styleInstance.isOutOfSyncWithSharedStyle(style)) {\n        stylesCanBeUpdated.push({ instance: styleInstance, style: style })\n      }\n    })\n    const currentStyle = style.style\n    colorVariablesToRemove.forEach(cvToRemove => {\n      if (currentStyle.textColor == cvToRemove.color) {\n        currentStyle.textColor = colorVariable.referencingColor;\n        if (!tsMap.has(style)) tsMap.set(style, true);\n      }\n    });\n  });\n\n  // Finally, update all layers that use a style we updated...\n  stylesCanBeUpdated.forEach(pair => {\n    pair.instance.syncWithSharedStyle(pair.style)\n  })\n\n\n  Helpers.clog(\"Affected layer styles mapsize:\" + lsMap.size)\n  Helpers.clog(\"Affected text styles mapsize:\" + tsMap.size)\n\n  return [lsMap.size, tsMap.size];\n}\n\nexport function MergeDuplicateColorVariables(context) {\n\n  Helpers.clog(\"----- Merge duplicate color variables -----\");\n\n  const options = {\n    identifier: webviewMDCVIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var onlyDuplicatedColorVariables;\n  var mergeSession = [];\n  CalculateDuplicates(Helpers.getLibrariesEnabled());\n\n  if (onlyDuplicatedColorVariables.length > 0) {\n    browserWindow.loadURL(require('../resources/mergeduplicatecolorvariables.html'));\n  }\n  else {\n    UI.message(\"Looks like there are no color variables with the same name.\");\n    onShutdown(webviewMDCVIdentifier);\n  }\n\n  function CalculateDuplicates(includeLibraries) {\n    Helpers.clog(\"Finding duplicate color variables. Including libraries:\" + includeLibraries);\n    onlyDuplicatedColorVariables = Helpers.getDuplicateColorVariables(context, includeLibraries);\n    if (onlyDuplicatedColorVariables.length > 0) {\n      mergeSession = [];\n      for (var i = 0; i < onlyDuplicatedColorVariables.length; i++) {\n        mergeSession.push({\n          \"colorVariableWithDuplicates\": onlyDuplicatedColorVariables[i],\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n          \"isProcessed\": (i == 0) ? true : false\n        });\n      }\n    }\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`DrawColorVariablesList(${JSON.stringify(mergeSession)}, ${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMDCVIdentifier);\n  });\n\n  webContents.on('RecalculateDuplicates', (includeLibraries) => {\n    Helpers.clog(\"Recalculating duplicates\");\n    CalculateDuplicates(includeLibraries);\n    webContents.executeJavaScript(`DrawColorVariablesList(${JSON.stringify(mergeSession)})`).catch(console.error);\n  });\n\n  webContents.on('GetSelectedStyleData', (index) => {\n    //Helpers.GetSpecificLayerStyleData(context, onlyDuplicatedColorVariables, index);\n    webContents.executeJavaScript(`ReDrawAfterGettingData(${JSON.stringify(mergeSession[index].colorVariableWithDuplicates)},${index})`).catch(console.error);\n  });\n\n  webContents.on('ExecuteMerge', (editedMergeSession) => {\n    Helpers.clog(\"Executing Merge\");\n\n    var variablesSolved = 0;\n    var affected = {\n      \"layersUpdated\": 0,\n      \"layerStylesUpdated\": 0,\n      \"textStylesUpdated\": 0,\n    };\n\n    for (var i = 0; i < editedMergeSession.length; i++) {\n      Helpers.clog(\"-- Merging \" + mergeSession[i].colorVariableWithDuplicates.name);\n      if (!editedMergeSession[i].isUnchecked && editedMergeSession[i].selectedIndex >= 0) {\n        mergeSession[i].selectedIndex = editedMergeSession[i].selectedIndex;\n        currentSelectedColorVariables = [];\n        for (var j = 0; j < mergeSession[i].colorVariableWithDuplicates.duplicates.length; j++) {\n          currentSelectedColorVariables.push(mergeSession[i].colorVariableWithDuplicates.duplicates[j]);\n        }\n\n        var results = MergeColorVariables(context, editedMergeSession[i].selectedIndex);\n        affected.layersUpdated += results.layersUpdated;\n        affected.layerStylesUpdated += results.layerStylesUpdated;\n        affected.textStylesUpdated += results.textStylesUpdated;\n\n        variablesSolved++;\n      }\n    }\n\n    onShutdown(webviewMDCVIdentifier);\n    if (variablesSolved <= 0) {\n      Helpers.clog(\"No color variables were merged\");\n      UI.message(\"No color variables were merged\");\n    }\n    else {\n      var message = GetMergeResultMessage(affected.layersUpdated, affected.layerStylesUpdated, affected.textStylesUpdated);\n      Helpers.clog(message);\n      UI.message(message);\n    }\n\n  });\n};\n\nexport function MergeSelectedColorVariables(context) {\n\n  Helpers.clog(\"----- Merge selected color variables -----\");\n\n  const options = {\n    identifier: webviewMCVFLIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n\n  var definedColorVariables;\n  var definedAllColorVariables;\n  var colorVariableCounter = 0;\n\n  if (!Helpers.getLibrariesEnabled()) {\n    Helpers.clog(\"Get local color variables list\");\n    definedColorVariables = Helpers.getDefinedColorVariables(context, false);\n    colorVariableCounter = definedColorVariables.length;\n    checkingAlsoLibraries = false;\n  }\n\n  if (Helpers.getLibrariesEnabled()) {\n    Helpers.clog(\"Get all (including libraries) color variables list\");\n    definedAllColorVariables = Helpers.getDefinedColorVariables(context, true);\n    colorVariableCounter = definedAllColorVariables.length;\n    checkingAlsoLibraries = true;\n  }\n\n  if (colorVariableCounter > 1) {\n    browserWindow.loadURL(require('../resources/mergecolorvariablesfromlist.html'));\n  }\n  else {\n    if (colorVariableCounter == 1)\n      UI.message(\"There's only 1 color variable. No need to merge.\");\n    else\n      UI.message(\"Looks like there are no color variables.\");\n\n    onShutdown(webviewMCVFLIdentifier);\n  }\n\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    if (!Helpers.getLibrariesEnabled())\n      webContents.executeJavaScript(`DrawColorVariableList(${JSON.stringify(definedColorVariables)},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n    else\n      webContents.executeJavaScript(`DrawColorVariableList(${JSON.stringify(definedAllColorVariables)},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('GetLocalColorVariablesList', () => {\n    Helpers.clog(\"Get local color variables list\");\n    if (definedColorVariables == null)\n      definedColorVariables = Helpers.getDefinedColorVariables(context, false);\n\n    checkingAlsoLibraries = false;\n    webContents.executeJavaScript(`DrawColorVariableList(${JSON.stringify(definedColorVariables)})`).catch(console.error);\n  });\n\n  webContents.on('GetAllColorVariablesList', () => {\n    Helpers.clog(\"Get all (including libraries) color variables list\");\n    if (definedAllColorVariables == null)\n      definedAllColorVariables = Helpers.getDefinedColorVariables(context, true);\n\n    checkingAlsoLibraries = true;\n    webContents.executeJavaScript(`DrawStyleList(${JSON.stringify(definedAllColorVariables)})`).catch(console.error);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMCVFLIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedGlobalColorVariables) => {\n    Helpers.clog(\"Executing Merge\");\n    currentSelectedColorVariables = [];\n    var selectedIndex = -1;\n    var counter = 0;\n\n    if (!checkingAlsoLibraries) {\n      for (var i = 0; i < definedColorVariables.length; i++) {\n        definedColorVariables[i].isSelected = editedGlobalColorVariables[i].isSelected;\n        definedColorVariables[i].isChosen = editedGlobalColorVariables[i].isChosen;\n        if (editedGlobalColorVariables[i].isChosen) selectedIndex = counter;\n        if (editedGlobalColorVariables[i].isSelected) {\n          currentSelectedColorVariables.push(definedColorVariables[i]);\n          counter++;\n        }\n      }\n    }\n    else {\n      for (var i = 0; i < definedAllColorVariables.length; i++) {\n        definedAllColorVariables[i].isSelected = editedGlobalColorVariables[i].isSelected;\n        definedAllColorVariables[i].isChosen = editedGlobalColorVariables[i].isChosen;\n        if (editedGlobalColorVariables[i].isChosen) selectedIndex = counter;\n        if (editedGlobalColorVariables[i].isSelected) {\n          currentSelectedColorVariables.push(definedAllColorVariables[i]);\n          counter++;\n        }\n      }\n    }\n\n    var affected = MergeColorVariables(context, selectedIndex);\n\n    var message = GetMergeResultMessage(affected.layersUpdated, affected.layerStylesUpdated, affected.textStylesUpdated);\n    Helpers.clog(message);\n    UI.message(message);\n\n    onShutdown(webviewMCVFLIdentifier);\n  });\n\n};\n\nexport function MergeSimilarColorVariables(context) {\n\n  Helpers.clog(\"----- Merge similar color variables -----\");\n\n  const options = {\n    identifier: webviewMSCVIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var colorVariablesWithSimilarColorVariables;\n  Helpers.clog(\"Loading webview\");\n  browserWindow.loadURL(require('../resources/mergesimilarcolorvariables.html'));\n\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`UpdateSettings(${Helpers.getLibrariesEnabled()})`).catch(console.error);\n    colorVariablesWithSimilarColorVariables = Helpers.FindAllSimilarColorVariables(context, Helpers.getLibrariesEnabled(), 30);\n    webContents.executeJavaScript(`DrawResultsList(${JSON.stringify(colorVariablesWithSimilarColorVariables)})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMSCVIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedColorVariablesWithSimilarColorVariables) => {\n    Helpers.clog(\"Execute merge\");\n    var variablesSolved = 0;\n    var affected = {\n      \"layersUpdated\": 0,\n      \"layerStylesUpdated\": 0,\n      \"textStylesUpdated\": 0,\n    };\n    for (var i = 0; i < editedColorVariablesWithSimilarColorVariables.length; i++) {\n      if (!editedColorVariablesWithSimilarColorVariables[i].isUnchecked && editedColorVariablesWithSimilarColorVariables[i].selectedIndex >= 0) {\n        currentSelectedColorVariables = [];\n        for (var j = 0; j < editedColorVariablesWithSimilarColorVariables[i].similarStyles.length; j++) {\n          currentSelectedColorVariables.push(colorVariablesWithSimilarColorVariables[i].similarStyles[j]);\n        }\n\n        var results = MergeColorVariables(context, editedColorVariablesWithSimilarColorVariables[i].selectedIndex);\n        affected.layersUpdated += results.layersUpdated;\n        affected.layerStylesUpdated += results.layerStylesUpdated;\n        affected.textStylesUpdated += results.textStylesUpdated;\n\n        variablesSolved++;\n      }\n    }\n\n    onShutdown(webviewMSCVIdentifier);\n\n    if (variablesSolved <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var message = GetMergeResultMessage(affected.layersUpdated, affected.layerStylesUpdated, affected.textStylesUpdated);\n      Helpers.clog(message);\n      UI.message(message);\n    }\n\n  });\n\n  webContents.on('RecalculateVariables', (includeAllLibraries, tolerance) => {\n    Helpers.clog(\"Recalculate similar variables with tolerance: \" + tolerance);\n    colorVariablesWithSimilarColorVariables = Helpers.FindAllSimilarColorVariables(context, includeAllLibraries, tolerance);\n    webContents.executeJavaScript(`DrawResultsList(${JSON.stringify(colorVariablesWithSimilarColorVariables)})`).catch(console.error);\n  });\n\n};\n\nfunction GetMergeResultMessage(layersUpdated, layerStylesUpdated, textStylesUpdated) {\n  var message = \"Wow how! \";\n  if (layersUpdated > 0 && ((layerStylesUpdated + textStylesUpdated) == 0))\n    message += \"We updated \" + layersUpdated + \" layer\" + ((layersUpdated > 1) ? \"s\" : \"\") + \", and no styles. Awesome!\";\n  else if (layersUpdated > 0 && ((layerStylesUpdated + textStylesUpdated) > 0))\n    message += \"We updated \" + layersUpdated + \" layer\" + ((layersUpdated > 1) ? \"s\" : \"\") + \", and \" + (layerStylesUpdated + textStylesUpdated) + \" style\" + (((layerStylesUpdated + textStylesUpdated) > 1) ? \"s\" : \"\") + \". Awesome!\";\n  else if (layersUpdated == 0 && ((layerStylesUpdated + textStylesUpdated) > 0))\n    message += \"We updated \" + (layerStylesUpdated + textStylesUpdated) + \" style\" + (((layerStylesUpdated + textStylesUpdated) > 1) ? \"s\" : \"\") + \", and no layers. Awesome!\";\n  else\n    message += \"We completed the merge. There were no layers or styles to update, though.\";\n\n  return message;\n}","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nvar UI = require('sketch/ui')\nvar Helpers = require(\"./Helpers\");\n\nconst webviewIdentifier = 'merge-duplicates.webview'\nconst webviewMSSIdentifier = 'merge-selected-symbols.webview'\n\n\n\nfunction MergeSymbols(symbolToMerge, symbolToKeep, basePercent, totalToMerge, webContents) {\n\n  Helpers.clog(\"-- Starting Merge Symbols (\" + symbolToMerge.duplicates.length + \")\");\n\n  var symbolsToRemove = [];\n  var symbolToApply;\n  var instancesChanged = 0;\n  var overridesChanged = 0;\n  var symbolsRemoved = 0;\n  var idsMap = new Map();\n\n  Helpers.clog(\"---- Processing symbols to remove\");\n  symbolToApply = symbolToMerge.duplicates[symbolToKeep].symbol;\n  if (symbolToMerge.duplicates[symbolToKeep].isForeign) {\n    var alreadyInDoc = (Helpers.document.getSymbols().filter(sym => sym.symbolId.localeCompare(symbolToApply.symbolId) == 0).length > 0);\n    if (!alreadyInDoc)\n      symbolToApply = Helpers.importSymbolFromLibrary(symbolToMerge.duplicates[symbolToKeep]);\n  }\n\n  var tasksToPerform = 0, tasksExecuted = 0;\n  var instancesToChange = 0, overridesToChange = 0;\n  var instOverMap = new Map();\n\n\n  Helpers.clog(\"---- Getting all related symbols instances and overrides\");\n  for (var i = 0; i < symbolToMerge.duplicates.length; i++) {\n    if (i != symbolToKeep) {\n      idsMap.set(symbolToMerge.duplicates[i].symbol.symbolId)\n      symbolsToRemove.push(symbolToMerge.duplicates[i].symbol);\n\n      var instancesOfSymbol = Helpers.getSymbolInstances(symbolToMerge.duplicates[i].symbol);\n      var symbolOverrides = Helpers.getSymbolOverrides(symbolToMerge.duplicates[i].symbol, idsMap);\n\n      instOverMap.set(symbolToMerge.duplicates[i], {\n        \"instancesOfSymbol\": instancesOfSymbol,\n        \"symbolOverrides\": symbolOverrides\n      });\n\n      instancesToChange += instancesOfSymbol.length;\n      overridesToChange += symbolOverrides.length;\n    }\n  }\n\n  tasksToPerform = instancesToChange + overridesToChange;\n\n  Helpers.ctime(\"Merging symbol:\" + symbolToMerge.name);\n  webContents.executeJavaScript(`ShowMergeProgress()`).catch(console.error);\n\n  for (var i = 0; i < symbolToMerge.duplicates.length; i++) {\n    if (i != symbolToKeep) {\n      if (!symbolToMerge.duplicates[i].isForeign)\n        symbolsRemoved++;\n\n      Helpers.ctime(\"-- Taking instances and overrides\");\n      var instancesOfSymbol = instOverMap.get(symbolToMerge.duplicates[i]).instancesOfSymbol;\n      var symbolOverrides = instOverMap.get(symbolToMerge.duplicates[i]).symbolOverrides;\n      Helpers.ctimeEnd(\"-- Taking instances and overrides\");\n\n\n      Helpers.ctime(\"-- Unlinking from library\");\n      Helpers.clog(\"------ Checking if symbol to merge is foreign\");\n      if (symbolToMerge.duplicates[i].isForeign && (symbolToMerge.duplicates[i].externalLibrary == null)) {\n        symbolToMerge.duplicates[i].symbol.unlinkFromLibrary();\n      }\n      Helpers.ctimeEnd(\"-- Unlinking from library\");\n\n\n      var message = \"Merging \" + symbolToMerge.name;\n\n      Helpers.ctime(\"-- Updating overrides\");\n      Helpers.clog(\"---- Updating overrides (\" + symbolOverrides.length + \")\");\n      symbolOverrides.forEach(function (override) {\n        try {\n          Helpers.clog(\"------ Updating override for \" + override.instance.name);\n          override.instance.setOverrideValue(override.override, symbolToApply.symbolId.toString());\n          overridesChanged++;\n          tasksExecuted++;\n          var progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n          var message2 = \"Updating overrides (\" + overridesChanged + \" of \" + overridesToChange + \")\";\n          webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n        } catch (e) {\n          Helpers.clog(\"---- ERROR: Couldn't update override for \" + override.instance.name);\n          Helpers.clog(e);\n        }\n      });\n      Helpers.ctimeEnd(\"-- Updating overrides\");\n\n\n      Helpers.ctime(\"-- Updating instances\");\n      Helpers.clog(\"---- Updating instances (\" + instancesOfSymbol.length + \")\");\n      instancesOfSymbol.forEach(function (instance) {\n        try {\n          Helpers.clog(\"------ Updating instance \" + instance.name + \", in artboard \" + instance.getParentArtboard().name);\n        }\n        catch (e) {\n          Helpers.clog(\"------ Updating instance \" + instance.name + \". Instance doesn't belong to any specific artboard.\");\n        }\n        instance.master = symbolToApply;\n\n        tasksExecuted++;\n        instancesChanged++;\n        var progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n        var message2 = \"Updating instances (\" + instancesChanged + \" of \" + instancesToChange + \")\";\n        webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n      });\n\n      Helpers.ctimeEnd(\"-- Updating instances\");\n\n    }\n  }\n\n  Helpers.ctimeEnd(\"Merging symbol:\" + symbolToMerge.name);\n\n  Helpers.clog(\"---- Finalized intance and override replacement.\");\n  Helpers.clog(\"---- Removing discarded symbols.\");\n\n  symbolsToRemove.forEach(function (symbolToRemove) {\n    symbolToRemove.remove();\n  });\n\n  Helpers.clog(\"---- Merge completed.\");\n\n  return [symbolsRemoved, instancesChanged, overridesChanged];\n}\n\n\nexport function MergeSelectedSymbols(context) {\n\n  Helpers.clog(\"----- Merge selected symbols -----\");\n\n  const options = {\n    identifier: webviewMSSIdentifier,\n    width: 900,\n    height: 700,\n    remembersWindowFrame: true,\n    show: false,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n  var mssmergeSession = [];\n\n  var selectedLayers = Helpers.document.selectedLayers.layers;\n  var selection = [];\n\n\n  if (selectedLayers.length < 2) {\n    UI.message(\"Wop! Select at least two symbols and run the plugin again :)\");\n    onShutdown(webviewMSSIdentifier);\n  } else {\n    var areAllSymbols = true;\n    selectedLayers.forEach(function (layer) {\n      if (layer.type.localeCompare(\"SymbolMaster\") != 0)\n        areAllSymbols = false;\n    });\n    if (!areAllSymbols) {\n      UI.message(\"Only symbols can be merged\");\n    } else {\n      Helpers.clog(\"Loading webview\");\n      selectedLayers.forEach(function (layer) {\n        selection.push({\n          \"symbol\": layer,\n          \"foreign\": false,\n          \"library\": null\n        });\n      });\n      browserWindow.loadURL(require('../resources/mergeselectedsymbols.html'));\n    }\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`LaunchMerge(${JSON.stringify(selection.length)})`).catch(console.error);\n  })\n\n  webContents.on('GetSymbolData', () => {\n    Helpers.clog(\"Getting session data\");\n    mssmergeSession = [];\n    mssmergeSession = Helpers.getSelectedSymbolsSession(selection);\n\n    Helpers.clog(\"Acquired merge session data\");\n\n    var reducedMergeSession = Helpers.getReducedSymbolsSession(mssmergeSession);\n    Helpers.clog(\"Acquired reduced merge session data\");\n    webContents.executeJavaScript(`DrawSymbolList(${JSON.stringify(reducedMergeSession)})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  })\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMSSIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedMergeSession, selectedIndex) => {\n    Helpers.clog(\"Execute merge. Selected symbol: \" + mssmergeSession[0].duplicates[selectedIndex].name);\n    var mergeResults = [0, 0, 0];\n\n    mergeResults = MergeSymbols(mssmergeSession[0], selectedIndex, 0, 1, webContents);\n\n    var replacedStuff = \"\";\n    if (mergeResults[1] > 0 && mergeResults[2])\n      replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n    else if (mergeResults[1] > 0)\n      replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n    else if (mergeResults[2] > 0)\n      replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n    else\n      replacedStuff = \".\";\n\n\n    Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" symbols\" + replacedStuff);\n\n    UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" symbols\" + replacedStuff + \" Amazing!\");\n\n    onShutdown(webviewMSSIdentifier);\n\n    Helpers.clog(\"Closed window\");\n  });\n};\n\nexport function MergeDuplicateSymbols(context) {\n\n  Helpers.clog(\"----- Merge duplicate symbols (with the same name) -----\");\n\n  const options = {\n    identifier: webviewIdentifier,\n    width: 1200,\n    height: 700,\n    remembersWindowFrame: true,\n    show: false,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var mergeSession = [];\n  var mergeSessionMap = new Map();\n  var symbolsMap, allDuplicates;\n\n\n  Helpers.ctime(\"countAllSymbols\");\n  var numberOfSymbols = Helpers.countAllSymbols(context, Helpers.getLibrariesEnabled());\n  Helpers.ctimeEnd(\"countAllSymbols\");\n\n\n  Helpers.clog(\"Local symbols: \" + numberOfSymbols.symbols + \". Library symbols:\" + numberOfSymbols.foreignSymbols + \". Document instances:\" + numberOfSymbols.documentInstances + \". Libraries enabled:\" + Helpers.getLibrariesEnabled());\n\n\n\n  browserWindow.loadURL(require('../resources/mergeduplicatesymbols.html'));\n  Helpers.clog(\"Webview called\");\n\n  function CalculateDuplicates(includeLibraries) {\n\n    Helpers.clog(\"Processing duplicates. Include libraries: \" + includeLibraries);\n    Helpers.ctime(\"Finding duplicates\");\n    allDuplicates = Helpers.getAllDuplicateSymbolsByName(context, includeLibraries);\n    Helpers.ctimeEnd(\"Finding duplicates\");\n\n\n    Helpers.clog(\"Getting symbols map\");\n    Helpers.ctime(\"getSymbolsMap\");\n    symbolsMap = Helpers.getSymbolsMap(context, allDuplicates);\n    Helpers.ctimeEnd(\"getSymbolsMap\");\n\n    Helpers.clog(\"-- Found \" + allDuplicates.length + \" duplicates\");\n    if (allDuplicates.length > 0) {\n      mergeSession = [];\n      Helpers.GetSpecificSymbolData(allDuplicates[0], symbolsMap);\n      allDuplicates.forEach(duplicate => {\n        var reducedSymbol = Helpers.getReducedDuplicateData(duplicate);\n        mergeSessionMap.set(reducedSymbol, duplicate);\n        mergeSession.push({\n          \"symbolWithDuplicates\": reducedSymbol,\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n          \"isProcessed\": (mergeSession.length == 0)\n        });\n      });\n    }\n    Helpers.clog(\"End of processing duplicates\");\n  }\n\n\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`LaunchMerge(${JSON.stringify(numberOfSymbols.symbols)},${JSON.stringify(numberOfSymbols.foreignSymbols)},${JSON.stringify(numberOfSymbols.documentInstances)},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  })\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewIdentifier);\n  });\n\n  webContents.on('GetSelectedSymbolData', (index) => {\n    Helpers.GetSpecificSymbolData(allDuplicates[index], symbolsMap);\n    var stringify = JSON.stringify(Helpers.getReducedDuplicateData(allDuplicates[index]))\n    webContents.executeJavaScript(`ReDrawAfterGettingData(${stringify},${index})`).catch(console.error);\n  });\n\n  webContents.on('RecalculateDuplicates', (includeLibraries, index) => {\n    if (includeLibraries != null)\n      CalculateDuplicates(includeLibraries);\n    else\n      CalculateDuplicates(Helpers.getLibrariesEnabled());\n\n    Helpers.clog(\"Drawing duplicates to webview\");\n    var stringify = JSON.stringify(mergeSession);\n    webContents.executeJavaScript(`DrawDuplicateSymbols(${stringify}, 0)`).catch(console.error);\n  });\n\n  webContents.on('ExecuteMerge', (editedMergeSession) => {\n    var duplicatesSolved = 0;\n    var mergedSymbols = 0;\n    var mergeResults = [0, 0, 0];\n    Helpers.clog(\"Executing Merge\");\n    var totalToMerge = editedMergeSession.filter(ems => !ems.isUnchecked && ems.selectedIndex >= 0).length;\n    for (var i = 0; i < editedMergeSession.length; i++) {\n      Helpers.clog(\"-- Merging \" + mergeSession[i].symbolWithDuplicates.name);\n      if (!editedMergeSession[i].isUnchecked && editedMergeSession[i].selectedIndex >= 0) {\n        mergeSession[i].selectedIndex = editedMergeSession[i].selectedIndex;\n        mergedSymbols += mergeSession[i].symbolWithDuplicates.duplicates.length;\n\n        var mergeobject = mergeSessionMap.get(mergeSession[i].symbolWithDuplicates);\n        var basePercent = (duplicatesSolved * 100 / editedMergeSession.length);\n        var localMergeResults = MergeSymbols(mergeobject, mergeSession[i].selectedIndex, basePercent, totalToMerge, webContents);\n        mergeResults[0] += localMergeResults[0];\n        mergeResults[1] += localMergeResults[1];\n        mergeResults[2] += localMergeResults[2];\n\n        duplicatesSolved++;\n      }\n    }\n\n    onShutdown(webviewIdentifier);\n\n    var replacedStuff = \"\";\n    if (mergeResults[1] > 0 && mergeResults[2])\n      replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n    else if (mergeResults[1] > 0)\n      replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n    else if (mergeResults[2] > 0)\n      replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n    else\n      replacedStuff = \".\";\n\n    if (duplicatesSolved > 0) {\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" symbols\" + replacedStuff);\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" symbols\" + replacedStuff + \" Amazing!\");\n    }\n    else {\n      Helpers.clog(\"Completed merge. No symbols were merged.\");\n      UI.message(\"No symbols were merged.\");\n    }\n  });\n\n\n};\n\nexport function onShutdown(webviewID) {\n  const existingWebview = getWebview(webviewID)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nvar UI = require('sketch/ui')\nconst Helpers = require(\"./Helpers\");\n\nconst webviewMLSFLIdentifier = 'merge-layerstylesfromlist.webview'\nconst webviewMDLSIdentifier = 'merge-duplicatelayerstyles.webview'\nconst webviewMSLSIdentifier = 'merge-similarlayerstyles.webview'\n\nvar checkingAlsoLibraries = false;\n\nfunction MergeLayerStyles(stylesToMerge, styleToKeep, basePercent, totalToMerge, webContents) {\n\n  Helpers.dlog(\"-- Starting Merge Layer Styles (\" + stylesToMerge.length + \"). Style to keep is:\" + styleToKeep);\n\n  var stylesToRemove = [];\n  var styleToApply;\n  var instancesChanged = 0;\n  var overridesChanged = 0;\n  var stylesRemoved = 0;\n  var idsMap = new Map();\n\n  Helpers.dlog(\"---- Processing styles to remove\");\n  styleToApply = stylesToMerge[styleToKeep].layerStyle;\n\n  Helpers.dlog(\"---- styleToApply(1):\");\n  Helpers.dlog(styleToApply);\n\n  if (stylesToMerge[styleToKeep].isForeign) {\n    Helpers.dlog(\"---- styleToApply is foreign\");\n\n    if (stylesToMerge[styleToKeep].localStyle) {\n      Helpers.dlog(\"---- styleToApply takes localStyle\");\n      styleToApply = stylesToMerge[styleToKeep].localStyle.layerStyle;\n    }\n    else {\n      Helpers.dlog(\"---- styleToApply is imported from library\");\n      styleToApply = Helpers.importLayerStyleFromLibrary(stylesToMerge[styleToKeep]);\n    }\n  }\n\n\n  Helpers.dlog(\"---- styleToApply)(2):\");\n  Helpers.dlog(styleToApply);\n\n  var tasksToPerform = 0, tasksExecuted = 0;\n  var progress = basePercent;\n  var instancesToChange = 0, overridesToChange = 0;\n  var instOverMap = new Map();\n\n\n  Helpers.dlog(\"---- Getting all related styles instances and overrides\");\n\n\n  var layerStylesMap = Helpers.getSimpleLayerStylesMap(context, stylesToMerge);\n  layerStylesMap.forEach((value, key) => {\n    console.log(key.name + \" has \" + value.directInstances.length + \" direct instances, \" + value.localStyleDirectInstances.length + \" local style instances, and \" + value.instancesWithOverrides.length + \" overrides. \");\n    instancesToChange += value.directInstances.length + value.localStyleDirectInstances.length;\n    overridesChanged += value.instancesWithOverrides.length;\n  });\n\n\n  for (var i = 0; i < stylesToMerge.length; i++) {\n    if (i != styleToKeep) {\n      // idsMap.set(stylesToMerge[i].layerStyle.id)\n      stylesToRemove.push(stylesToMerge[i].layerStyle);\n\n      // var instancesOfStyle = Helpers.getLayerStyleInstances(stylesToMerge[i].layerStyle);\n      // var styleOverrides = Helpers.getLayerStyleOverrides(stylesToMerge[i].layerStyle, idsMap);\n\n      // instOverMap.set(stylesToMerge[i], {\n      //   \"instancesOfStyle\": instancesOfStyle,\n      //   \"styleOverrides\": styleOverrides\n      // });\n\n      // instancesToChange += instancesOfStyle.length;\n      // overridesToChange += styleOverrides.length;\n    }\n  }\n\n  tasksToPerform = instancesToChange + overridesToChange;\n\n  Helpers.ctime(\"Merging layer style:\" + stylesToMerge[styleToKeep].name);\n  webContents.executeJavaScript(`ShowMergeProgress()`).catch(console.error);\n\n  for (var i = 0; i < stylesToMerge.length; i++) {\n    if (i != styleToKeep) {\n      if (!stylesToMerge[i].isForeign)\n        stylesRemoved++;\n\n      Helpers.ctime(\"-- Taking instances and overrides\");\n      var instancesOfStyle = layerStylesMap.get(stylesToMerge[i]).directInstances.concat(layerStylesMap.get(stylesToMerge[i]).localStyleDirectInstances);\n      var styleOverrides = layerStylesMap.get(stylesToMerge[i]).instancesWithOverrides;\n      Helpers.ctimeEnd(\"-- Taking instances and overrides\");\n\n\n      Helpers.ctime(\"-- Unlinking from library\");\n      Helpers.dlog(\"------ Checking if symbol to merge is foreign\");\n      if (stylesToMerge[i].isForeign) {\n        // Uncomment\n        // stylesToMerge[i].layerStyle.unlinkFromLibrary();\n      }\n      Helpers.ctimeEnd(\"-- Unlinking from library\");\n\n\n      var message = \"Merging \" + stylesToMerge[styleToKeep].name;\n\n      Helpers.ctime(\"-- Updating overrides\");\n      Helpers.dlog(\"---- Updating overrides (\" + styleOverrides.length + \")\");\n      styleOverrides.forEach(function (override) {\n        try {\n          Helpers.dlog(\"------ Updating override for \" + override.instance.name);\n          // Uncomment\n          // override.instance.setOverrideValue(override.override, styleToApply.id.toString());\n          overridesChanged++;\n          tasksExecuted++;\n          progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n          var message2 = \"Updating overrides (\" + overridesChanged + \" of \" + overridesToChange + \")\";\n          webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n        } catch (e) {\n          Helpers.dlog(\"---- ERROR: Couldn't update override for \" + override.instance.name);\n          Helpers.dlog(e);\n        }\n      });\n      Helpers.ctimeEnd(\"-- Updating overrides\");\n\n\n      Helpers.ctime(\"-- Updating instances\");\n      Helpers.dlog(\"---- Updating instances (\" + instancesOfStyle.length + \") to styleToApply:\" + styleToApply.name);\n      instancesOfStyle.forEach(function (instance) {\n\n        Helpers.dlog(instance);\n        var isInDocument = (Helpers.sketch.find('[id=instance.id]').length > 0);\n\n        try {\n          Helpers.dlog(\"------ Updating instance \" + instance.name + \", in artboard \" + instance.getParentArtboard().name + \". isInDocument: \" + isInDocument);\n        }\n        catch (e) {\n          Helpers.dlog(\"------ Updating instance \" + instance.name + \". Instance doesn't belong to any specific artboard.\" + \". isInDocument: \" + isInDocument);\n        }\n\n        // Uncomment\n        // instance.sharedStyle = styleToApply;\n        // instance.style.syncWithSharedStyle(styleToApply);\n\n        tasksExecuted++;\n        instancesChanged++;\n        progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n        var message2 = \"Updating instances (\" + instancesChanged + \" of \" + instancesToChange + \")\";\n        webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n      });\n\n      Helpers.ctimeEnd(\"-- Updating instances\");\n\n    }\n  }\n\n  Helpers.ctimeEnd(\"Merging layer style:\" + stylesToMerge[styleToKeep].name);\n  Helpers.dlog(\"---- Finalized instance and override replacement.\");\n\n  var sharedStylesToRemove = Helpers.document.sharedLayerStyles.filter(sharedStyle => isMarkedForRemove(sharedStyle, stylesToRemove));\n\n  Helpers.dlog(\"---- Removing discarded layer styles (\" + sharedStylesToRemove.length + \").\");\n  webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, \"Removing discarded layer styles\")`).catch(console.error);\n\n\n  Helpers.ctime(\"Removing discarded styles\");\n  sharedStylesToRemove.forEach(sharedStyleToRemove => {\n    Helpers.dlog(\"------ Removing \" + sharedStyleToRemove.name + \" (\" + sharedStyleToRemove.id + \") from sharedLayerStyles.\");\n    // Uncomment\n    // sharedStyleToRemove.unlinkFromLibrary();\n    Helpers.dlog(\"-------- Unlinked from library.\");\n    var styleIndex = Helpers.document.sharedLayerStyles.findIndex(sL => sL.id == sharedStyleToRemove.id);\n    Helpers.dlog(\"-------- Located in sharedLayerStyles (\" + styleIndex + \").\");\n    Helpers.document.sharedLayerStyles.splice(styleIndex, 1);\n    Helpers.dlog(\"-------- Removed from sharedLayerStyles.\");\n  });\n  Helpers.ctimeEnd(\"Removing discarded styles\");\n\n  Helpers.dlog(\"---- Merge completed.\");\n\n  return [stylesRemoved, instancesChanged, overridesChanged];\n\n}\n\nfunction isMarkedForRemove(sharedLayerStyle, stylesToRemove) {\n  var redId1 = sharedLayerStyle.style.id;\n  var redId2 = (sharedLayerStyle.id.indexOf(\"[\") >= 0) ? sharedLayerStyle.id.substring(sharedLayerStyle.id.indexOf(\"[\") + 1, sharedLayerStyle.id.length - 1) : null;\n  return (stylesToRemove.filter(str => (str.id == sharedLayerStyle.id) || (str.id == redId1) || (str.id == redId2)).length > 0);\n}\n\nexport function MergeDuplicateLayerStyles(context) {\n\n  Helpers.clog(\"----- Merge duplicate layer styles -----\");\n\n  const options = {\n    identifier: webviewMDLSIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var onlyDuplicatedLayerStyles, layerStylesMap;\n  var mergeSession = [];\n  var mergeSessionMap = new Map();\n\n  CalculateDuplicates(Helpers.getLibrariesEnabled());\n\n  if (onlyDuplicatedLayerStyles.length > 0) {\n    browserWindow.loadURL(require('../resources/mergeduplicatelayerstyles.html'));\n  }\n  else {\n    UI.message(\"Looks like there are no layer styles with the same name.\");\n    onShutdown(webviewMDLSIdentifier);\n  }\n\n  function CalculateDuplicates(includeLibraries) {\n    Helpers.clog(\"Finding duplicate layer styles. Including libraries:\" + includeLibraries);\n    onlyDuplicatedLayerStyles = Helpers.getAllDuplicateLayerStylesByName(context, includeLibraries);\n    console.log(onlyDuplicatedLayerStyles);\n\n    layerStylesMap = Helpers.getLayerStylesMap(context, onlyDuplicatedLayerStyles);\n    console.log(layerStylesMap);\n\n    if (onlyDuplicatedLayerStyles.length > 0) {\n      Helpers.GetSpecificLayerStyleData(onlyDuplicatedLayerStyles[0], layerStylesMap);\n      mergeSession = [];\n      onlyDuplicatedLayerStyles.forEach(duplicate => {\n        var reducedStyle = Helpers.getReducedLayerStyleData(duplicate);\n        mergeSessionMap.set(reducedStyle, duplicate);\n        mergeSession.push({\n          \"layerStyleWithDuplicates\": reducedStyle,\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n          \"isProcessed\": (mergeSession.length == 0)\n        });\n      });\n      console.log(mergeSession);\n    }\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`DrawStylesList(${JSON.stringify(mergeSession)}, ${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMDLSIdentifier);\n  });\n\n  webContents.on('RecalculateDuplicates', (includeLibraries) => {\n    Helpers.clog(\"Recalculating duplicates\");\n    CalculateDuplicates(includeLibraries);\n    webContents.executeJavaScript(`DrawStylesList(${JSON.stringify(mergeSession)})`).catch(console.error);\n  });\n\n  webContents.on('GetSelectedStyleData', (index) => {\n    Helpers.GetSpecificLayerStyleData(onlyDuplicatedLayerStyles[index], layerStylesMap);\n    var stringify = JSON.stringify(Helpers.getReducedLayerStyleData(onlyDuplicatedLayerStyles[index]));\n    webContents.executeJavaScript(`ReDrawAfterGettingData(${stringify},${index})`).catch(console.error);\n  });\n\n  webContents.on('ExecuteMerge', (editedMergeSession) => {\n    Helpers.clog(\"Executing Merge\");\n\n    var duplicatesSolved = 0;\n    var mergeResults = [0, 0, 0];\n\n    var totalToMerge = editedMergeSession.filter(ems => !ems.isUnchecked && ems.selectedIndex >= 0).length;\n\n    for (var i = 0; i < editedMergeSession.length; i++) {\n      if (!editedMergeSession[i].isUnchecked && editedMergeSession[i].selectedIndex >= 0) {\n        Helpers.clog(\"-- Merging \" + mergeSession[i].layerStyleWithDuplicates.name);\n        mergeSession[i].selectedIndex = editedMergeSession[i].selectedIndex;\n        var mergeobject = mergeSessionMap.get(mergeSession[i].layerStyleWithDuplicates);\n        var basePercent = (duplicatesSolved * 100 / editedMergeSession.length);\n\n        var localMergeResults = MergeLayerStyles(mergeobject.duplicates, mergeSession[i].selectedIndex, basePercent, totalToMerge, webContents);\n        mergeResults[0] += localMergeResults[0];\n        mergeResults[1] += localMergeResults[1];\n        mergeResults[2] += localMergeResults[2];\n\n        duplicatesSolved++;\n      }\n    }\n\n    onShutdown(webviewMDLSIdentifier);\n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" layer styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" layer styles\" + replacedStuff + \" Amazing!\");\n    }\n\n  });\n};\n\nexport function MergeSelectedLayerStyles(context) {\n\n  var layerStylesMap;\n\n  Helpers.clog(\"----- Merge selected text styles -----\");\n\n  const options = {\n    identifier: webviewMLSFLIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var allLayerStyles;\n  var styleCounter = 0;\n\n  Helpers.clog(\"Get layer styles list. Libraries included:\" + Helpers.getLibrariesEnabled());\n  allLayerStyles = Helpers.getAllLayerStyles(Helpers.getLibrariesEnabled());\n  styleCounter = allLayerStyles.length;\n  checkingAlsoLibraries = Helpers.getLibrariesEnabled();\n  Helpers.clog(\"allLayerStyles:\" + allLayerStyles.length);\n\n\n  console.log(\"Pre layerStylesMap\");\n  layerStylesMap = Helpers.getSimpleLayerStylesMap(context, allLayerStyles);\n  console.log(\"Post layerStylesMap\");\n\n  var counter = 0;\n  layerStylesMap.forEach((value, key) => {\n    if (key.name == \"Tints/Active\") {\n      console.log(key.name + \" has \" + value.directInstances.length + \" direct instances, \" + value.localStyleDirectInstances.length + \" local style instances, and \" + value.instancesWithOverrides.length + \" overrides. \");\n      // console.log(\"value.directInstances\");\n      // console.log(value.directInstances);\n      // console.log(\"value.localStyleDirectInstances\");\n      // console.log(value.localStyleDirectInstances);\n      // console.log(\"value.instancesWithOverrides\");\n      // console.log(value.instancesWithOverrides);\n      counter++;\n    }\n  });\n\n  if (styleCounter > 1) {\n    browserWindow.loadURL(require('../resources/mergelayerstylesfromlist.html'));\n  }\n  else {\n    if (styleCounter == 1)\n      UI.message(\"There's only 1 layer style. No need to merge.\");\n    else\n      UI.message(\"Looks like there are no layer styles.\");\n\n    onShutdown(webviewMLSFLIdentifier);\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`DrawStyleList(${JSON.stringify(allLayerStyles)},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('GetSpecificLayerStyleInfo', (index) => {\n    // Helpers.GetSpecificLayerStyleData(allLayerStyles[0], layerStylesMap);\n    //webContents.executeJavaScript(`PopulateSpecificLayerStyle(${JSON.stringify(allLayerStyles)})`).catch(console.error);\n  });\n\n\n  webContents.on('GetStylesList', (librariesEnabled) => {\n    Helpers.clog(\"Get styles list\");\n    allLayerStyles = Helpers.getAllLayerStyles(librariesEnabled);\n\n    checkingAlsoLibraries = librariesEnabled;\n    webContents.executeJavaScript(`DrawStyleList(${JSON.stringify(allLayerStyles)})`).catch(console.error);\n  });\n\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMLSFLIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedGlobalLayerStyles) => {\n    Helpers.clog(\"Executing Merge\");\n    var selectedIndex = -1;\n    var stylesToMerge = [];\n\n    //Create merge structure\n    for (var i = 0; i < allLayerStyles.length; i++) {\n      allLayerStyles[i].isSelected = editedGlobalLayerStyles[i].isSelected;\n      allLayerStyles[i].isChosen = editedGlobalLayerStyles[i].isChosen;\n\n      if (allLayerStyles[i].isSelected) {\n        if (allLayerStyles[i].isChosen) {\n          selectedIndex = stylesToMerge.length;\n        }\n        stylesToMerge.push(allLayerStyles[i]);\n      }\n    }\n\n    var mergeResults = MergeLayerStyles(stylesToMerge, selectedIndex, 0, 1, webContents);\n\n    onShutdown(webviewMLSFLIdentifier);\n\n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" layer styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" layer styles\" + replacedStuff + \" Amazing!\");\n    }\n  });\n};\n\nexport function MergeSimilarLayerStyles(context) {\n\n  Helpers.clog(\"----- Merge similar layer styles -----\");\n\n  const options = {\n    identifier: webviewMSLSIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var stylesWithSimilarStyles;\n  Helpers.clog(\"Loading webview\");\n  browserWindow.loadURL(require('../resources/mergesimilarlayerstyles.html'));\n\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`UpdateSettings(${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMSLSIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedStylesWithSimilarStyles) => {\n    Helpers.clog(\"Execute merge\");\n    var duplicatesSolved = 0;\n    var mergeResults = [0, 0, 0];\n\n    var totalToMerge = editedStylesWithSimilarStyles.filter(ems => !ems.isUnchecked && ems.selectedIndex >= 0).length;\n\n    for (var i = 0; i < editedStylesWithSimilarStyles.length; i++) {\n      if (!editedStylesWithSimilarStyles[i].isUnchecked && editedStylesWithSimilarStyles[i].selectedIndex >= 0) {\n        var basePercent = (duplicatesSolved * 100 / editedStylesWithSimilarStyles.length);\n        var localMergeResults = MergeLayerStyles(stylesWithSimilarStyles[i].similarStyles, editedStylesWithSimilarStyles[i].selectedIndex, basePercent, totalToMerge, webContents);\n\n        mergeResults[0] += localMergeResults[0];\n        mergeResults[1] += localMergeResults[1];\n        mergeResults[2] += localMergeResults[2];\n\n        duplicatesSolved++;\n      }\n    }\n\n    onShutdown(webviewMSLSIdentifier);\n\n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" layer styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" layer styles\" + replacedStuff + \" Amazing!\");\n    }\n\n  });\n\n  webContents.on('RecalculateStyles', (includeAllLibraries, checkSameFillColor, checkSameBorderColor, checkSameBorderThickness, checkSameShadowColor, checkSameShadowXYBlurSpread) => {\n    Helpers.clog(\"RecalculateStyles\");\n    stylesWithSimilarStyles = Helpers.FindAllSimilarLayerStyles(context, includeAllLibraries, checkSameFillColor, checkSameBorderColor, checkSameBorderThickness, checkSameShadowColor, checkSameShadowXYBlurSpread);\n\n    webContents.executeJavaScript(`DrawResultsList(${JSON.stringify(stylesWithSimilarStyles)})`).catch(console.error);\n  });\n\n}\n\n","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nconst Helpers = require(\"./Helpers\");\nvar UI = require('sketch/ui')\n\nconst webviewMTSFLIdentifier = 'merge-textstylesfromlist.webview'\nconst webviewMDTSIdentifier = 'merge-duplicatetextstyles.webview'\nconst webviewMSTSIdentifier = 'merge-similartextstyles.webview'\n\nvar checkingAlsoLibraries = false;\nvar currentSelectedStyles = [];\n\n\nfunction MergeTextStyles(stylesToMerge, styleToKeep, basePercent, totalToMerge, webContents) {\n\n  Helpers.clog(\"-- Starting Merge Layer Styles (\" + stylesToMerge.length + \"). Style to keep is:\" + styleToKeep);\n\n  var stylesToRemove = [];\n  var styleToApply;\n  var instancesChanged = 0;\n  var overridesChanged = 0;\n  var stylesRemoved = 0;\n  var idsMap = new Map();\n\n  Helpers.clog(\"---- Processing styles to remove\");\n  styleToApply = stylesToMerge[styleToKeep].textStyle;\n\n  if (stylesToMerge[styleToKeep].isForeign) {\n    var alreadyInDoc = (Helpers.document.sharedTextStyles.filter(ls => ls.id == stylesToMerge[styleToKeep].textStyle.id)).length > 0;\n    if (!alreadyInDoc)\n      styleToApply = Helpers.importTextStyleFromLibrary(stylesToMerge[styleToKeep]);\n  }\n\n  var tasksToPerform = 0, tasksExecuted = 0;\n  var progress = basePercent;\n  var instancesToChange = 0, overridesToChange = 0;\n  var instOverMap = new Map();\n\n\n  Helpers.clog(\"---- Getting all related styles instances and overrides\");\n\n  for (var i = 0; i < stylesToMerge.length; i++) {\n    if (i != styleToKeep) {\n      idsMap.set(stylesToMerge[i].textStyle.id)\n      stylesToRemove.push(stylesToMerge[i].textStyle);\n\n      var instancesOfStyle = Helpers.getTextStyleInstances(stylesToMerge[i].textStyle);\n      var styleOverrides = Helpers.getTextStyleOverrides(stylesToMerge[i].textStyle, idsMap);\n\n      instOverMap.set(stylesToMerge[i], {\n        \"instancesOfStyle\": instancesOfStyle,\n        \"styleOverrides\": styleOverrides\n      });\n\n      instancesToChange += instancesOfStyle.length;\n      overridesToChange += styleOverrides.length;\n    }\n  }\n\n  tasksToPerform = instancesToChange + overridesToChange;\n\n  Helpers.ctime(\"Merging text style:\" + stylesToMerge[styleToKeep].name);\n  webContents.executeJavaScript(`ShowMergeProgress()`).catch(console.error);\n\n  for (var i = 0; i < stylesToMerge.length; i++) {\n    if (i != styleToKeep) {\n      if (!stylesToMerge[i].isForeign)\n        stylesRemoved++;\n\n      Helpers.ctime(\"-- Taking instances and overrides\");\n      var instancesOfStyle = instOverMap.get(stylesToMerge[i]).instancesOfStyle;\n      var styleOverrides = instOverMap.get(stylesToMerge[i]).styleOverrides;\n      Helpers.ctimeEnd(\"-- Taking instances and overrides\");\n\n\n      Helpers.ctime(\"-- Unlinking from library\");\n      Helpers.clog(\"------ Checking if symbol to merge is foreign\");\n      if (stylesToMerge[i].isForeign) {\n        stylesToMerge[i].textStyle.unlinkFromLibrary();\n      }\n      Helpers.ctimeEnd(\"-- Unlinking from library\");\n\n\n      var message = \"Merging \" + stylesToMerge[styleToKeep].name;\n\n      Helpers.ctime(\"-- Updating overrides\");\n      Helpers.clog(\"---- Updating overrides (\" + styleOverrides.length + \")\");\n      styleOverrides.forEach(function (override) {\n        try {\n          Helpers.clog(\"------ Updating override for \" + override.instance.name);\n          override.instance.setOverrideValue(override.override, styleToApply.id.toString());\n          overridesChanged++;\n          tasksExecuted++;\n          progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n          var message2 = \"Updating overrides (\" + overridesChanged + \" of \" + overridesToChange + \")\";\n          webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n        } catch (e) {\n          Helpers.clog(\"---- ERROR: Couldn't update override for \" + override.instance.name);\n          Helpers.clog(e);\n        }\n      });\n      Helpers.ctimeEnd(\"-- Updating overrides\");\n\n\n      Helpers.ctime(\"-- Updating instances\");\n      Helpers.clog(\"---- Updating instances (\" + instancesOfStyle.length + \")\");\n      instancesOfStyle.forEach(function (instance) {\n        try {\n          Helpers.clog(\"------ Updating instance \" + instance.name + \", in artboard \" + instance.getParentArtboard().name);\n        }\n        catch (e) {\n          Helpers.clog(\"------ Updating instance \" + instance.name + \". Instance doesn't belong to any specific artboard.\");\n        }\n\n        instance.sharedStyle = styleToApply;\n        instance.style.syncWithSharedStyle(styleToApply);\n\n        tasksExecuted++;\n        instancesChanged++;\n        progress = Math.floor(basePercent + ((tasksExecuted * 100 / tasksToPerform) / totalToMerge));\n        var message2 = \"Updating instances (\" + instancesChanged + \" of \" + instancesToChange + \")\";\n        webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, ${JSON.stringify(message2)})`).catch(console.error);\n      });\n\n      Helpers.ctimeEnd(\"-- Updating instances\");\n\n    }\n  }\n\n  Helpers.ctimeEnd(\"Merging text style:\" + stylesToMerge[styleToKeep].name);\n  Helpers.clog(\"---- Finalized instance and override replacement.\");\n\n  var sharedStylesToRemove = Helpers.document.sharedTextStyles.filter(sharedStyle => isMarkedForRemove(sharedStyle, stylesToRemove));\n\n  Helpers.clog(\"---- Removing discarded text styles (\" + sharedStylesToRemove.length + \").\");\n  webContents.executeJavaScript(`UpdateMergeProgress(${progress}, ${JSON.stringify(message)}, \"Removing discarded text styles\")`).catch(console.error);\n\n\n  Helpers.ctime(\"Removing discarded styles\");\n  sharedStylesToRemove.forEach(sharedStyleToRemove => {\n    Helpers.clog(\"------ Removing \" + sharedStyleToRemove.name + \" (\" + sharedStyleToRemove.id + \") from sharedTextStyles.\");\n    sharedStyleToRemove.unlinkFromLibrary();\n    Helpers.clog(\"-------- Unlinked from library.\");\n    var styleIndex = Helpers.document.sharedTextStyles.findIndex(sL => sL.id == sharedStyleToRemove.id);\n    Helpers.clog(\"-------- Located in sharedTextStyles (\" + styleIndex + \").\");\n    Helpers.document.sharedTextStyles.splice(styleIndex, 1);\n    Helpers.clog(\"-------- Removed from sharedTextStyles.\");\n  });\n  Helpers.ctimeEnd(\"Removing discarded styles\");\n\n  Helpers.clog(\"---- Merge completed.\");\n\n  return [stylesRemoved, instancesChanged, overridesChanged];\n\n}\n\nfunction isMarkedForRemove(sharedTextStyle, stylesToRemove) {\n  var redId1 = sharedTextStyle.style.id;\n  var redId2 = (sharedTextStyle.id.indexOf(\"[\") >= 0) ? sharedTextStyle.id.substring(sharedTextStyle.id.indexOf(\"[\") + 1, sharedTextStyle.id.length - 1) : null;\n  return (stylesToRemove.filter(str => (str.id == sharedTextStyle.id) || (str.id == redId1) || (str.id == redId2)).length > 0);\n}\n\nexport function MergeDuplicateTextStyles(context) {\n\n  Helpers.clog(\"----- Merge duplicate text styles -----\");\n\n  const options = {\n    identifier: webviewMDTSIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var onlyDuplicatedTextStyles, textStylesMap;\n  var mergeSession = [];\n  var mergeSessionMap = new Map();\n\n\n  CalculateDuplicates(Helpers.getLibrariesEnabled());\n\n  if (onlyDuplicatedTextStyles.length > 0) {\n    browserWindow.loadURL(require('../resources/mergeduplicatetextstyles.html'));\n  }\n  else {\n    UI.message(\"Looks like there are no text styles with the same name.\");\n    onShutdown(webviewMDTSIdentifier);\n  }\n\n  function CalculateDuplicates(includeLibraries) {\n    Helpers.clog(\"Finding duplicate text styles. Including libraries:\" + includeLibraries);\n    onlyDuplicatedTextStyles = Helpers.getAllDuplicateTextStylesByName(context, includeLibraries);\n    textStylesMap = Helpers.getTextStylesMap(context, onlyDuplicatedTextStyles);\n\n    if (onlyDuplicatedTextStyles.length > 0) {\n\n      Helpers.GetSpecificTextStyleData(onlyDuplicatedTextStyles[0], textStylesMap);\n      mergeSession = [];\n      onlyDuplicatedTextStyles.forEach(duplicate => {\n        var reducedStyle = Helpers.getReducedTextStyleData(duplicate);\n        mergeSessionMap.set(reducedStyle, duplicate);\n        mergeSession.push({\n          \"textStyleWithDuplicates\": reducedStyle,\n          \"selectedIndex\": -1,\n          \"isUnchecked\": false,\n          \"isProcessed\": (mergeSession.length == 0)\n        });\n      });\n    }\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`DrawStylesList(${JSON.stringify(mergeSession)}, ${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMDTSIdentifier);\n  });\n\n\n\n  webContents.on('RecalculateDuplicates', (includeLibraries) => {\n    Helpers.clog(\"Recalculating duplicates\");\n    CalculateDuplicates(includeLibraries);\n    webContents.executeJavaScript(`DrawStylesList(${JSON.stringify(mergeSession)})`).catch(console.error);\n  });\n\n  webContents.on('GetSelectedStyleData', (index) => {\n    Helpers.GetSpecificTextStyleData(onlyDuplicatedTextStyles[index], textStylesMap);\n    var stringify = JSON.stringify(Helpers.getReducedTextStyleData(onlyDuplicatedTextStyles[index]));\n    webContents.executeJavaScript(`ReDrawAfterGettingData(${stringify},${index})`).catch(console.error);\n  });\n\n  webContents.on('ExecuteMerge', (editedMergeSession) => {\n    Helpers.clog(\"Executing Merge\");\n\n    var duplicatesSolved = 0;\n    var mergeResults = [0, 0, 0];\n\n    var totalToMerge = editedMergeSession.filter(ems => !ems.isUnchecked && ems.selectedIndex >= 0).length;\n\n    for (var i = 0; i < editedMergeSession.length; i++) {\n      Helpers.clog(\"-- Merging \" + mergeSession[i].textStyleWithDuplicates.name);\n      if (!editedMergeSession[i].isUnchecked && editedMergeSession[i].selectedIndex >= 0) {\n        Helpers.clog(\"-- Merging \" + mergeSession[i].textStyleWithDuplicates.name);\n        mergeSession[i].selectedIndex = editedMergeSession[i].selectedIndex;\n        var mergeobject = mergeSessionMap.get(mergeSession[i].textStyleWithDuplicates);\n        var basePercent = (duplicatesSolved * 100 / editedMergeSession.length);\n\n        var localMergeResults = MergeTextStyles(mergeobject.duplicates, mergeSession[i].selectedIndex, basePercent, totalToMerge, webContents);\n        mergeResults[0] += localMergeResults[0];\n        mergeResults[1] += localMergeResults[1];\n        mergeResults[2] += localMergeResults[2];\n\n        duplicatesSolved++;\n      }\n    }\n\n    onShutdown(webviewMDTSIdentifier);\n    \n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" text styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" text styles\" + replacedStuff + \" Amazing!\");\n    }\n\n\n  });\n};\n\nexport function MergeSelectedTextStyles(context) {\n\n  Helpers.clog(\"----- Merge selected text styles -----\");\n\n  const options = {\n    identifier: webviewMTSFLIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var allTextStyles;\n  var styleCounter = 0;\n\n  Helpers.clog(\"Get text styles list. Libraries included:\" + Helpers.getLibrariesEnabled());\n\n  allTextStyles = Helpers.getAllTextStyles(Helpers.getLibrariesEnabled());\n  styleCounter = allTextStyles.length;\n  checkingAlsoLibraries = Helpers.getLibrariesEnabled();\n  Helpers.clog(\"allTextStyles:\" + allTextStyles.length);\n\n  if (styleCounter > 1) {\n    browserWindow.loadURL(require('../resources/mergetextstylesfromlist.html'));\n  }\n  else {\n    if (styleCounter == 1)\n      UI.message(\"There's only 1 text style. No need to merge.\");\n    else\n      UI.message(\"Looks like there are no text styles.\");\n\n    onShutdown(webviewMTSFLIdentifier);\n  }\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`DrawStyleList(${JSON.stringify(allTextStyles)},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('GetStylesList', (librariesEnabled) => {\n    Helpers.clog(\"Get styles list\");\n    allTextStyles = Helpers.getAllTextStyles(librariesEnabled);\n\n    checkingAlsoLibraries = librariesEnabled;\n    webContents.executeJavaScript(`DrawStyleList(${JSON.stringify(allTextStyles)})`).catch(console.error);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMTSFLIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedGlobalTextStyles) => {\n    Helpers.clog(\"Executing Merge\");\n    var selectedIndex = -1;\n    var stylesToMerge = [];\n\n    //Create merge structure\n    for (var i = 0; i < allTextStyles.length; i++) {\n      allTextStyles[i].isSelected = editedGlobalTextStyles[i].isSelected;\n      allTextStyles[i].isChosen = editedGlobalTextStyles[i].isChosen;\n\n      if (allTextStyles[i].isSelected) {\n        if (allTextStyles[i].isChosen) {\n          selectedIndex = stylesToMerge.length;\n        }\n        stylesToMerge.push(allTextStyles[i]);\n      }\n    }\n\n    var mergeResults = MergeTextStyles(stylesToMerge, selectedIndex, 0, 1, webContents);\n\n    onShutdown(webviewMTSFLIdentifier);\n\n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" text styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" text styles\" + replacedStuff + \" Amazing!\");\n    }\n  });\n};\n\nexport function MergeSimilarTextStyles(context) {\n\n  Helpers.clog(\"----- Merge similar text styles -----\");\n\n  const options = {\n    identifier: webviewMSTSIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(options);\n  const webContents = browserWindow.webContents;\n\n  var stylesWithSimilarStyles;\n\n  Helpers.clog(\"Loading webview\");\n  browserWindow.loadURL(require('../resources/mergesimilartextstyles.html'));\n\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    Helpers.clog(\"Webview loaded\");\n    webContents.executeJavaScript(`UpdateSettings(${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewMSTSIdentifier);\n  });\n\n  webContents.on('ExecuteMerge', (editedStylesWithSimilarStyles) => {\n    Helpers.clog(\"Execute merge\");\n    var duplicatesSolved = 0;\n    var mergeResults = [0, 0, 0];\n\n    var totalToMerge = editedStylesWithSimilarStyles.filter(ems => !ems.isUnchecked && ems.selectedIndex >= 0).length;\n\n    for (var i = 0; i < editedStylesWithSimilarStyles.length; i++) {\n      if (!editedStylesWithSimilarStyles[i].isUnchecked && editedStylesWithSimilarStyles[i].selectedIndex >= 0) {\n        var basePercent = (duplicatesSolved * 100 / editedStylesWithSimilarStyles.length);\n        var localMergeResults = MergeTextStyles(stylesWithSimilarStyles[i].similarStyles, editedStylesWithSimilarStyles[i].selectedIndex, basePercent, totalToMerge, webContents);\n\n        mergeResults[0] += localMergeResults[0];\n        mergeResults[1] += localMergeResults[1];\n        mergeResults[2] += localMergeResults[2];\n\n        duplicatesSolved++;\n      }\n    }\n\n    onShutdown(webviewMSTSIdentifier);\n\n    if (mergeResults[0] <= 0) {\n      Helpers.clog(\"No styles were merged\");\n      UI.message(\"No styles were merged\");\n    }\n    else {\n      var replacedStuff = \"\";\n      if (mergeResults[1] > 0 && mergeResults[2])\n        replacedStuff = \", replaced \" + mergeResults[1] + \" instances, and updated \" + mergeResults[2] + \" overrides.\";\n      else if (mergeResults[1] > 0)\n        replacedStuff = \" and replaced \" + mergeResults[1] + \" instances.\";\n      else if (mergeResults[2] > 0)\n        replacedStuff = \" and updated \" + mergeResults[2] + \" overrides.\";\n      else\n        replacedStuff = \".\";\n\n\n      Helpers.clog(\"Completed merge. Removed \" + mergeResults[0] + \" text styles\" + replacedStuff);\n\n      UI.message(\"Hey ho! You just removed \" + mergeResults[0] + \" text styles\" + replacedStuff + \" Amazing!\");\n    }\n\n  });\n\n  webContents.on('RecalculateStyles', (includeAllLibraries, checkSameFont, checkSameWeight, checkSameSize, checkSameColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) => {\n    Helpers.clog(\"RecalculateStyles\");\n    stylesWithSimilarStyles = Helpers.FindAllSimilarTextStyles(context, includeAllLibraries, checkSameFont, checkSameWeight, checkSameSize, checkSameColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing);\n    webContents.executeJavaScript(`DrawResultsList(${JSON.stringify(stylesWithSimilarStyles)})`).catch(console.error);\n  });\n\n}\n","module.exports = require(\"buffer\");","module.exports = require(\"events\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}