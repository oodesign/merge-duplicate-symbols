var globalThis=this,global=this;function __skpm_run(key,context){globalThis.context=context;try{var exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){var i=n(8),r=n(12),a=n(13),o=n(15),s=n(16),l=n(17),c=n(18),u=n(9),d=n(19);function h(e){var t=(e=e||{}).identifier||NSUUID.UUID().UUIDString(),n=NSThread.mainThread().threadDictionary(),g=h.fromId(t);if(g)return g;var m=new i;if(m.id=t,e.modal&&!e.parent)throw new Error("A modal needs to have a parent.");var f=coscript.createFiber(),y=e.width||800,p=e.height||600,S=NSScreen.screens().firstObject().frame(),b=NSMakeRect(void 0!==e.x?e.x:Math.round((NSWidth(S)-y)/2),void 0!==e.y?NSHeight(S)-e.y:Math.round((NSHeight(S)-p)/2),y,p);e.titleBarStyle&&"default"!==e.titleBarStyle&&(e.frame=!1);var v="textured"!==e.windowType,w=NSTitledWindowMask;!1!==e.minimizable&&(w|=NSMiniaturizableWindowMask),!1!==e.closable&&(w|=NSClosableWindowMask),!1!==e.resizable&&(w|=NSResizableWindowMask),v&&!e.transparent&&!1!==e.frame||(w|=NSTexturedBackgroundWindowMask);var x=NSPanel.alloc().initWithContentRect_styleMask_backing_defer(b,w,NSBackingStoreBuffered,!0),M=WKWebViewConfiguration.alloc().init(),N=WKWebView.alloc().initWithFrame_configuration(CGRectMake(0,0,e.width||800,e.height||600),M);if(l(N),N.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),r(m,x,N),a(m,x,N),d(m,x,N,e),"desktop"===e.windowType&&(x.setLevel(kCGDesktopWindowLevel-1),x.setCollectionBehavior(NSWindowCollectionBehaviorCanJoinAllSpaces|NSWindowCollectionBehaviorStationary|NSWindowCollectionBehaviorIgnoresCycle)),void 0===e.minWidth&&void 0===e.minHeight||m.setMinimumSize(e.minWidth||0,e.minHeight||0),void 0===e.maxWidth&&void 0===e.maxHeight||m.setMaximumSize(e.maxWidth||1e4,e.maxHeight||1e4),e.transparent||!1===e.frame){x.titlebarAppearsTransparent=!0,x.titleVisibility=NSWindowTitleHidden,x.setOpaque(0),x.isMovableByWindowBackground=!0;var C=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");C.setShowsBaselineSeparator(!1),x.setToolbar(C)}if("hiddenInset"===e.titleBarStyle){var k=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");k.setShowsBaselineSeparator(!1),x.setToolbar(k)}!1!==e.frame&&e.useContentSize||m.setSize(y,p),e.center&&m.center(),e.alwaysOnTop&&m.setAlwaysOnTop(!0),e.fullscreen&&m.setFullScreen(!0),m.setFullScreenable(!!e.fullscreenable);const E=e.title||("undefined"!=typeof __command&&__command.pluginBundle()?__command.pluginBundle().name():void 0);E&&m.setTitle(E);var L=e.backgroundColor;e.transparent&&(L=NSColor.clearColor()),!L&&!1===e.frame&&e.vibrancy&&(L=NSColor.clearColor()),m._setBackgroundColor(L||NSColor.windowBackgroundColor()),!1===e.hasShadow&&m.setHasShadow(!1),void 0!==e.opacity&&m.setOpacity(e.opacity),e.webPreferences=e.webPreferences||{},N.configuration().preferences().setValue_forKey(!1!==e.webPreferences.devTools,"developerExtrasEnabled"),N.configuration().preferences().setValue_forKey(!1!==e.webPreferences.javascript,"javaScriptEnabled"),N.configuration().preferences().setValue_forKey(!!e.webPreferences.plugins,"plugInsEnabled"),N.configuration().preferences().setValue_forKey(e.webPreferences.minimumFontSize||0,"minimumFontSize"),e.webPreferences.zoomFactor&&N.setMagnification(e.webPreferences.zoomFactor);var F=x.contentView();return!1!==e.frame?(N.setFrame(F.bounds()),F.addSubview(N)):(F.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),o(F,F.superview()),N.setFrame(F.bounds()),F.addSubview(N),x.standardWindowButton(NSWindowFullScreenButton)&&x.standardWindowButton(NSWindowFullScreenButton).setHidden(!0),e.titleBarStyle&&"default"!==e.titleBarStyle||(x.standardWindowButton(NSWindowZoomButton).setHidden(!0),x.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),x.standardWindowButton(NSWindowCloseButton).setHidden(!0),x.standardWindowButton(NSWindowZoomButton).setEnabled(!1))),e.vibrancy&&m.setVibrancy(e.vibrancy),m.setMaximizable(!1!==e.maximizable),x.setHidesOnDeactivate(!1!==e.hidesOnDeactivate),e.remembersWindowFrame&&(x.setFrameAutosaveName(t),x.setFrameUsingName_force(x.frameAutosaveName(),!1)),e.acceptsFirstMouse&&m.on("focus",(function(e){e.type()===NSEventTypeLeftMouseDown&&m.webContents.executeJavaScript(s(N,e)).catch(()=>{})})),u.injectScript(N),c.injectScript(N),c.setupHandler(m),!1!==e.show&&m.show(),m.on("closed",(function(){m._destroyed=!0,n.removeObjectForKey(t),f.cleanup()})),n[t]=x,f.onCleanup((function(){m._destroyed||m.destroy()})),m}h.fromId=function(e){var t=NSThread.mainThread().threadDictionary();if(t[e])return h.fromPanel(t[e],e)},h.fromPanel=function(e,t){var n=new i;if(n.id=t,!e||!e.contentView)throw new Error("needs to pass an NSPanel");for(var o=null,s=e.contentView().subviews(),l=0;l<s.length;l+=1)o||s[l].isKindOfClass(WKInspectorWKWebView)||!s[l].isKindOfClass(WKWebView)||(o=s[l]);if(!o)throw new Error("The panel needs to have a webview");return r(n,e,o),a(n,e,o),n},e.exports=h},,function(e,t,n){var i=NSThread.mainThread().threadDictionary();e.exports.getWebview=function(e){return n(0).fromId(e)},e.exports.isWebviewPresent=function(e){return!!i[e]},e.exports.sendToWebview=function(t,n){if(e.exports.isWebviewPresent(t)){for(var r=null,a=i[t].contentView().subviews(),o=0;o<a.length;o+=1)r||a[o].isKindOfClass(WKInspectorWKWebView)||!a[o].isKindOfClass(WKWebView)||(r=a[o]);if(!r||!r.evaluateJavaScript_completionHandler)throw new Error("Webview "+t+" not found");r.evaluateJavaScript_completionHandler(n,null)}}},function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r,a=n(6),o=n(7),s=n(7).ShapePath,l=n(7).Text,c=n(22),u=n(48),d=n(26),h=n(29),g=a.getSelectedDocument(),m=g.getSymbols(),f=o.getLibraries(),y=!1,p=!0,S="Single",b={app:"app",no:"no",over:"over",noCon:"nocon"},v="ðŸ’Ž This Sketch file",w=["init","alloc","/usr/bin/curl","setLaunchPath","setArguments","pipe","setStandardOutput","setStandardError","launch","waitUntilExit","terminationStatus","readDataToEndOfFile","fileHandleForReading","initWithData_encoding","success","purchase","Team","indexOf","variants","Team license","2","Double","Single","app","Merge Duplicates - Registering license: Team license","log","uses","Merge Duplicates - Registering license: "," - Seats (",") exceeded license (",").","over","no","noCon"];function x(e,t){var n=NSTask[w[1]]()[w[0]]();n[w[3]](w[2]),n[w[4]](e);var r=NSPipe[w[5]](),a=NSPipe[w[5]]();n[w[6]](r),n[w[7]](a),n[w[8]](),n[w[9]]();var o=n[w[10]](),s=a[w[12]]()[w[11]]();NSString[w[1]]()[w[13]](s,NSUTF8StringEncoding);if(0==o){var l=r[w[12]]()[w[11]](),c=function(e){try{var t=JSON.parse(e);if(t&&"object"===i(t)&&null!==t)return t}catch(n){}return!1}(NSString[w[1]]()[w[13]](l,NSUTF8StringEncoding));if(c[w[14]]){if(t){if(null!=c[w[15]]){if(c[w[15]][w[18]][w[17]](w[16])>0)return console[w[25]](w[24]),b[w[23]];var u=1;return S=w[22],c[w[15]][w[18]][w[17]](w[20])>0&&(u=2,S=w[21]),c[w[26]]>u?(console[w[25]](w[27]+S+w[28]+c[w[26]]+w[29]+u+w[30]),b[w[31]]):(console[w[25]](w[27]+S),b[w[23]])}return b[w[23]]}return null!=c[w[15]]&&(S=c[w[15]][w[18]][w[17]](w[16])>0?w[19]:c[w[15]][w[18]][w[17]](w[20])>0?w[21]:w[22]),b[w[23]]}return b[w[32]]}return b[w[33]]}var M=["path","mainPluginsFolderURL","/merge.json","startTime","licenseKey","-d","product_permalink=mergeduplicatesymbols","license_key=","","increment_uses_count=","https://api.gumroad.com/v2/licenses/verify"];function N(e,t){return x([M[5],M[6],M[5],M[7]+e+M[8],M[5],M[9]+t.toString()+M[8],M[10]],t)}function C(e,t){NSString.stringWithFormat("%@",e);var n=NSString.stringWithFormat("%@",t);d.writeFileSync(n,JSON.stringify(e),{encoding:"utf8"})}function k(e){return JSON.parse(d.readFileSync(e,{encoding:"utf8"}))}var E=function(e,t){return JSON.parse(d.readFileSync(e,{encoding:"utf8"}))};function L(e){var t,i=n(4).getTheme(),r=u.lab("#"+e);t="dark"===i?u.lab("#212124"):u.lab("#F9F9F9");var a={L:r.l,A:r.a,B:r.b},o={L:t.l,A:t.a,B:t.b},s=c.getDeltaE76(a,o);return parseFloat(s)<30}function F(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function _(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function D(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function R(e,t,n,i,r,a,o,s,l,c,u){var d=[];return t.forEach((function(t){try{if(e!=t.textStyle){var n=!1;try{n=e.style.fontFamily==t.textStyle.style.fontFamily}catch(v){X("Finding similar text styles - Couldn't disclose font")}var h=!1;try{h=e.style.fontWeight==t.textStyle.style.fontWeight}catch(v){X("Finding similar text styles - Couldn't disclose weight")}var g=!1;try{g=e.style.fontSize==t.textStyle.style.fontSize}catch(v){X("Finding similar text styles - Couldn't disclose size")}var m=!1;try{m=e.style.textColor==t.textStyle.style.textColor}catch(v){X("Finding similar text styles - Couldn't disclose color")}var f=!1;try{f=e.style.paragraphSpacing==t.textStyle.style.paragraphSpacing}catch(v){X("Finding similar text styles - Couldn't disclose paragraph spacing")}var y=!1;try{y=e.style.lineHeight==t.textStyle.style.lineHeight}catch(v){X("Finding similar text styles - Couldn't disclose line height")}var p=!1;try{p=e.style.alignment==t.textStyle.style.alignment}catch(v){X("Finding similar text styles - Couldn't disclose alignment")}var S=!1;try{S=e.style.kerning==t.textStyle.style.kerning}catch(w){X("Finding similar text styles - Couldn't disclose character spacing")}var b=!0;i&&(b=b&&n),r&&(b=b&&h),a&&(b=b&&g),o&&(b=b&&m),s&&(b=b&&f),l&&(b=b&&y),c&&(b=b&&p),u&&(b=b&&S),b&&d.push(t)}}catch(v){X("There was an issue finding similar text styles")}})),d}function O(e,t,n,i,r,a,o,s){var l=[];return t.forEach((function(t){try{if(e!=t.layerStyle){var n=!1;e.style.fills.length>0&&t.layerStyle.style.fills.length>0&&(n=e.style.fills[0].color.substring(0,7).toUpperCase()==t.layerStyle.style.fills[0].color.substring(0,7).toUpperCase());var c=!1;e.style.borders.length>0&&t.layerStyle.style.borders.length>0&&(c=e.style.borders[0].color.substring(0,7).toUpperCase()==t.layerStyle.style.borders[0].color.substring(0,7).toUpperCase());var u=!1;e.style.borders.length>0&&t.layerStyle.style.borders.length>0&&(u=e.style.borders[0].thickness==t.layerStyle.style.borders[0].thickness);var d=!1;e.style.shadows.length>0&&t.layerStyle.style.shadows.length>0&&(d=e.style.shadows[0].color.substring(0,7).toUpperCase()==t.layerStyle.style.shadows[0].color.substring(0,7).toUpperCase());var h=!1;e.style.shadows.length>0&&t.layerStyle.style.shadows.length>0&&(h=e.style.shadows[0].x==t.layerStyle.style.shadows[0].x&&e.style.shadows[0].y==t.layerStyle.style.shadows[0].y&&e.style.shadows[0].blur==t.layerStyle.style.shadows[0].blur&&e.style.shadows[0].spread==t.layerStyle.style.shadows[0].spread);var g=!0;i&&(g=g&&n),r&&(g=g&&c),a&&(g=g&&u),o&&(g=g&&d),s&&(g=g&&h),g&&l.push(t)}}catch(m){X("There was an issue finding similar layer styles")}})),l}function I(e,t,n){var i=[];return t.forEach((function(t){e!=t.colorVariable&&function(e,t,n){n||(n=30);var i=u.lab(e),r=u.lab(t),a=(e={L:i.l,A:i.a,B:i.b},t={L:r.l,A:r.a,B:r.b},c.getDeltaE76(e,t));return parseFloat(a)<n}("#"+e.color.substring(1,7),"#"+t.colorVariable.color.substring(1,7),n)&&i.push(t)})),i}function T(e){return e.getAllInstances()}function P(e,t){var n=[];return a.find("SymbolInstance",g).filter((function(e){return W(e,t)})).forEach((function(t){t.overrides.filter((function(t){return"symbolID"==t.property&&!t.isDefault&&t.value==e.symbolId})).forEach((function(e){n.push({instance:t,override:e})}))})),n}function W(e,t){try{return null!=e.sketchObject.overrides()&&e.sketchObject.overrides().count()>0&&function e(t,n,i){for(var r in t){var a=t[r].symbolID;if(null!=a){if("function"==typeof a&&(a=a()),n.has(""+a))return!0}else if(e(t[r],n,i))return!0}return!1}(e.sketchObject.overrides(),t,e)}catch(i){X("-- Controlled exception : "+i),X("---- Start processing "+e.name+" via API");var n=!1;return e.overrides.forEach((function(e){"symbolID"==e.property&&!e.isDefault&&t.has(e.value)&&(n=!0)})),X(n?"---- Does have overrides. Added to map response.":"---- Does not have overrides"),n}}function U(e,t){return null!=e.sketchObject.overrides()&&e.sketchObject.overrides().count()>0&&function e(t,n,i,r){for(var a in t){if(null==t[a].symbolID)if(t[a]instanceof __NSDictionaryM){for(var o in t[a])if(t[a][o]instanceof __NSDictionaryM){if(e(t[a][o],n,i,r+1))return!0}else if(n.has(""+t[a][o]))return!0}else try{if(n.has(""+t[a]))return!0}catch(s){Helpers.clog("Error while processing overrides (1)."),Helpers.clog(n),Helpers.clog(t[a]),Helpers.clog(s)}else try{if(e(t[a],n,i,r+1))return!0}catch(s){Helpers.clog("Error while processing overrides (2)."),Helpers.clog(n),Helpers.clog(t[a]),Helpers.clog(s)}}return!1}(e.sketchObject.overrides(),t,e)}function A(e){return e.style.fontFamily+" "+e.style.fontSize+"pt - "+e.style.alignment}function B(e){var t="";return e.style.fills.length>0?t+="Fill"+(e.style.fills[0].enabled?"":" (disabled)")+": "+e.style.fills[0].color.substring(0,7).toUpperCase():t+="No fill",t+=" - ",e.style.borders.length>0?t+="Border"+(e.style.borders[0].enabled?"":" (disabled)")+": "+e.style.borders[0].color.substring(0,7).toUpperCase():t+="No border",t}function V(e){var t=new s({shapeType:s.ShapeType.Oval,frame:new a.Rectangle(0,0,300,300),style:e.style,parent:g.selectedPage});try{var n=a.export(t,{scales:"1",formats:"png",output:!1}).toString("base64");return t.remove(),n}catch(i){return t.remove(),""}}function J(e){var t=new l({text:"The quick brown fox",frame:new a.Rectangle(0,0,600,100),style:e.style,parent:g.selectedPage});try{var n=a.export(t,{scales:"5",formats:"png",output:!1}).toString("base64");return t.remove(),n}catch(i){return t.remove(),""}}function z(e){var t=new s({shapeType:s.ShapeType.Oval,frame:new a.Rectangle(0,0,300,300),style:{fills:[{color:e.color}]},parent:g.selectedPage});try{var n=a.export(t,{scales:"1",formats:"png",output:!1}).toString("base64");return t.remove(),n}catch(i){return t.remove(),""}}function H(e){var t=[],n=new Map,i=new Map;return g.sharedLayerStyles.forEach((function(e){var r=e.getLibrary();if(!n.has(e.id)){var a=e.style.id,o=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,s=!1;s=null!=o?i.has(a)||i.has(o):i.has(a);var l={layerStyle:e,name:""+e.name,libraryName:null!=r?"ðŸ”¸"+r.name:v,library:r,isForeign:null!=r,isSelected:!1,isChosen:!1,description:B(e),thumbnail:V(e),numInstances:0,numOverrides:0,isSelected:!1,contrastMode:e.style.fills.length>0&&L(e.style.fills[0].color.substring(1,7)),isHidden:s};t.push(l),n.set(e.style.id,!0),i.set(a,l),null!=o&&i.set(o,l)}})),e&&f.forEach((function(e){e&&e.id&&e.enabled&&context.document.documentData()&&0!=context.document.documentData().objectID().toString().localeCompare(e.id)&&e.getDocument().sharedLayerStyles.forEach((function(r){if(!n.has(r.style.id)){var a=r.style.id,o=r.id.indexOf("[")>=0?r.id.substring(r.id.indexOf("[")+1,r.id.length-1):null,s=!1;s=null!=o?i.has(a)||i.has(o):i.has(a);var l={layerStyle:r,name:""+r.name,libraryName:"ðŸ”¸"+e.name,library:e,isForeign:!0,isSelected:!1,isChosen:!1,description:B(r),thumbnail:V(r),numInstances:0,numOverrides:0,isSelected:!1,contrastMode:r.style.fills.length>0&&L(r.style.fills[0].color.substring(1,7)),isHidden:s};t.push(l),n.set(r.style.id,!0),i.set(a,l),null!=o&&i.set(o,l)}}))})),t.sort(F)}function j(e){var t=[],n=new Map,i=new Map;return g.sharedTextStyles.forEach((function(e){var r=e.getLibrary();if(!n.has(e.id)){var a=e.style.id,o=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,s=!1;s=null!=o?i.has(a)||i.has(o):i.has(a);var l={textStyle:e,name:""+e.name,libraryName:null!=r?"ðŸ”¸"+r.name:v,library:r,isForeign:null!=r,isSelected:!1,isChosen:!1,description:A(e),thumbnail:J(e),numInstances:0,numOverrides:0,isSelected:!1,contrastMode:L(e.style.textColor.substring(1,7)),isHidden:s};t.push(l),n.set(e.style.id,!0),i.set(a,l),null!=o&&i.set(o,l)}})),e&&f.forEach((function(e){e&&e.id&&e.enabled&&context.document.documentData()&&0!=context.document.documentData().objectID().toString().localeCompare(e.id)&&e.getDocument().sharedTextStyles.forEach((function(r){if(!n.has(r.style.id)){var a=r.style.id,o=r.id.indexOf("[")>=0?r.id.substring(r.id.indexOf("[")+1,r.id.length-1):null,s=!1;s=null!=o?i.has(a)||i.has(o):i.has(a);var l={textStyle:r,name:""+r.name,libraryName:"ðŸ”¸"+e.name,library:e,isForeign:!0,isSelected:!1,isChosen:!1,description:A(r),thumbnail:J(r),numInstances:0,numOverrides:0,isSelected:!1,contrastMode:L(r.style.textColor.substring(1,7)),isHidden:s};t.push(l),n.set(r.style.id,!0),i.set(a,l),null!=o&&i.set(o,l)}}))})),t.sort(F)}function G(e){var t=[],n=new Map;return g.swatches.forEach((function(e){var i={colorVariable:e,name:""+e.name,color:""+e.color.substring(0,7),libraryName:v,library:null,isForeign:!1,isSelected:!1,isChosen:!1,description:""+e.color.substring(0,7),thumbnail:z(e),contrastMode:L(e.color.substring(1,7)),duplicates:[],isSelected:!1};t.push(i),n.set(e.id,!0)})),e&&f.forEach((function(e){e&&e.id&&e.enabled&&context.document.documentData()&&0!=context.document.documentData().objectID().toString().localeCompare(e.id)&&e.getDocument().swatches.forEach((function(i){if(!n.has(i.id)){var r={colorVariable:i,name:""+i.name,color:""+i.color.substring(0,7),libraryName:"ðŸ”¸"+e.name,library:e,isForeign:!0,isSelected:!1,isChosen:!1,description:""+i.color.substring(0,7),thumbnail:z(i),contrastMode:L(i.color.substring(1,7)),duplicates:[],isSelected:!1};t.push(r)}}))})),t}function q(e,t){return j(t).sort(F)}function K(e,t){return G(t).sort(_)}function Z(e){var t=e.symbol;if(e.isForeign)try{var n=e.symbol.getAllInstances();if(n.length>0)X("---- Foreign. Getting image using first instance."),t=n[0];else X("---- Foreign. Getting image using library reference."),t=e.library.getDocument().getLayerWithID(e.symbol.id)}catch(i){X("---- ERROR: Couldn't load (foreign symbol) "+e.symbol.name+" library document.")}try{return a.export(t,{scales:"3",formats:"png",output:!1}).toString("base64")}catch(i){return""}}function X(e){y&&console.log(e)}function Y(e){0}function $(e){0}var Q=["path","mainPluginsFolderURL","/merge.json","logs","librariesEnabledByDefault","log"];e.exports={getSymbolInstances:T,compareStyleArrays:F,FindAllSimilarTextStyles:function(e,t,n,i,r,a,o,s,l,c){for(var u=[],d=[],h=q(e,t),g=0;g<h.length;g++)if(X("Finding similar styles to '"+h[g].name+"'"),0==h[g].libraryName.localeCompare(v)&&-1==d.indexOf(h[g])){var m=R(h[g].textStyle,h,0,n,i,r,a,o,s,l,c);d.push(h[g]),m.forEach((function(e){d.push(e)})),m.unshift(h[g]),m.length>1&&u.push({referenceStyle:h[g],similarStyles:m,selectedIndex:-1,isUnchecked:!1})}return u},FindSimilarTextStyles:R,FindAllSimilarLayerStyles:function(e,t,n,i,r,a,o){for(var s=[],l=[],c=function(e,t){return H(t).sort(F)}(0,t),u=0;u<c.length;u++)if(X("Finding similar styles to '"+c[u].name+"'"),-1==l.indexOf(c[u])){var d=O(c[u].layerStyle,c,0,n,i,r,a,o);l.push(c[u]),d.forEach((function(e){l.push(e)})),d.unshift(c[u]),d.length>1&&s.push({referenceStyle:c[u],similarStyles:d,selectedIndex:-1,isUnchecked:!1})}return s},FindSimilarLayerStyles:O,getAllLayerStyles:H,getDefinedTextStyles:q,IsInTrial:function(){try{var e=E(MSPluginManager[M[1]]()[M[0]]()+M[2]);return null!=e&&null!=e[M[3]]?e[M[3]]:null}catch(t){return null}},ExiGuthrie:function(){try{var e=E(MSPluginManager[M[1]]()[M[0]]()+M[2]);return null!=e&&null!=e[M[4]]&&N(e[M[4]],!1)}catch(t){return!1}},Guthrie:N,valStatus:b,writeTextToFile:C,commands:{mergeduplicatesymbols:"mergeduplicatesymbols",mergeselectedsymbols:"mergeselectedsymbols",mergeselectedtextstyles:"mergeselectedtextstyles",mergesimilartextstyles:"mergesimilartextstyles",mergeduplicatetextstyles:"mergeduplicatetextstyles",mergesimilarlayerstyles:"mergesimilarlayerstyles",mergeselectedlayerstyles:"mergeselectedlayerstyles",mergeduplicatelayerstyles:"mergeduplicatelayerstyles",mergeduplicatecolorvariables:"mergeduplicatecolorvariables",mergeselectedcolorvariables:"mergeselectedcolorvariables",mergesimilarcolorvariables:"mergesimilarcolorvariables",editsettings:"editsettings"},getSelectedSymbolsSession:function(e){var t=[],n=new Map;return e.forEach((function(e){var i=e.library,r=e.isForeign,a=v;if(r&&(a="ðŸ”¸"+i.name),0==t.length){var o={name:""+e.symbol.name,duplicates:[]};t.push(o)}else o=t[0];n.set(e.symbol.symbolId,e.symbol);var s=T(e.symbol),l=P(e.symbol,n);o.duplicates.push({name:""+e.symbol.name,symbol:e.symbol,isForeign:r,thumbnail:Z(e),symbolInstances:s,numInstances:s.length,symbolOverrides:l,numOverrides:l.length,libraryName:a,library:i,isSelected:!1})})),t.sort(D)},GetSpecificSymbolData:function(e,t){Y("GetSpecificSymbolData");var n=0,i=0;e.duplicates.forEach((function(e){var r=t.get(e.symbol);e.thumbnail=Z(e),e.symbolInstances=r.directInstances,e.numInstances=r.directInstances.length,e.symbolOverrides=r.instancesWithOverrides,e.numOverrides=r.instancesWithOverrides.length,n+=e.numInstances,i+=e.numOverrides})),X("-- Found "+n+" instances, "+i+" overrides, and created "+e.duplicates.length+" thumbnails"),$("GetSpecificSymbolData")},GetSpecificLayerStyleData:function(e,t){Y("GetSpecificLayerStyleData");var n=0,i=0;e.duplicates.forEach((function(e){var r=t.get(e.layerStyle);e.thumbnail=V(e.layerStyle),e.styleInstances=r.directInstances,e.numInstances=r.directInstances.length,e.styleOverrides=r.instancesWithOverrides,e.numOverrides=r.instancesWithOverrides.length,n+=e.numInstances,i+=e.numOverrides})),X("-- Found "+n+" instances, "+i+" overrides, and created "+e.duplicates.length+" thumbnails"),$("GetSpecificLayerStyleData")},GetSpecificTextStyleData:function(e,t){Y("GetSpecificTextStyleData");var n=0,i=0;e.duplicates.forEach((function(e){var r=t.get(e.textStyle);e.thumbnail=J(e.textStyle),e.styleInstances=r.directInstances,e.numInstances=r.directInstances.length,e.styleOverrides=r.instancesWithOverrides,e.numOverrides=r.instancesWithOverrides.length,n+=e.numInstances,i+=e.numOverrides})),X("-- Found "+n+" instances, "+i+" overrides, and created "+e.duplicates.length+" thumbnails"),$("GetSpecificTextStyleData")},shouldEnableContrastMode:L,countAllSymbols:function(e,t){var n={symbols:m.length,foreignSymbols:0,documentInstances:a.find("SymbolInstance",g).length};return n[0]=m.length,t&&f.forEach((function(t){t&&t.id&&t.enabled&&e.document.documentData()&&0!=e.document.documentData().objectID().toString().localeCompare(t.id)&&(n.foreignSymbols+=t.getDocument().getSymbols().length)})),n},writeTextToFile:C,readFromFile:k,LoadSettings:function(){try{null!=(r=k(MSPluginManager[Q[1]]()[Q[0]]()+Q[2]))&&null!=r[Q[3]]&&(y=r[Q[3]]),null!=r&&null!=r[Q[4]]&&(p=r[Q[4]])}catch(e){return console[Q[5]](e),null}},clog:X,getLogsEnabled:function(){return y},getSettings:function(){return r},getLibrariesEnabled:function(){return p},getAcquiredLicense:function(){return S},document:g,importSymbolFromLibrary:function(e){try{X("-- Importing "+e.name+" from library"+e.libraryName+" with ID:"+e.symbol.id+" and symbolId:"+e.symbol.symbolId);var t=e.library.getImportableSymbolReferencesForDocument(g).filter((function(t){return t.id==e.symbol.symbolId}))[0].import();return X("-- We've imported:"+t.name+" from library "+t.getLibrary().name),t}catch(n){return X("-- ERROR: Couldn't import "+e.name+" from library"+e.libraryName+" with ID:"+e.symbol.id+" and symbolId:"+e.symbol.symbolId),e.symbol}},importLayerStyleFromLibrary:function(e){try{X("-- Importing "+e.name+" from library "+e.libraryName+" with ID:"+e.layerStyle.id);var t=e.library.getImportableLayerStyleReferencesForDocument(g).filter((function(t){return t.id==e.layerStyle.id}))[0].import();return X("-- We've imported:"+t.name+" from library "+t.getLibrary().name),t}catch(n){return X("-- ERROR: Couldn't import "+e.name+" from library"+e.libraryName+" with ID:"+e.layerStyle.id),null}},getSymbolOverrides:P,getSymbolInstances:T,importTextStyleFromLibrary:function(e){try{X("-- Importing "+e.name+" from library "+e.libraryName+" with ID:"+e.textStyle.id);var t=e.library.getImportableTextStyleReferencesForDocument(g).filter((function(t){return t.id==e.textStyle.id}))[0].import();return X("-- We've imported:"+t.name+" from library "+t.getLibrary().name),t}catch(n){return X("-- ERROR: Couldn't import "+e.name+" from library"+e.libraryName+" with ID:"+e.textStyle.id),null}},getDefinedColorVariables:K,importColorVariableFromLibrary:function(e){try{X("-- Importing "+e.name+" from library "+e.libraryName+" with ID:"+e.colorVariable.id);var t=e.library.getImportableSwatchReferencesForDocument(g).filter((function(t){return t.name==e.colorVariable.name}))[0].import();return X("-- We've imported:"+t.name),t}catch(n){return X("-- ERROR: Couldn't import "+e.name+" from library"+e.libraryName+" with ID:"+e.colorVariable.id),X(n),null}},getDuplicateColorVariables:function(e,t){var n=G(t),i={},r=[],a=[];return n.forEach((function(e){var t={colorVariable:e.colorVariable,name:""+e.name,color:""+e.color,isForeign:e.isForeign,thumbnail:e.thumbnail,libraryName:e.libraryName,library:e.library,isSelected:!1,isChosen:!1,description:""+e.color,thumbnail:z(e.colorVariable),contrastMode:L(e.colorVariable.color.substring(1,7)),duplicates:[],isSelected:!1};a.push(""+e.colorVariable.id),null==i[e.name]?(r.push(t),t.duplicates.push({colorVariable:e.colorVariable,name:""+e.name,color:""+e.color,isForeign:e.isForeign,thumbnail:e.thumbnail,libraryName:e.libraryName,library:e.library,isSelected:!1,isChosen:!1,description:""+e.color,thumbnail:z(e.colorVariable),contrastMode:L(e.colorVariable.color.substring(1,7)),duplicates:null,isSelected:!1}),i[e.name]=t):i[e.name].duplicates.push(t)})),Object.keys(i).forEach((function(e){var t=!1;if(i[e].duplicates.length<=1&&(t=!0),!t){var n=!0;i[e].duplicates.forEach((function(e){e.isForeign||(n=!1)})),n&&(t=!0)}if(t){var a=r.indexOf(i[e]);a>-1&&r.splice(a,1),i[e]=null}})),r},FindAllSimilarColorVariables:function(e,t,n){for(var i=[],r=[],a=K(e,t),o=0;o<a.length;o++)if(X("Finding similar color variables to '"+a[o].name+"'"),-1==r.indexOf(a[o])){var s=I(a[o].colorVariable,a,n);r.push(a[o]),s.forEach((function(e){r.push(e)})),s.unshift(a[o]),s.length>1&&i.push({referenceStyle:a[o],similarStyles:s,selectedIndex:-1,isUnchecked:!1})}return i},analytics:function(e){h("UA-143977399-1","event",{ec:"command",ea:e})},getAllDuplicateSymbolsByName:function(e,t){var n=[],i=new Map,r=new Map;return g.getSymbols().forEach((function(e){var t;r.has(e.id)||(i.has(e.name)?(t=i.get(e.name)).duplicates.push({name:""+e.name,symbol:e,isForeign:null!=e.getLibrary(),thumbnail:"",symbolInstances:null,numInstances:0,symbolOverrides:null,numOverrides:0,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isSelected:!1}):((t={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,symbol:e,isForeign:null!=e.getLibrary(),thumbnail:"",symbolInstances:null,numInstances:0,symbolOverrides:null,numOverrides:0,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isSelected:!1}),n.push(t),r.set(e.id,t),i.set(e.name,t)))})),t&&f.forEach((function(t){t&&t.id&&t.enabled&&e.document.documentData()&&0!=e.document.documentData().objectID().toString().localeCompare(t.id)&&t.getDocument().getSymbols().forEach((function(e){var a;r.has(e.id)||(i.has(e.name)?(a=i.get(e.name)).duplicates.push({name:""+e.name,symbol:e,isForeign:!0,thumbnail:"",symbolInstances:null,numInstances:0,symbolOverrides:null,numOverrides:0,libraryName:t.name,library:t,isSelected:!1}):((a={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,symbol:e,isForeign:!0,thumbnail:"",symbolInstances:null,numInstances:0,symbolOverrides:null,numOverrides:0,libraryName:t.name,library:t,isSelected:!1}),n.push(a),r.set(e.id,a),i.set(e.name,a)))}))})),i.forEach((function(e,t){var i=!1;if(e.duplicates.length<=1&&(i=!0),!i){var r=!0;e.duplicates.forEach((function(e){e.isForeign||(r=!1)})),i=r}if(i){var a=n.indexOf(e);a>-1&&n.splice(a,1)}})),n.sort(D)},getSymbolsMap:function(e,t){var n=new Map,i=new Map;return t.forEach((function(e){e.duplicates.forEach((function(e){i.set(e.symbol.symbolId,e.symbol),n.set(e.symbol,{directInstances:e.symbol.getAllInstances(),instancesWithOverrides:[]})}))})),a.find("SymbolInstance",g).filter((function(e){return W(e,i)})).forEach((function(e){e.overrides.filter((function(e){return"symbolID"==e.property&&!e.isDefault&&i.has(e.value)})).forEach((function(t){n.get(i.get(t.value)).instancesWithOverrides.push(e)}))})),n},updateAllDuplicatesWithMap:function(e,t){e.forEach((function(e){e.duplicates.forEach((function(n){n.symbolInstances=t.get(e).directInstances}))}))},ctime:Y,ctimeEnd:$,sketchlocalfile:v,getTimingEnabled:function(){return!1},getReducedDuplicateData:function(e){var t={name:""+e.name,duplicates:[]};return e.duplicates.forEach((function(e){t.duplicates.push({name:""+e.name,isForeign:e.isForeign,thumbnail:e.thumbnail,numInstances:e.numInstances,numOverrides:e.numOverrides,libraryName:e.libraryName,isSelected:!1})})),t},getReducedSymbolsSession:function(e){var t=[];return e.forEach((function(e){var n={name:""+e.name,duplicates:[]};e.duplicates.forEach((function(e){n.duplicates.push({name:""+e.name,isForeign:e.isForeign,thumbnail:e.thumbnail,numInstances:e.numInstances,numOverrides:e.numOverrides,libraryName:e.libraryName,library:e.library,isSelected:e.isSelected})})),t.push(n)})),t},getAllDuplicateLayerStylesByName:function(e,t){var n=[],i=new Map,r=new Map,a=new Map;return g.sharedLayerStyles.forEach((function(e){if(!r.has(e.id)){var t,o=e.style.id,s=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,l=!1;if(l=null!=s?a.has(o)||a.has(s):a.has(o),i.has(e.name))(t=i.get(e.name)).duplicates.push({name:""+e.name,layerStyle:e,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isForeign:null!=e.getLibrary(),isSelected:!1,isChosen:!1,description:B(e),thumbnail:"",isSelected:!1,contrastMode:e.style.fills.length>0&&L(e.style.fills[0].color.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:l});else(t={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,layerStyle:e,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isForeign:null!=e.getLibrary(),isSelected:!1,isChosen:!1,description:B(e),thumbnail:"",isSelected:!1,contrastMode:e.style.fills.length>0&&L(e.style.fills[0].color.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:l}),n.push(t),r.set(e.id,t),i.set(e.name,t);a.set(o,t),null!=s&&a.set(s,t)}})),t&&f.forEach((function(t){t&&t.id&&t.enabled&&e.document.documentData()&&0!=e.document.documentData().objectID().toString().localeCompare(t.id)&&t.getDocument().sharedLayerStyles.forEach((function(e){if(!r.has(e.id)){var o,s=e.style.id,l=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,c=!1;if(c=null!=l?a.has(s)||a.has(l):a.has(s),i.has(e.name))(o=i.get(e.name)).duplicates.push({name:""+e.name,layerStyle:e,libraryName:"ðŸ”¸"+t.name,library:t,isForeign:!0,isSelected:!1,isChosen:!1,description:B(e),thumbnail:"",isSelected:!1,contrastMode:e.style.fills.length>0&&L(e.style.fills[0].color.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:c});else(o={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,layerStyle:e,libraryName:"ðŸ”¸"+t.name,library:t,isForeign:!0,isSelected:!1,isChosen:!1,description:B(e),thumbnail:"",isSelected:!1,contrastMode:e.style.fills.length>0&&L(e.style.fills[0].color.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:c}),n.push(o),r.set(e.id,o),i.set(e.name,o);a.set(s,o),null!=l&&a.set(l,o)}}))})),i.forEach((function(e,t){var i=!1;if(e.duplicates.length<=1&&(i=!0),!i){var r=!0;e.duplicates.forEach((function(e){e.isForeign||(r=!1)})),i=r}if(i){var a=n.indexOf(e);a>-1&&n.splice(a,1)}})),n.sort(D)},getLayerStylesMap:function(e,t){var n=new Map,i=new Map;return t.forEach((function(e){e.duplicates.forEach((function(e){var t=e.layerStyle.style.id,r=e.layerStyle.id.indexOf("[")>=0?e.layerStyle.id.substring(e.layerStyle.id.indexOf("[")+1,e.layerStyle.id.length-1):null;i.set(e.layerStyle.id,e.layerStyle),i.set(t,e.layerStyle),null!=r&&i.set(r,e.layerStyle),n.set(e.layerStyle,{directInstances:e.layerStyle.getAllInstancesLayers(),instancesWithOverrides:[]})}))})),a.find("SymbolInstance",g).filter((function(e){return U(e,i)})).forEach((function(e){e.sketchObject.overrides().count()>0&&e.overrides.filter((function(e){return"layerStyle"==e.property&&!e.isDefault&&i.has(e.value)})).forEach((function(t){n.get(i.get(t.value)).instancesWithOverrides.push(e)}))})),n},getReducedLayerStyleData:function(e){var t={name:""+e.name,duplicates:[]};return e.duplicates.forEach((function(e){e.isHidden||t.duplicates.push({id:e.layerStyle.id+" // "+e.layerStyle.style.id+" // "+(e.layerStyle.id.indexOf("[")>=0?e.layerStyle.id.substring(e.layerStyle.id.indexOf("[")+1,e.layerStyle.id.length-1):"xxx"),name:""+e.name,isForeign:e.isForeign,description:e.description,thumbnail:e.thumbnail,contrastMode:e.contrastMode,numInstances:e.numInstances,numOverrides:e.numOverrides,libraryName:e.libraryName,isSelected:e.isSelected,isHidden:e.isHidden})})),t},getLayerStyleInstances:function(e){return e.getAllInstancesLayers()},getLayerStyleOverrides:function(e,t){var n=[];return a.find("SymbolInstance",g).filter((function(e){return U(e,t)})).forEach((function(e){e.sketchObject.overrides().count()>0&&e.overrides.filter((function(e){return"layerStyle"==e.property&&!e.isDefault&&t.has(e.value)})).forEach((function(t){n.push({instance:e,override:t})}))})),n},getAllTextStyles:j,getAllDuplicateTextStylesByName:function(e,t){var n=[],i=new Map,r=new Map,a=new Map;return g.sharedTextStyles.forEach((function(e){if(!r.has(e.id)){var t,o=e.style.id,s=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,l=!1;if(l=null!=s?a.has(o)||a.has(s):a.has(o),i.has(e.name))(t=i.get(e.name)).duplicates.push({name:""+e.name,textStyle:e,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isForeign:null!=e.getLibrary(),isSelected:!1,isChosen:!1,description:A(e),thumbnail:"",isSelected:!1,contrastMode:L(e.style.textColor.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:l});else(t={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,textStyle:e,libraryName:null!=e.getLibrary()?"ðŸ”¸"+e.getLibrary().name:v,library:null!=e.getLibrary()?e.getLibrary():null,isForeign:null!=e.getLibrary(),isSelected:!1,isChosen:!1,description:A(e),thumbnail:"",isSelected:!1,contrastMode:L(e.style.textColor.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:l}),n.push(t),r.set(e.id,t),i.set(e.name,t);a.set(o,t),null!=s&&a.set(s,t)}})),t&&f.forEach((function(t){t&&t.id&&t.enabled&&e.document.documentData()&&0!=e.document.documentData().objectID().toString().localeCompare(t.id)&&t.getDocument().sharedTextStyles.forEach((function(e){if(!r.has(e.id)){var o,s=e.style.id,l=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null,c=!1;if(c=null!=l?a.has(s)||a.has(l):a.has(s),i.has(e.name))(o=i.get(e.name)).duplicates.push({name:""+e.name,textStyle:e,libraryName:"ðŸ”¸"+t.name,library:t,isForeign:!0,isSelected:!1,isChosen:!1,description:A(e),thumbnail:"",isSelected:!1,contrastMode:L(e.style.textColor.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:c});else(o={name:""+e.name,duplicates:[]}).duplicates.push({name:""+e.name,textStyle:e,libraryName:"ðŸ”¸"+t.name,library:t,isForeign:!0,isSelected:!1,isChosen:!1,description:A(e),thumbnail:"",isSelected:!1,contrastMode:L(e.style.textColor.substring(1,7)),styleInstances:null,numInstances:0,styleOverrides:null,numOverrides:0,isHidden:c}),n.push(o),r.set(e.id,o),i.set(e.name,o);a.set(s,o),null!=l&&a.set(l,o)}}))})),i.forEach((function(e,t){var i=!1;if(e.duplicates.length<=1&&(i=!0),!i){var r=!0;e.duplicates.forEach((function(e){e.isForeign||(r=!1)})),i=r}if(i){var a=n.indexOf(e);a>-1&&n.splice(a,1)}})),n.sort(D)},getTextStylesMap:function(e,t){var n=new Map,i=new Map;return t.forEach((function(e){e.duplicates.forEach((function(e){var t=e.textStyle.style.id,r=e.textStyle.id.indexOf("[")>=0?e.textStyle.id.substring(e.textStyle.id.indexOf("[")+1,e.textStyle.id.length-1):null;i.set(e.textStyle.id,e.textStyle),i.set(t,e.textStyle),null!=r&&i.set(r,e.textStyle),n.set(e.textStyle,{directInstances:e.textStyle.getAllInstancesLayers(),instancesWithOverrides:[]})}))})),a.find("SymbolInstance",g).filter((function(e){return U(e,i)})).forEach((function(e){e.sketchObject.overrides().count()>0&&e.overrides.filter((function(e){return"textStyle"==e.property&&!e.isDefault&&i.has(e.value)})).forEach((function(t){n.get(i.get(t.value)).instancesWithOverrides.push(e)}))})),n},getReducedTextStyleData:function(e){var t={name:""+e.name,duplicates:[]};return e.duplicates.forEach((function(e){e.isHidden||t.duplicates.push({id:e.textStyle.id+" // "+e.textStyle.style.id+" // "+(e.textStyle.id.indexOf("[")>=0?e.textStyle.id.substring(e.textStyle.id.indexOf("[")+1,e.textStyle.id.length-1):"xxx"),name:""+e.name,isForeign:e.isForeign,description:e.description,thumbnail:e.thumbnail,contrastMode:e.contrastMode,numInstances:e.numInstances,numOverrides:e.numOverrides,libraryName:e.libraryName,isSelected:e.isSelected,isHidden:e.isHidden})})),t},getTextStyleInstances:function(e){return e.getAllInstancesLayers()},getTextStyleOverrides:function(e,t){var n=[];return a.find("SymbolInstance",g).filter((function(e){return U(e,t)})).forEach((function(e){e.sketchObject.overrides().count()>0&&e.overrides.filter((function(e){return"textStyle"==e.property&&!e.isDefault&&t.has(e.value)})).forEach((function(t){n.push({instance:e,override:t})}))})),n}}},function(e,t){e.exports=require("sketch/ui")},function(e,t){e.exports={JS_BRIDGE:"__skpm_sketchBridge",START_MOVING_WINDOW:"__skpm_startMovingWindow",EXECUTE_JAVASCRIPT:"__skpm_executeJS",EXECUTE_JAVASCRIPT_SUCCESS:"__skpm_executeJS_success_",EXECUTE_JAVASCRIPT_ERROR:"__skpm_executeJS_error_"}},function(e,t){e.exports=require("sketch")},function(e,t){e.exports=require("sketch/dom")},function(e,t){e.exports=require("events")},function(e,t,n){(function(t){var i=n(5);e.exports=function(n,r){return function a(o,s,l){"function"==typeof s&&(l=s,s=!1);var c=coscript.createFiber();return n.navigationDelegate().state&&0==n.navigationDelegate().state.wasReady?new t((function(e,t){r.once("ready-to-show",(function(){a(o,s,l).then(e).catch(t),c.cleanup()}))})):new t((function(t,a){var s=Math.random();r.webContents.on(i.EXECUTE_JAVASCRIPT_SUCCESS+s,(function(e){try{l&&l(null,e),t(e)}catch(n){a(n)}c.cleanup()})),r.webContents.on(i.EXECUTE_JAVASCRIPT_ERROR+s,(function(e){try{l?(l(e),t()):a(e)}catch(n){a(n)}c.cleanup()})),n.evaluateJavaScript_completionHandler(e.exports.wrapScript(o,s),null)}))}},e.exports.wrapScript=function(e,t){return"window."+i.EXECUTE_JAVASCRIPT+"("+t+", "+JSON.stringify(e)+")"},e.exports.injectScript=function(e){var t="window."+i.EXECUTE_JAVASCRIPT+' = function(id, script) {  try {    var res = eval(script);    if (res && typeof res.then === "function" && typeof res.catch === "function") {      res.then(function (res2) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res2);      })      .catch(function (err) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);      })    } else {      window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res);    }  } catch (err) {    window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);  }}',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}}).call(this,n(14))},function(e,t,n){"use strict";n.r(t),n.d(t,"MergeDuplicateSymbols",(function(){return S})),n.d(t,"MergeSelectedSymbols",(function(){return b})),n.d(t,"MergeSelectedTextStyles",(function(){return v})),n.d(t,"MergeSimilarTextStyles",(function(){return w})),n.d(t,"MergeDuplicateTextStyles",(function(){return x})),n.d(t,"MergeSelectedLayerStyles",(function(){return M})),n.d(t,"MergeSimilarLayerStyles",(function(){return N})),n.d(t,"MergeDuplicateLayerStyles",(function(){return C})),n.d(t,"MergeDuplicateColorVariables",(function(){return k})),n.d(t,"MergeSelectedColorVariables",(function(){return E})),n.d(t,"MergeSimilarColorVariables",(function(){return L})),n.d(t,"EditSettings",(function(){return F})),n.d(t,"triggerMethod",(function(){return R})),n.d(t,"showRegistration",(function(){return O})),n.d(t,"onShutdown",(function(){return I}));var i,r=n(0),a=n.n(r),o=n(2),s=(n(4),n(11)),l=n(33),c=n(37),u=n(41),d=n(45),h=n(6),g=n(3),m=0,f=!1,y=!1,p=!1;function S(e){g.analytics("MergeDuplicateSymbols"),i=g.commands.mergeduplicatesymbols,D(e)}function b(e){g.analytics("MergeSelectedSymbols"),i=g.commands.mergeselectedsymbols,D(e)}function v(e){g.analytics("MergeSelectedTextStyles"),i=g.commands.mergeselectedtextstyles,D(e)}function w(e){g.analytics("MergeSimilarTextStyles"),i=g.commands.mergesimilartextstyles,D(e)}function x(e){g.analytics("MergeDuplicateTextStyles"),i=g.commands.mergeduplicatetextstyles,D(e)}function M(e){g.analytics("MergeSelectedLayerStyles"),i=g.commands.mergeselectedlayerstyles,D(e)}function N(e){g.analytics("MergeSimilarLayerStyles"),i=g.commands.mergesimilarlayerstyles,D(e)}function C(e){g.analytics("MergeDuplicateLayerStyles"),i=g.commands.mergeduplicatelayerstyles,D(e)}function k(e){g.analytics("MergeDuplicateColorVariables"),i=g.commands.mergeduplicatecolorvariables,D(e)}function E(e){g.analytics("MergeSelectedColorVariables"),i=g.commands.mergeselectedcolorvariables,D(e)}function L(e){g.analytics("MergeSimilarColorVariables"),i=g.commands.mergesimilarcolorvariables,D(e)}function F(e){g.analytics("EditSettings"),i=g.commands.editsettings,D(e)}var _=["app","valStatus","noCon","over","now","abs","floor"];function D(e){var t=g.ExiGuthrie();if(t==g[_[1]][_[0]]||t==g[_[1]][_[2]])R(e);else if(t==g[_[1]][_[3]])p=!0,O(e);else{var n=g.IsInTrial(),i=new Date(parseInt(n));if(null!=n){var r=i-Date[_[4]](),a=Math[_[6]](Math[_[5]](r/864e5));(m=7-a)>0?f=!0:y=!0,O(e)}else O(e)}}function R(e){g.LoadSettings(),g.clog("Sketch version:"+h.version.sketch);var t="";try{t=NSApp.delegate().pluginManager().plugins().objectForKey("com.oodesign.mergeduplicatesymbols").version()}catch(n){t="Unable to identify version. 8+"}switch(g.clog("Merge Duplicates version: "+t),g.clog("License: "+g.getAcquiredLicense()),i){case g.commands.mergeduplicatesymbols:s.MergeDuplicateSymbols(e);break;case g.commands.mergeselectedsymbols:s.MergeSelectedSymbols(e);break;case g.commands.mergeduplicatetextstyles:c.MergeDuplicateTextStyles(e);break;case g.commands.mergeselectedtextstyles:c.MergeSelectedTextStyles(e);break;case g.commands.mergesimilartextstyles:c.MergeSimilarTextStyles(e);break;case g.commands.mergeduplicatelayerstyles:l.MergeDuplicateLayerStyles(e);break;case g.commands.mergeselectedlayerstyles:l.MergeSelectedLayerStyles(e);break;case g.commands.mergesimilarlayerstyles:l.MergeSimilarLayerStyles(e);break;case g.commands.mergeduplicatecolorvariables:u.MergeDuplicateColorVariables(e);break;case g.commands.mergeselectedcolorvariables:u.MergeSelectedColorVariables(e);break;case g.commands.mergesimilarcolorvariables:u.MergeSimilarColorVariables(e);break;case g.commands.editsettings:d.EditSettings(e)}}function O(e){var t={identifier:"merge-duplicates.webviewReg",width:1200,height:700,show:!1,titleBarStyle:"hidden"},i=new a.a(t),r=i.webContents,o=["ready-to-show","error","catch","SetTrialMode(","stringify",")","executeJavaScript","SetExpiredMode()","SetOverMode()","show","once","did-finish-load","on","RegisterKey","app","valStatus","","path","mainPluginsFolderURL","/merge.json","writeTextToFile","ShowRegistrationComplete()","over","SetOverModeInReg()","ShowRegistrationFail()","StartTrial","now","ShowTrialStarted()","ContinueTrial","LetsStartTrial","LetsStart"];i[o[10]](o[0],(function(){f&&r[o[6]]("".concat(o[3]).concat(JSON[o[4]](m)).concat(o[5]))[o[2]](console[o[1]]),y&&r[o[6]]("".concat(o[7]))[o[2]](console[o[1]]),p&&r[o[6]]("".concat(o[8]))[o[2]](console[o[1]]),i[o[9]]()})),r[o[12]](o[11],(function(){f&&r[o[6]]("".concat(o[3]).concat(JSON[o[4]](m)).concat(o[5]))[o[2]](console[o[1]]),y&&r[o[6]]("".concat(o[7]))[o[2]](console[o[1]]),p&&r[o[6]]("".concat(o[8]))[o[2]](console[o[1]])})),r[o[12]](o[13],(function(e){var t=g.Guthrie(e,!0);if(t==g[o[15]][o[14]]){var n={licenseKey:o[16]+e};g[o[20]](n,MSPluginManager[o[18]]()[o[17]]()+o[19]),r[o[6]]("".concat(o[21]))[o[2]](console[o[1]])}else t==g[o[15]][o[22]]?(r[o[6]]("".concat(o[8]))[o[2]](console[o[1]]),r[o[6]]("".concat(o[23]))[o[2]](console[o[1]])):r[o[6]]("".concat(o[24]))[o[2]](console[o[1]])})),r[o[12]](o[25],(function(e){var t={startTime:o[16]+Date[o[26]]()};g[o[20]](t,MSPluginManager[o[18]]()[o[17]]()+o[19]),r[o[6]]("".concat(o[27]))[o[2]](console[o[1]])})),r[o[12]](o[28],(function(){I("merge-duplicates.webviewReg"),R(e)})),r[o[12]](o[29],(function(){f=!0,m=7,I("merge-duplicates.webviewReg"),R(e)})),r[o[12]](o[30],(function(){f=!1,I("merge-duplicates.webviewReg"),R(e)})),r.on("nativeLog",(function(e){g.clog(e)})),r.on("OpenPluginWeb",(function(e){NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString("http://www.mergeduplicates.com"))})),r.on("Cancel",(function(){I("merge-duplicates.webviewReg")})),i.loadURL(n(47))}function I(e){var t=Object(o.getWebview)(e);t&&t.close()}},function(e,t,n){"use strict";n.r(t),n.d(t,"MergeSelectedSymbols",(function(){return c})),n.d(t,"MergeDuplicateSymbols",(function(){return u})),n.d(t,"onShutdown",(function(){return d}));var i=n(0),r=n.n(i),a=n(2),o=n(4),s=n(3);function l(e,t,n,i,r){s.clog("-- Starting Merge Symbols ("+e.duplicates.length+")");var a,o=[],l=0,c=0,u=0,d=new Map;(s.clog("---- Processing symbols to remove"),a=e.duplicates[t].symbol,e.duplicates[t].isForeign)&&(s.document.getSymbols().filter((function(e){return 0==e.symbolId.localeCompare(a.symbolId)})).length>0||(a=s.importSymbolFromLibrary(e.duplicates[t])));var h,g=0,m=0,f=0,y=new Map;s.clog("---- Getting all related symbols instances and overrides");for(var p=0;p<e.duplicates.length;p++)if(p!=t){d.set(e.duplicates[p].symbol.symbolId),o.push(e.duplicates[p].symbol);var S=s.getSymbolInstances(e.duplicates[p].symbol),b=s.getSymbolOverrides(e.duplicates[p].symbol,d);y.set(e.duplicates[p],{instancesOfSymbol:S,symbolOverrides:b}),m+=S.length,f+=b.length}h=m+f,s.ctime("Merging symbol:"+e.name),r.executeJavaScript("ShowMergeProgress()").catch(console.error);for(p=0;p<e.duplicates.length;p++)if(p!=t){e.duplicates[p].isForeign||u++,s.ctime("-- Taking instances and overrides");S=y.get(e.duplicates[p]).instancesOfSymbol,b=y.get(e.duplicates[p]).symbolOverrides;s.ctimeEnd("-- Taking instances and overrides"),s.ctime("-- Unlinking from library"),s.clog("------ Checking if symbol to merge is foreign"),e.duplicates[p].isForeign&&null==e.duplicates[p].externalLibrary&&e.duplicates[p].symbol.unlinkFromLibrary(),s.ctimeEnd("-- Unlinking from library");var v="Merging "+e.name;s.ctime("-- Updating overrides"),s.clog("---- Updating overrides ("+b.length+")"),b.forEach((function(e){try{s.clog("------ Updating override for "+e.instance.name),e.instance.setOverrideValue(e.override,a.symbolId.toString()),c++,g++;var t=Math.floor(n+100*g/h/i),o="Updating overrides ("+c+" of "+f+")";r.executeJavaScript("UpdateMergeProgress(".concat(t,", ").concat(JSON.stringify(v),", ").concat(JSON.stringify(o),")")).catch(console.error)}catch(l){s.clog("---- ERROR: Couldn't update override for "+e.instance.name),s.clog(l)}})),s.ctimeEnd("-- Updating overrides"),s.ctime("-- Updating instances"),s.clog("---- Updating instances ("+S.length+")"),S.forEach((function(e){try{s.clog("------ Updating instance "+e.name+", in artboard "+e.getParentArtboard().name)}catch(c){s.clog("------ Updating instance "+e.name+". Instance doesn't belong to any specific artboard.")}e.master=a,g++,l++;var t=Math.floor(n+100*g/h/i),o="Updating instances ("+l+" of "+m+")";r.executeJavaScript("UpdateMergeProgress(".concat(t,", ").concat(JSON.stringify(v),", ").concat(JSON.stringify(o),")")).catch(console.error)})),s.ctimeEnd("-- Updating instances")}return s.ctimeEnd("Merging symbol:"+e.name),s.clog("---- Finalized intance and override replacement."),s.clog("---- Removing discarded symbols."),o.forEach((function(e){e.remove()})),s.clog("---- Merge completed."),[u,l,c]}function c(e){s.clog("----- Merge selected symbols -----");var t={identifier:"merge-selected-symbols.webview",width:900,height:700,remembersWindowFrame:!0,show:!1,titleBarStyle:"hidden"},i=new r.a(t),a=i.webContents,c=[],u=s.document.selectedLayers.layers,h=[];if(u.length<2)o.message("Wop! Select at least two symbols and run the plugin again :)"),d("merge-selected-symbols.webview");else{var g=!0;u.forEach((function(e){0!=e.type.localeCompare("SymbolMaster")&&(g=!1)})),g?(s.clog("Loading webview"),u.forEach((function(e){h.push({symbol:e,foreign:!1,library:null})})),i.loadURL(n(31))):o.message("Only symbols can be merged")}i.once("ready-to-show",(function(){i.show()})),a.on("did-finish-load",(function(){s.clog("Webview loaded"),a.executeJavaScript("LaunchMerge(".concat(JSON.stringify(h.length),")")).catch(console.error)})),a.on("GetSymbolData",(function(){s.clog("Getting session data"),c=[],c=s.getSelectedSymbolsSession(h),s.clog("Acquired merge session data");var e=s.getReducedSymbolsSession(c);s.clog("Acquired reduced merge session data"),a.executeJavaScript("DrawSymbolList(".concat(JSON.stringify(e),")")).catch(console.error)})),a.on("nativeLog",(function(e){s.clog(e)})),a.on("Cancel",(function(){d("merge-selected-symbols.webview")})),a.on("ExecuteMerge",(function(e,t){s.clog("Execute merge. Selected symbol: "+c[0].duplicates[t].name);var n,i="";i=(n=l(c[0],t,0,1,a))[1]>0&&n[2]?", replaced "+n[1]+" instances, and updated "+n[2]+" overrides.":n[1]>0?" and replaced "+n[1]+" instances.":n[2]>0?" and updated "+n[2]+" overrides.":".",s.clog("Completed merge. Removed "+n[0]+" symbols"+i),o.message("Hey ho! You just removed "+n[0]+" symbols"+i+" Amazing!"),d("merge-selected-symbols.webview"),s.clog("Closed window")}))}function u(e){s.clog("----- Merge duplicate symbols (with the same name) -----");var t,i,a={identifier:"merge-duplicates.webview",width:1200,height:700,remembersWindowFrame:!0,show:!1,titleBarStyle:"hidden"},c=new r.a(a),u=c.webContents,h=[],g=new Map;s.ctime("countAllSymbols");var m=s.countAllSymbols(e,s.getLibrariesEnabled());function f(n){s.clog("Processing duplicates. Include libraries: "+n),s.ctime("Finding duplicates"),i=s.getAllDuplicateSymbolsByName(e,n),s.ctimeEnd("Finding duplicates"),s.clog("Getting symbols map"),s.ctime("getSymbolsMap"),t=s.getSymbolsMap(e,i),s.ctimeEnd("getSymbolsMap"),s.clog("-- Found "+i.length+" duplicates"),i.length>0&&(h=[],s.GetSpecificSymbolData(i[0],t),i.forEach((function(e){var t=s.getReducedDuplicateData(e);g.set(t,e),h.push({symbolWithDuplicates:t,selectedIndex:-1,isUnchecked:!1,isProcessed:0==h.length})}))),s.clog("End of processing duplicates")}s.ctimeEnd("countAllSymbols"),s.clog("Local symbols: "+m.symbols+". Library symbols:"+m.foreignSymbols+". Document instances:"+m.documentInstances+". Libraries enabled:"+s.getLibrariesEnabled()),c.loadURL(n(32)),s.clog("Webview called"),c.once("ready-to-show",(function(){c.show()})),u.on("did-finish-load",(function(){s.clog("Webview loaded"),u.executeJavaScript("LaunchMerge(".concat(JSON.stringify(m.symbols),",").concat(JSON.stringify(m.foreignSymbols),",").concat(JSON.stringify(m.documentInstances),",").concat(s.getLibrariesEnabled(),")")).catch(console.error)})),u.on("nativeLog",(function(e){s.clog(e)})),u.on("Cancel",(function(){d("merge-duplicates.webview")})),u.on("GetSelectedSymbolData",(function(e){s.GetSpecificSymbolData(i[e],t);var n=JSON.stringify(s.getReducedDuplicateData(i[e]));u.executeJavaScript("ReDrawAfterGettingData(".concat(n,",").concat(e,")")).catch(console.error)})),u.on("RecalculateDuplicates",(function(e,t){f(null!=e?e:s.getLibrariesEnabled()),s.clog("Drawing duplicates to webview");var n=JSON.stringify(h);u.executeJavaScript("DrawDuplicateSymbols(".concat(n,", 0)")).catch(console.error)})),u.on("ExecuteMerge",(function(e){var t=0,n=[0,0,0];s.clog("Executing Merge");for(var i=e.filter((function(e){return!e.isUnchecked&&e.selectedIndex>=0})).length,r=0;r<e.length;r++)if(s.clog("-- Merging "+h[r].symbolWithDuplicates.name),!e[r].isUnchecked&&e[r].selectedIndex>=0){h[r].selectedIndex=e[r].selectedIndex,h[r].symbolWithDuplicates.duplicates.length;var a=g.get(h[r].symbolWithDuplicates),c=100*t/e.length,m=l(a,h[r].selectedIndex,c,i,u);n[0]+=m[0],n[1]+=m[1],n[2]+=m[2],t++}d("merge-duplicates.webview");var f="";f=n[1]>0&&n[2]?", replaced "+n[1]+" instances, and updated "+n[2]+" overrides.":n[1]>0?" and replaced "+n[1]+" instances.":n[2]>0?" and updated "+n[2]+" overrides.":".",t>0?(s.clog("Completed merge. Removed "+n[0]+" symbols"+f),o.message("Hey ho! You just removed "+n[0]+" symbols"+f+" Amazing!")):(s.clog("Completed merge. No symbols were merged."),o.message("No symbols were merged."))}))}function d(e){var t=Object(a.getWebview)(e);t&&t.close()}},function(e,t){e.exports=function(e,t,n){function i(n){e.isVisible()&&(n?(NSApplication.sharedApplication().activateIgnoringOtherApps(!0),t.makeKeyAndOrderFront(null)):(t.orderBack(null),NSApp.mainWindow().makeKeyAndOrderFront(null)))}e._panel=t,e._webview=n,e._destroyed=!1,e.destroy=function(){return t.close()},e.close=function(){if(t.delegate().utils&&t.delegate().utils.parentWindow){var n=!0;return e.emit("close",{get defaultPrevented(){return!n},preventDefault:function(){n=!1}}),void(n&&t.delegate().utils.parentWindow.endSheet(t))}e.isClosable()&&t.performClose(null)},e.focus=i.bind(this,!0),e.blur=i.bind(this,!1),e.isFocused=function(){return t.isKeyWindow()},e.isDestroyed=function(){return e._destroyed},e.show=function(){return NSApp.activateIgnoringOtherApps(!0),t.delegate().utils&&t.delegate().utils.parentWindow?t.delegate().utils.parentWindow.beginSheet_completionHandler(t,__mocha__.createBlock_function("v16@?0q8",(function(){e.emit("closed")}))):t.makeKeyAndOrderFront(null)},e.showInactive=function(){return t.orderFrontRegardless()},e.hide=function(){return t.orderOut(null)},e.isVisible=function(){return t.isVisible()},e.isModal=function(){return!1},e.maximize=function(){e.isMaximized()||t.zoom(null)},e.unmaximize=function(){e.isMaximized()&&t.zoom(null)},e.isMaximized=function(){if(0!=(t.styleMask()&NSResizableWindowMask))return t.isZoomed();var e=NSScreen.mainScreen().visibleFrame(),n=t.frame();return e.origin.x==n.origin.x&&e.origin.y==n.origin.y&&e.size.width==n.size.width&&e.size.height==n.size.height},e.minimize=function(){return t.miniaturize(null)},e.restore=function(){return t.deminiaturize(null)},e.isMinimized=function(){return t.isMiniaturized()},e.setFullScreen=function(n){n!==e.isFullscreen()&&t.toggleFullScreen(null)},e.isFullscreen=function(){return t.styleMask()&NSFullScreenWindowMask},e.setAspectRatio=function(e){e>0?t.setAspectRatio(NSMakeSize(e,1)):t.setResizeIncrements(NSMakeSize(1,1))},e.setBounds=function(n,i){if(!n)return;if(e.isFullscreen())return;const r=Object.assign(e.getBounds(),n);var a=NSMakeRect(r.x,0,r.width,r.height),o=NSScreen.screens().firstObject();a.origin.y=NSHeight(o.frame())-r.y,t.setFrame_display_animate(a,!0,i)},e.getBounds=function(){const e=t.frame();var n=NSScreen.screens().firstObject().frame();return{x:e.origin.x,y:Math.round(NSHeight(n)-e.origin.y),width:e.size.width,height:e.size.height}},e.setContentBounds=function(t,n){e.setBounds(t,n)},e.getContentBounds=function(){return e.getBounds()},e.setSize=function(t,n,i){return e.setBounds({width:t,height:n},i)},e.getSize=function(){var t=e.getBounds();return[t.width,t.height]},e.setContentSize=function(t,n,i){return e.setContentBounds({width:t,height:n},i)},e.getContentSize=function(){var t=e.getContentBounds();return[t.width,t.height]},e.setMinimumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMinSize(i)},e.getMinimumSize=function(){const e=t.contentMinSize();return[e.width,e.height]},e.setMaximumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMaxSize(i)},e.getMaximumSize=function(){const e=t.contentMaxSize();return[e.width,e.height]},e.setResizable=function(t){return e._setStyleMask(t,NSResizableWindowMask)},e.isResizable=function(){return t.styleMask()&NSResizableWindowMask},e.setMovable=function(e){return t.setMovable(e)},e.isMovable=function(){return t.isMovable()},e.setMinimizable=function(t){return e._setStyleMask(t,NSMiniaturizableWindowMask)},e.isMinimizable=function(){return t.styleMask()&NSMiniaturizableWindowMask},e.setMaximizable=function(e){t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).setEnabled(e)},e.isMaximizable=function(){return t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).isEnabled()},e.setFullScreenable=function(t){e._setCollectionBehavior(t,NSWindowCollectionBehaviorFullScreenPrimary),e._setCollectionBehavior(!t,NSWindowCollectionBehaviorFullScreenAuxiliary)},e.isFullScreenable=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorFullScreenPrimary},e.setClosable=function(t){e._setStyleMask(t,NSClosableWindowMask)},e.isClosable=function(){return t.styleMask()&NSClosableWindowMask},e.setAlwaysOnTop=function(e,n,i){var r=NSNormalWindowLevel,a=CGWindowLevelForKey(kCGMaximumWindowLevelKey),o=CGWindowLevelForKey(kCGMinimumWindowLevelKey);e&&(r="normal"===n?NSNormalWindowLevel:"torn-off-menu"===n?NSTornOffMenuWindowLevel:"modal-panel"===n?NSModalPanelWindowLevel:"main-menu"===n?NSMainMenuWindowLevel:"status"===n?NSStatusWindowLevel:"pop-up-menu"===n?NSPopUpMenuWindowLevel:"screen-saver"===n?NSScreenSaverWindowLevel:"dock"===n?NSDockWindowLevel:NSFloatingWindowLevel);var s=r+(i||0);if(!(s>=o&&s<=a))throw new Error("relativeLevel must be between "+o+" and "+a);t.setLevel(s)},e.isAlwaysOnTop=function(){return t.level()!==NSNormalWindowLevel},e.moveTop=function(){return t.orderFrontRegardless()},e.center=function(){t.center()},e.setPosition=function(t,n,i){return e.setBounds({x:t,y:n},i)},e.getPosition=function(){var t=e.getBounds();return[t.x,t.y]},e.setTitle=function(e){t.setTitle(e)},e.getTitle=function(){return String(t.title())};var r=0;e.flashFrame=function(e){e?r=NSApp.requestUserAttention(NSInformationalRequest):(NSApp.cancelUserAttentionRequest(r),r=0)},e.getNativeWindowHandle=function(){return t},e.getNativeWebViewHandle=function(){return n},e.loadURL=function(e){if(/^(?!https?|file).*\.html?$/.test(e)&&"undefined"!=typeof __command&&__command.pluginBundle()&&(e="file://"+__command.pluginBundle().urlForResourceNamed(e).path()),/^file:\/\/.*\.html?$/.test(e))return e=(e=NSString.alloc().initWithString(e)).stringByAddingPercentEncodingWithAllowedCharacters(NSCharacterSet.URLQueryAllowedCharacterSet()),void n.loadFileURL_allowingReadAccessToURL(NSURL.URLWithString(e),NSURL.URLWithString("file:///"));const t=NSURL.URLWithString(e),i=NSURLRequest.requestWithURL(t);n.loadRequest(i)},e.reload=function(){n.reload()},e.setHasShadow=function(e){return t.setHasShadow(e)},e.hasShadow=function(){return t.hasShadow()},e.setOpacity=function(e){return t.setAlphaValue(e)},e.getOpacity=function(){return t.alphaValue()},e.setVisibleOnAllWorkspaces=function(t){return e._setCollectionBehavior(t,NSWindowCollectionBehaviorCanJoinAllSpaces)},e.isVisibleOnAllWorkspaces=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorCanJoinAllSpaces},e.setIgnoreMouseEvents=function(e){return t.setIgnoresMouseEvents(e)},e.setContentProtection=function(e){t.setSharingType(e?NSWindowSharingNone:NSWindowSharingReadOnly)},e.setAutoHideCursor=function(e){t.setDisableAutoHideCursor(e)},e.setVibrancy=function(n){var i=e._vibrantView;if(!n){if(null==i)return;return i.removeFromSuperview(),void t.setVibrantView(null)}if(null==i){var r=t.contentView();i=NSVisualEffectView.alloc().initWithFrame(r.bounds()),e._vibrantView=i,i.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),i.setBlendingMode(NSVisualEffectBlendingModeBehindWindow),i.setState(NSVisualEffectStateActive),i.setFrame(r.bounds()),r.addSubview_positioned_relativeTo(i,NSWindowBelow,null)}var a=NSVisualEffectMaterialLight;"appearance-based"===n?a=NSVisualEffectMaterialAppearanceBased:"light"===n?a=NSVisualEffectMaterialLight:"dark"===n?a=NSVisualEffectMaterialDark:"titlebar"===n?a=NSVisualEffectMaterialTitlebar:"selection"===n?a=NSVisualEffectMaterialSelection:"menu"===n?a=NSVisualEffectMaterialMenu:"popover"===n?a=NSVisualEffectMaterialPopover:"sidebar"===n?a=NSVisualEffectMaterialSidebar:"medium-light"===n?a=NSVisualEffectMaterialMediumLight:"ultra-dark"===n&&(a=NSVisualEffectMaterialUltraDark),i.setMaterial(a)},e._setBackgroundColor=function(e){var i=function(e){if(!e||"#"!==e[0]){if(e&&"function"==typeof e.isKindOfClass&&e.isKindOfClass(NSColor))return e;throw new Error("Incorrect color formating. It should be an hex color: #RRGGBBAA")}var t,n=e.substr(1);if(3===n.length?n+="F":6===n.length&&(n+="FF"),4===n.length)for(var i=0;i<4;i+=1)t+=n[i],t+=n[i];else{if(8!==n.length)return NSColor.whiteColor();t=n}var r=parseInt(t.slice(0,2),16),a=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16),s=parseInt(t.slice(6,8),16);return NSColor.colorWithSRGBRed_green_blue_alpha(r,a,o,s)}(e);n.setValue_forKey(!1,"drawsBackground"),t.backgroundColor=i},e._invalidate=function(){t.flushWindow(),t.contentView().setNeedsDisplay(!0)},e._setStyleMask=function(n,i){var r=e.isMaximizable();n?t.setStyleMask(t.styleMask()|i):t.setStyleMask(t.styleMask()&~i),e.setMaximizable(r)},e._setCollectionBehavior=function(n,i){var r=e.isMaximizable();n?t.setCollectionBehavior(t.collectionBehavior()|i):t.setCollectionBehavior(t.collectionBehavior()&~i),e.setMaximizable(r)},e._showWindowButton=function(e){var n=t.standardWindowButton(e);n.superview().addSubview_positioned_relative(n,NSWindowAbove,null)}}},function(e,t,n){var i=n(8),r=n(9);e.exports=function(e,t,n){var a=new i;a.loadURL=e.loadURL,a.loadFile=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.downloadURL=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.getURL=function(){return String(n.url())},a.getTitle=function(){return String(n.title())},a.isDestroyed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.focus=e.focus,a.isFocused=e.isFocused,a.isLoading=function(){return!!n.loading()},a.isLoadingMainFrame=function(){return!!n.loading()},a.isWaitingForResponse=function(){return!n.loading()},a.stop=function(){n.stopLoading()},a.reload=function(){n.reload()},a.reloadIgnoringCache=function(){n.reloadFromOrigin()},a.canGoBack=function(){return!!n.canGoBack()},a.canGoForward=function(){return!!n.canGoForward()},a.canGoToOffset=function(e){return!!n.backForwardList().itemAtIndex(e)},a.clearHistory=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.goBack=function(){n.goBack()},a.goForward=function(){n.goForward()},a.goToIndex=function(e){var t=n.backForwardList(),i=t.backList(),r=i.count();if(r>e)n.loadRequest(NSURLRequest.requestWithURL(i[e]));else{var a=t.forwardList();if(!(a.count()>e-r))throw new Error("Cannot go to index "+e);n.loadRequest(NSURLRequest.requestWithURL(a[e-r]))}},a.goToOffset=function(e){if(!a.canGoToOffset(e))throw new Error("Cannot go to offset "+e);n.loadRequest(NSURLRequest.requestWithURL(n.backForwardList().itemAtIndex(e)))},a.isCrashed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.setUserAgent=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.getUserAgent=function(){const e=n.customUserAgent();return e?String(e):void 0},a.insertCSS=function(e){var t="var style = document.createElement('style'); style.innerHTML = "+e.replace(/"/,'\\"')+"; document.head.appendChild(style);",i=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);n.configuration().userContentController().addUserScript(i)},a.insertJS=function(e){var t=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(e,0,!0);n.configuration().userContentController().addUserScript(t)},a.executeJavaScript=r(n,e),a.setIgnoreMenuShortcuts=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.setAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.isAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.setZoomFactor=function(e){n.setMagnification_centeredAtPoint(e,CGPointMake(0,0))},a.getZoomFactor=function(e){e(Number(n.magnification()))},a.setZoomLevel=function(e){a.setZoomFactor(Math.pow(1.2,e))},a.getZoomLevel=function(e){e(Math.log(Number(n.magnification()))/Math.log(1.2))},a.setVisualZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.setLayoutZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},a.send=function(){const e="window.postMessage({isSketchMessage: true,origin: '"+String(__command.identifier())+"',args: "+JSON.stringify([].slice.call(arguments))+'}, "*")';n.evaluateJavaScript_completionHandler(e,null)},a.getNativeWebview=function(){return n},e.webContents=a}},function(e,t){function n(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function r(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void o(t.promise,r)}a(t.promise,i)}else(1===e._state?a:o)(t.promise,e._value)}))):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void c(n.bind(t),e)}e._state=1,e._value=t,s(e)}catch(r){o(e,r)}}function o(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value,e)}));for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e((function(e){n?i._multipleResolvesFn("resolve",t,e):(n=!0,a(t,e))}),(function(e){n?i._multipleResolvesFn("reject",t,e):(n=!0,o(t,e))}))}catch(r){if(n)return void i._multipleResolvesFn("reject",t,r);n=!0,o(t,r)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var i=new this.constructor(n);return r(this,new l(e,t,i)),i},i.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},i.all=function(e){return new i((function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var r=i.length;function a(e,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if("function"==typeof s)return void s.call(o,(function(t){a(e,t)}),n)}i[e]=o,0==--r&&t(i)}catch(l){n(l)}}for(var o=0;o<i.length;o++)a(o,i[o])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,a=e.length;r<a;r++)i.resolve(e[r]).then(t,n)}))},i._immediateFn=setImmediate,i._unhandledRejectionFn=function(e,t){"undefined"!=typeof process&&process.listenerCount&&(process.listenerCount("unhandledRejection")||process.listenerCount("uncaughtException"))?(process.emit("unhandledRejection",e,t),process.emit("uncaughtException",e,"unhandledRejection")):"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._multipleResolvesFn=function(e,t,n){"undefined"!=typeof process&&process.emit&&process.emit("multipleResolves",e,t,n)},e.exports=i},function(e,t){function n(e,t,n,i){n.addConstraint(NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(t,e,NSLayoutRelationEqual,n,e,1,i))}e.exports=function(e,t,i){i=i||[],e.setTranslatesAutoresizingMaskIntoConstraints(!1),n(NSLayoutAttributeLeft,e,t,i[0]||0),n(NSLayoutAttributeTop,e,t,i[1]||0),n(NSLayoutAttributeRight,e,t,i[2]||0),n(NSLayoutAttributeBottom,e,t,i[3]||0)}},function(e,t){e.exports=function(e,t){var n=e.convertPoint_fromView(t.locationInWindow(),null);return"var el = document.elementFromPoint("+n.x+", "+n.y+'); if (el && ["text", "textarea", "date", "datetime-local", "email", "number", "month", "password", "search", "tel", "time", "url", "week" ].indexOf(el.type) >= 0 && el.focus) {el.focus();} else if (el) {el.dispatchEvent(new Event("click", {bubbles: true}))}'}},function(e,t,n){var i=n(5);e.exports=function(e){var t="window.originalPostMessage = window.postMessage;window.postMessage = function(actionName) {if (!actionName) {throw new Error('missing action name')}window.webkit.messageHandlers."+i.JS_BRIDGE+".postMessage(JSON.stringify([].slice.call(arguments)));}",n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}},function(e,t,n){var i=n(5);e.exports.injectScript=function(e){var t='(function () {document.addEventListener(\'mousedown\', onMouseDown);function shouldDrag(target) {  if (!target || (target.dataset || {}).appRegion === "no-drag") { return false }  if ((target.dataset || {}).appRegion === "drag") { return true }  return shouldDrag(target.parentElement)};function onMouseDown(e) {console.log(e);  if (e.button !== 0 || !shouldDrag(e.target)) { return }  window.postMessage("'+i.START_MOVING_WINDOW+'");};})()',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)},e.exports.setupHandler=function(e){var t=null,n=null,r=null;function a(){if(!n||1!==NSEvent.pressedMouseButtons())return clearInterval(r),t=null,void(n=null);var i=NSEvent.mouseLocation();e.setPosition(n.x+(i.x-t.x),n.y+(t.y-i.y),!1)}e.webContents.on(i.START_MOVING_WINDOW,(function(){t=NSEvent.mouseLocation();var i=e.getPosition();n={x:i[0],y:i[1]},r=setInterval(a,1e3/60)}))}},function(e,t,n){var i,r,a,o=n(20),s=n(21),l=n(5);e.exports=function(e,t,n,c){i||(i=new o({utils:null,panel:null,"windowDidResize:":function(){this.utils.emit("resize")},"windowDidMiniaturize:":function(){this.utils.emit("minimize")},"windowDidDeminiaturize:":function(){this.utils.emit("restore")},"windowDidEnterFullScreen:":function(){this.utils.emit("enter-full-screen")},"windowDidExitFullScreen:":function(){this.utils.emit("leave-full-screen")},"windowDidMove:":function(){this.utils.emit("move"),this.utils.emit("moved")},"windowShouldClose:":function(){var e=1;return this.utils.emit("close",{get defaultPrevented(){return!e},preventDefault:function(){e=0}}),e},"windowWillClose:":function(){this.utils.emit("closed")},"windowDidBecomeKey:":function(){this.utils.emit("focus",this.panel.currentEvent())},"windowDidResignKey:":function(){this.utils.emit("blur")}})),r||(r=new o({state:{wasReady:0},utils:null,"webView:didCommitNavigation:":function(e){this.utils.emit("will-navigate",{},String(String(e.URL())))},"webView:didStartProvisionalNavigation:":function(){this.utils.emit("did-start-navigation"),this.utils.emit("did-start-loading")},"webView:didReceiveServerRedirectForProvisionalNavigation:":function(){this.utils.emit("did-get-redirect-request")},"webView:didFailProvisionalNavigation:withError:":function(e,t,n){this.utils.emit("did-fail-load",n)},"webView:didFinishNavigation:":function(){0==this.state.wasReady&&(this.state.wasReady=1,this.utils.emitBrowserEvent("ready-to-show")),this.utils.emit("did-navigate"),this.utils.emit("did-frame-navigate"),this.utils.emit("did-stop-loading"),this.utils.emit("did-finish-load"),this.utils.emit("did-frame-finish-load")},"webViewWebContentProcessDidTerminate:":function(){this.utils.emit("dom-ready")}})),a||(a=new o({utils:null,"userContentController:didReceiveScriptMessage:":function(e,t){var n=this.utils.parseWebArguments(String(t.body()));n&&n[0]&&"string"==typeof n[0]&&(n[0]=String(n[0]),this.utils.emit.apply(this,n))}}));var u=r.new({utils:{setTitle:e.setTitle.bind(e),emitBrowserEvent(){try{e.emit.apply(e,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}},emit(){try{e.webContents.emit.apply(e.webContents,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}}},state:{wasReady:0}});n.setNavigationDelegate(u);var d=a.new({utils:{emit(){try{e.webContents.emit.apply(e.webContents,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}},parseWebArguments:s}});n.configuration().userContentController().addScriptMessageHandler_name(d,l.JS_BRIDGE);var h,g={emit(){try{e.emit.apply(e,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}}};c.modal&&((h="Document"===c.parent.type?c.parent.sketchObject:c.parent)&&"MSDocumentData"===String(h.class())&&(h=h.delegate()),g.parentWindow=h.windowForSheet());var m=i.new({utils:g,panel:t});t.setDelegate(m)}},function(module,exports){module.exports=function MochaDelegate(definition,superclass){var uniqueClassName="MochaJSDelegate_DynamicClass_"+NSUUID.UUID().UUIDString(),delegateClassDesc=MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName,superclass||NSObject),handlers={},ivars={};function setHandlerForSelector(selectorString,func){var handlerHasBeenSet=selectorString in handlers,selector=NSSelectorFromString(selectorString);if(handlers[selectorString]=func,!handlerHasBeenSet){for(var args=[],regex=/:/g;regex.exec(selectorString);)args.push("arg"+args.length);var dynamicFunction=eval("(function ("+args.join(", ")+") { return handlers[selectorString].apply(this, arguments); })");delegateClassDesc.addInstanceMethodWithSelector_function(selector,dynamicFunction)}}function setIvar(e,t){var n=e in handlers;if(ivars[e]=t,!n){delegateClassDesc.addInstanceVariableWithName_typeEncoding(e,"@");var i=MOPropertyDescription.new();i.name=e,i.typeEncoding="@",i.weak=!0,i.ivarName=e,delegateClassDesc.addProperty(i)}}this.getClass=function(){return NSClassFromString(uniqueClassName)},this.getClassInstance=function(e){var t=NSClassFromString(uniqueClassName).new();return Object.keys(ivars).forEach((function(e){t[e]=ivars[e]})),Object.keys(e||{}).forEach((function(n){t[n]=e[n]})),t},this.new=this.getClassInstance,"object"==typeof definition&&Object.keys(definition).forEach((function(e){"function"==typeof definition[e]?setHandlerForSelector(e,definition[e]):setIvar(e,definition[e])})),delegateClassDesc.registerClass()}},function(e,t){e.exports=function(e){var t=null;try{t=JSON.parse(e)}catch(n){}return t&&t.constructor&&t.constructor===Array&&0!=t.length?t:null}},function(e,t,n){"use strict";var i=n(23),r=n(24),a=n(25);function o(){}o.prototype.getDeltaE76=function(e,t){return new i(e,t).getDeltaE()},o.prototype.getDeltaE94=function(e,t){return new r(e,t).getDeltaE()},o.prototype.getDeltaE00=function(e,t){return new a(e,t).getDeltaE()},e.exports=new o},function(e,t,n){"use strict";function i(e,t){this.x1=e,this.x2=t}i.prototype.getDeltaE=function(){var e=this.x1,t=this.x2;return Math.sqrt(Math.pow(t.L-e.L,2)+Math.pow(t.A-e.A,2)+Math.pow(t.B-e.B,2))},e.exports=i},function(e,t,n){"use strict";function i(e,t,n){this.x1=e,this.x2=t,this.weights=n||{},this.weights.lightness=this.weights.lightness||1,this.weights.chroma=this.weights.chroma||1,this.weights.hue=this.weights.hue||1,1===this.weights.lightness?(this.weights.K1=.045,this.weights.K2=.015):(this.weights.K1=.048,this.weights.K2=.014)}i.prototype.getDeltaE=function(){var e=this.x1,t=this.x2,n=Math.sqrt,i=Math.pow;return n(i(this.calculateL(e,t),2)+i(this.calculateA(e,t),2)+i(this.calculateB(e,t),2))},i.prototype.calculateL=function(e,t){return(e.L-t.L)/this.weights.lightness},i.prototype.calculateA=function(e,t){var n=Math.sqrt,i=Math.pow,r=n(i(e.A,2)+i(e.B,2)),a=r-n(i(t.A,2)+i(t.B,2)),o=1+this.weights.K1*r;return a/(this.weights.chroma*o)},i.prototype.calculateB=function(e,t){var n=Math.sqrt,i=Math.pow,r=(l=n(i(e.A,2)+i(e.B,2)))-n(i(t.A,2)+i(t.B,2)),a=e.A-t.A,o=e.B-t.B,s=n(i(a,2)+i(o,2)-i(r,2)),l=n(i(e.A,2)+i(e.B,2));return s/(1+this.weights.K2*l)},e.exports=i},function(e,t,n){"use strict";function i(e,t,n){var i=Math.sqrt,r=Math.pow;this.x1=e,this.x2=t,this.weights=n||{},this.ksubL=this.weights.lightness||1,this.ksubC=this.weights.chroma||1,this.ksubH=this.weights.hue||1,this.deltaLPrime=t.L-e.L,this.LBar=(e.L+t.L)/2,this.C1=i(r(e.A,2)+r(e.B,2)),this.C2=i(r(t.A,2)+r(t.B,2)),this.CBar=(this.C1+this.C2)/2,this.aPrime1=e.A+e.A/2*(1-i(r(this.CBar,7)/(r(this.CBar,7)+r(25,7)))),this.aPrime2=t.A+t.A/2*(1-i(r(this.CBar,7)/(r(this.CBar,7)+r(25,7)))),this.CPrime1=i(r(this.aPrime1,2)+r(e.B,2)),this.CPrime2=i(r(this.aPrime2,2)+r(t.B,2)),this.CBarPrime=(this.CPrime1+this.CPrime2)/2,this.deltaCPrime=this.CPrime2-this.CPrime1,this.SsubL=1+.015*r(this.LBar-50,2)/i(20+r(this.LBar-50,2)),this.SsubC=1+.045*this.CBarPrime,this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0}i.prototype.getDeltaE=function(){var e=Math.sqrt,t=Math.sin,n=Math.pow;this.hPrime1=this.gethPrime1(),this.hPrime2=this.gethPrime2(),this.deltahPrime=this.getDeltahPrime(),this.deltaHPrime=2*e(this.CPrime1*this.CPrime2)*t(this.degreesToRadians(this.deltahPrime)/2),this.HBarPrime=this.getHBarPrime(),this.T=this.getT(),this.SsubH=1+.015*this.CBarPrime*this.T,this.RsubT=this.getRsubT();var i=this.deltaLPrime/(this.ksubL*this.SsubL),r=this.deltaCPrime/(this.ksubC*this.SsubC),a=this.deltaHPrime/(this.ksubH*this.SsubH);return e(n(i,2)+n(r,2)+n(a,2)+this.RsubT*r*a)},i.prototype.getRsubT=function(){var e=Math.sin,t=Math.sqrt,n=Math.pow,i=Math.exp;return-2*t(n(this.CBarPrime,7)/(n(this.CBarPrime,7)+n(25,7)))*e(this.degreesToRadians(60*i(-n((this.HBarPrime-275)/25,2))))},i.prototype.getT=function(){var e=Math.cos;return 1-.17*e(this.degreesToRadians(this.HBarPrime-30))+.24*e(this.degreesToRadians(2*this.HBarPrime))+.32*e(this.degreesToRadians(3*this.HBarPrime+6))-.2*e(this.degreesToRadians(4*this.HBarPrime-63))},i.prototype.getHBarPrime=function(){return(0,Math.abs)(this.hPrime1-this.hPrime2)>180?(this.hPrime1+this.hPrime2+360)/2:(this.hPrime1+this.hPrime2)/2},i.prototype.getDeltahPrime=function(){var e=Math.abs;return 0===this.C1||0===this.C2?0:e(this.hPrime1-this.hPrime2)<=180?this.hPrime2-this.hPrime1:this.hPrime2<=this.hPrime1?this.hPrime2-this.hPrime1+360:this.hPrime2-this.hPrime1-360},i.prototype.gethPrime1=function(){return this._gethPrimeFn(this.x1.B,this.aPrime1)},i.prototype.gethPrime2=function(){return this._gethPrimeFn(this.x2.B,this.aPrime2)},i.prototype._gethPrimeFn=function(e,t){var n;return 0===e&&0===t?0:(n=this.radiansToDegrees(Math.atan2(e,t)))>=0?n:n+360},i.prototype.radiansToDegrees=function(e){return e*(180/Math.PI)},i.prototype.degreesToRadians=function(e){return e*(Math.PI/180)},e.exports=i},function(e,t,n){var i=n(27).Buffer,r=n(28),a=r.parseStat,o=r.fsError,s=r.fsErrorForPath,l=r.encodingFromOptions,c=r.NOT_IMPLEMENTED;e.exports.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1},e.exports.access=c("access"),e.exports.accessSync=function(t,n){n|=0;var i=NSFileManager.defaultManager();switch(n){case 0:canAccess=e.exports.existsSync(t);break;case 1:canAccess=Boolean(Number(i.isExecutableFileAtPath(t)));break;case 2:canAccess=Boolean(Number(i.isWritableFileAtPath(t)));break;case 3:canAccess=Boolean(Number(i.isExecutableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)));break;case 4:canAccess=Boolean(Number(i.isReadableFileAtPath(t)));break;case 5:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isExecutableFileAtPath(t)));break;case 6:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)));break;case 7:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)))&&Boolean(Number(i.isExecutableFileAtPath(t)))}if(!canAccess)throw new Error("Can't access "+String(t))},e.exports.appendFile=c("appendFile"),e.exports.appendFileSync=function(t,n,r){if(!e.exports.existsSync(t))return e.exports.writeFileSync(t,n,r);var a=NSFileHandle.fileHandleForWritingAtPath(t);a.seekToEndOfFile();var o=l(r,"utf8"),s=i.from(n,"NSData"===o||"buffer"===o?void 0:o).toNSData();a.writeData(s)},e.exports.chmod=c("chmod"),e.exports.chmodSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFilePosixPermissions:t},e,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.chown=c("chown"),e.exports.chownSync=c("chownSync"),e.exports.close=c("close"),e.exports.closeSync=c("closeSync"),e.exports.copyFile=c("copyFile"),e.exports.copyFileSync=function(e,t,n){var i=MOPointer.alloc().init();if(NSFileManager.defaultManager().copyItemAtPath_toPath_error(e,t,i),null!==i.value())throw s(e,!1,i.value())},e.exports.createReadStream=c("createReadStream"),e.exports.createWriteStream=c("createWriteStream"),e.exports.exists=c("exists"),e.exports.existsSync=function(e){var t=NSFileManager.defaultManager();return Boolean(Number(t.fileExistsAtPath(e)))},e.exports.fchmod=c("fchmod"),e.exports.fchmodSync=c("fchmodSync"),e.exports.fchown=c("fchown"),e.exports.fchownSync=c("fchownSync"),e.exports.fdatasync=c("fdatasync"),e.exports.fdatasyncSync=c("fdatasyncSync"),e.exports.fstat=c("fstat"),e.exports.fstatSync=c("fstatSync"),e.exports.fsync=c("fsync"),e.exports.fsyncSync=c("fsyncSync"),e.exports.ftruncate=c("ftruncate"),e.exports.ftruncateSync=c("ftruncateSync"),e.exports.futimes=c("futimes"),e.exports.futimesSync=c("futimesSync"),e.exports.lchmod=c("lchmod"),e.exports.lchmodSync=c("lchmodSync"),e.exports.lchown=c("lchown"),e.exports.lchownSync=c("lchownSync"),e.exports.link=c("link"),e.exports.linkSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().linkItemAtPath_toPath_error(e,t,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.lstat=c("lstat"),e.exports.lstatSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return a(n)},e.exports.mkdir=c("mkdir"),e.exports.mkdirSync=function(e,t){var n=511,i=!1;t&&t.mode&&(n=t.mode),t&&t.recursive&&(i=t.recursive),"number"==typeof t&&(n=t);var r=MOPointer.alloc().init();if(NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,i,{NSFilePosixPermissions:n},r),null!==r.value())throw new Error(r.value())},e.exports.mkdtemp=c("mkdtemp"),e.exports.mkdtempSync=function(t){var n=t+function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<6;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}();return e.exports.mkdirSync(n),n},e.exports.open=c("open"),e.exports.openSync=c("openSync"),e.exports.read=c("read"),e.exports.readdir=c("readdir"),e.exports.readdirSync=function(e,t){for(var n=l(t,"utf8"),r=NSFileManager.defaultManager().subpathsAtPath(e),a=[],o=0;o<r.length;o++){var s=r[o];a.push("buffer"===n?i.from(s):String(s))}return a},e.exports.readFile=c("readFile"),e.exports.readFileSync=function(e,t){var n=l(t,"buffer"),r=NSFileManager.defaultManager().contentsAtPath(e);if(!r)throw s(e,!1);var a=i.from(r);return"buffer"===n?a:"NSData"===n?a.toNSData():a.toString(n)},e.exports.readlink=c("readlink"),e.exports.readlinkSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().destinationOfSymbolicLinkAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return String(n)},e.exports.readSync=c("readSync"),e.exports.realpath=c("realpath"),e.exports.realpath.native=c("realpath.native"),e.exports.realpathSync=function(e){return String(NSString.stringWithString(e).stringByResolvingSymlinksInPath())},e.exports.realpathSync.native=c("realpathSync.native"),e.exports.rename=c("rename"),e.exports.renameSync=function(e,t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();i.moveItemAtPath_toPath_error(e,t,n);var r=n.value();if(null!==r){if("NSCocoaErrorDomain"!==String(r.domain())||516!==Number(r.code()))throw s(e,void 0,r);var a=MOPointer.alloc().init();if(i.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(NSURL.fileURLWithPath(t),NSURL.fileURLWithPath(e),null,NSFileManagerItemReplacementUsingNewMetadataOnly,null,a),null!==a.value())throw s(e,void 0,a.value())}},e.exports.rmdir=c("rmdir"),e.exports.rmdirSync=function(t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();if(!e.exports.lstatSync(t).isDirectory())throw o("ENOTDIR",{path:t,syscall:"rmdir"});if(i.removeItemAtPath_error(t,n),null!==n.value())throw s(t,!0,n.value(),"rmdir")},e.exports.stat=c("stat"),e.exports.statSync=function(t){return e.exports.lstatSync(e.exports.realpathSync(t))},e.exports.symlink=c("symlink"),e.exports.symlinkSync=function(e,t){var n=MOPointer.alloc().init();NSFileManager.defaultManager().createSymbolicLinkAtPath_withDestinationPath_error(t,e,n);if(null!==n.value())throw new Error(n.value())},e.exports.truncate=c("truncate"),e.exports.truncateSync=function(e,t){var n=NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);n.truncateFileAtOffset(t||0),n.closeFile()},e.exports.unlink=c("unlink"),e.exports.unlinkSync=function(t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();if(e.exports.lstatSync(t).isDirectory())throw o("EPERM",{path:t,syscall:"unlink"});i.removeItemAtPath_error(t,n);if(null!==n.value())throw s(t,!1,n.value())},e.exports.unwatchFile=c("unwatchFile"),e.exports.utimes=c("utimes"),e.exports.utimesSync=function(e,t,n){var i=MOPointer.alloc().init();NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFileModificationDate:t},e,i);if(null!==i.value())throw s(e,void 0,i.value())},e.exports.watch=c("watch"),e.exports.watchFile=c("watchFile"),e.exports.write=c("write"),e.exports.writeFile=c("writeFile"),e.exports.writeFileSync=function(e,t,n){var r=l(n,"utf8");i.from(t,"NSData"===r||"buffer"===r?void 0:r).toNSData().writeToFile_atomically(e,!0)},e.exports.writeSync=c("writeSync")},function(e,t){e.exports=require("buffer")},function(e,t){e.exports.parseStat=function(e){return{dev:String(e.NSFileDeviceIdentifier),mode:e.NSFileType|e.NSFilePosixPermissions,nlink:Number(e.NSFileReferenceCount),uid:String(e.NSFileOwnerAccountID),gid:String(e.NSFileGroupOwnerAccountID),size:Number(e.NSFileSize),atimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),mtimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),ctimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),birthtimeMs:1e3*Number(e.NSFileCreationDate.timeIntervalSince1970()),atime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),mtime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),ctime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),birthtime:new Date(1e3*Number(e.NSFileCreationDate.timeIntervalSince1970())+.5),isBlockDevice:function(){return e.NSFileType===NSFileTypeBlockSpecial},isCharacterDevice:function(){return e.NSFileType===NSFileTypeCharacterSpecial},isDirectory:function(){return e.NSFileType===NSFileTypeDirectory},isFIFO:function(){return!1},isFile:function(){return e.NSFileType===NSFileTypeRegular},isSocket:function(){return e.NSFileType===NSFileTypeSocket},isSymbolicLink:function(){return e.NSFileType===NSFileTypeSymbolicLink}}};var n={EPERM:{message:"operation not permitted",errno:-1},ENOENT:{message:"no such file or directory",errno:-2},EACCES:{message:"permission denied",errno:-13},ENOTDIR:{message:"not a directory",errno:-20},EISDIR:{message:"illegal operation on a directory",errno:-21}};function i(e,t){var i=new Error(e+": "+n[e].message+", "+(t.syscall||"")+(t.path?" '"+t.path+"'":""));return Object.keys(t).forEach((function(e){i[e]=t[e]})),i.code=e,i.errno=n[e].errno,i}e.exports.fsError=i,e.exports.fsErrorForPath=function(t,n,r,a){var o=NSFileManager.defaultManager();if(!o.fileExistsAtPath(t))return i("ENOENT",{path:t,syscall:a||"open"});if(!o.isReadableFileAtPath(t))return i("EACCES",{path:t,syscall:a||"open"});if(void 0!==n){var s=e.exports.lstatSync(t).isDirectory();if(s&&!n)return i("EISDIR",{path:t,syscall:a||"read"});if(!s&&n)return i("ENOTDIR",{path:t,syscall:a||"read"})}return new Error(r||"Unknown error while manipulating "+t)},e.exports.encodingFromOptions=function(e,t){return e&&e.encoding?String(e.encoding):e?String(e):t},e.exports.NOT_IMPLEMENTED=function(e){return function(){throw new Error("fs."+e+" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs")}}},function(e,t,n){var i=n(30),r=null;(r=NSUserDefaults.standardUserDefaults().objectForKey("google.analytics.uuid"))||(r=NSUUID.UUID().UUIDString(),NSUserDefaults.standardUserDefaults().setObject_forKey(r,"google.analytics.uuid"));var a=MSApplicationMetadata.metadata().variant,o="Sketch "+("NONAPPSTORE"==a?"":a+" ")+i.version.sketch;e.exports=function(e,t,n,a){if(!i.globalSettingForKey("analyticsEnabled"))return"the user didn't enable sharing analytics";var s,l={v:1,tid:e,ds:o,cid:r,t:t};return"undefined"!=typeof __command&&(l.an=__command.pluginBundle().name(),l.aid=__command.pluginBundle().identifier(),l.av=__command.pluginBundle().version()),n&&Object.keys(n).forEach((function(e){l[e]=n[e]})),function(e,t){if(e){if(t&&t.makeRequest)return t.makeRequest(e);if(t&&t.debug){var n=NSURLRequest.requestWithURL(e),i=MOPointer.alloc().init(),r=MOPointer.alloc().init(),a=NSURLConnection.sendSynchronousRequest_returningResponse_error(n,i,r);return a?NSString.alloc().initWithData_encoding(a,NSUTF8StringEncoding):r.value()}NSURLSession.sharedSession().dataTaskWithURL(e).resume()}}(NSURL.URLWithString("https://www.google-analytics.com/"+(a&&a.debug?"debug/":"")+"collect?"+(s=l,Object.keys(s).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(s[e])})).join("&")+"&z=")+NSUUID.UUID().UUIDString()),a)}},function(e,t){e.exports=require("sketch/settings")},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/47cdb1610e2062b8a0d6793161d90411.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/2285a874c5222f39f5109f3a3eb4e785.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"MergeDuplicateLayerStyles",(function(){return c})),n.d(t,"MergeSelectedLayerStyles",(function(){return u})),n.d(t,"MergeSimilarLayerStyles",(function(){return d}));var i=n(0),r=n.n(i),a=(n(2),n(4)),o=n(3),s="merge-duplicatelayerstyles.webview";function l(e,t,n,i,r){o.clog("-- Starting Merge Layer Styles ("+e.length+"). Style to keep is:"+t);var a,s=[],l=0,c=0,u=0,d=new Map;(o.clog("---- Processing styles to remove"),a=e[t].layerStyle,e[t].isForeign)&&(o.document.sharedLayerStyles.filter((function(n){return n.id==e[t].layerStyle.id})).length>0||(a=o.importLayerStyleFromLibrary(e[t])));var h,g=0,m=n,f=0,y=0,p=new Map;o.clog("---- Getting all related styles instances and overrides");for(var S=0;S<e.length;S++)if(S!=t){d.set(e[S].layerStyle.id),s.push(e[S].layerStyle);var b=o.getLayerStyleInstances(e[S].layerStyle),v=o.getLayerStyleOverrides(e[S].layerStyle,d);p.set(e[S],{instancesOfStyle:b,styleOverrides:v}),f+=b.length,y+=v.length}h=f+y,o.ctime("Merging layer style:"+e[t].name),r.executeJavaScript("ShowMergeProgress()").catch(console.error);for(S=0;S<e.length;S++)if(S!=t){e[S].isForeign||u++,o.ctime("-- Taking instances and overrides");b=p.get(e[S]).instancesOfStyle,v=p.get(e[S]).styleOverrides;o.ctimeEnd("-- Taking instances and overrides"),o.ctime("-- Unlinking from library"),o.clog("------ Checking if symbol to merge is foreign"),e[S].isForeign&&e[S].layerStyle.unlinkFromLibrary(),o.ctimeEnd("-- Unlinking from library");var w="Merging "+e[t].name;o.ctime("-- Updating overrides"),o.clog("---- Updating overrides ("+v.length+")"),v.forEach((function(e){try{o.clog("------ Updating override for "+e.instance.name),e.instance.setOverrideValue(e.override,a.id.toString()),c++,g++,m=Math.floor(n+100*g/h/i);var t="Updating overrides ("+c+" of "+y+")";r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),", ").concat(JSON.stringify(t),")")).catch(console.error)}catch(s){o.clog("---- ERROR: Couldn't update override for "+e.instance.name),o.clog(s)}})),o.ctimeEnd("-- Updating overrides"),o.ctime("-- Updating instances"),o.clog("---- Updating instances ("+b.length+")"),b.forEach((function(e){try{o.clog("------ Updating instance "+e.name+", in artboard "+e.getParentArtboard().name)}catch(s){o.clog("------ Updating instance "+e.name+". Instance doesn't belong to any specific artboard.")}e.sharedStyle=a,e.style.syncWithSharedStyle(a),g++,l++,m=Math.floor(n+100*g/h/i);var t="Updating instances ("+l+" of "+f+")";r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),", ").concat(JSON.stringify(t),")")).catch(console.error)})),o.ctimeEnd("-- Updating instances")}o.ctimeEnd("Merging layer style:"+e[t].name),o.clog("---- Finalized instance and override replacement.");var x=o.document.sharedLayerStyles.filter((function(e){return function(e,t){var n=e.style.id,i=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null;return t.filter((function(t){return t.id==e.id||t.id==n||t.id==i})).length>0}(e,s)}));return o.clog("---- Removing discarded layer styles ("+x.length+")."),r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),', "Removing discarded layer styles")')).catch(console.error),o.ctime("Removing discarded styles"),x.forEach((function(e){o.clog("------ Removing "+e.name+" ("+e.id+") from sharedLayerStyles."),e.unlinkFromLibrary(),o.clog("-------- Unlinked from library.");var t=o.document.sharedLayerStyles.findIndex((function(t){return t.id==e.id}));o.clog("-------- Located in sharedLayerStyles ("+t+")."),o.document.sharedLayerStyles.splice(t,1),o.clog("-------- Removed from sharedLayerStyles.")})),o.ctimeEnd("Removing discarded styles"),o.clog("---- Merge completed."),[u,l,c]}function c(e){o.clog("----- Merge duplicate layer styles -----");var t,i,c={identifier:s,width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},u=new r.a(c),d=u.webContents,h=[],g=new Map;function m(n){o.clog("Finding duplicate layer styles. Including libraries:"+n),t=o.getAllDuplicateLayerStylesByName(e,n),i=o.getLayerStylesMap(e,t),t.length>0&&(o.GetSpecificLayerStyleData(t[0],i),h=[],t.forEach((function(e){var t=o.getReducedLayerStyleData(e);g.set(t,e),h.push({layerStyleWithDuplicates:t,selectedIndex:-1,isUnchecked:!1,isProcessed:0==h.length})})))}m(o.getLibrariesEnabled()),t.length>0?u.loadURL(n(34)):(a.message("Looks like there are no layer styles with the same name."),onShutdown(s)),u.once("ready-to-show",(function(){u.show()})),d.on("did-finish-load",(function(){o.clog("Webview loaded"),d.executeJavaScript("DrawStylesList(".concat(JSON.stringify(h),", ").concat(o.getLibrariesEnabled(),")")).catch(console.error)})),d.on("nativeLog",(function(e){o.clog(e)})),d.on("Cancel",(function(){onShutdown(s)})),d.on("RecalculateDuplicates",(function(e){o.clog("Recalculating duplicates"),m(e),d.executeJavaScript("DrawStylesList(".concat(JSON.stringify(h),")")).catch(console.error)})),d.on("GetSelectedStyleData",(function(e){o.GetSpecificLayerStyleData(t[e],i);var n=JSON.stringify(o.getReducedLayerStyleData(t[e]));d.executeJavaScript("ReDrawAfterGettingData(".concat(n,",").concat(e,")")).catch(console.error)})),d.on("ExecuteMerge",(function(e){o.clog("Executing Merge");for(var t=0,n=[0,0,0],i=e.filter((function(e){return!e.isUnchecked&&e.selectedIndex>=0})).length,r=0;r<e.length;r++)if(!e[r].isUnchecked&&e[r].selectedIndex>=0){o.clog("-- Merging "+h[r].layerStyleWithDuplicates.name),h[r].selectedIndex=e[r].selectedIndex;var c=g.get(h[r].layerStyleWithDuplicates),u=100*t/e.length,m=l(c.duplicates,h[r].selectedIndex,u,i,d);n[0]+=m[0],n[1]+=m[1],n[2]+=m[2],t++}if(onShutdown(s),n[0]<=0)o.clog("No styles were merged"),a.message("No styles were merged");else{var f="";f=n[1]>0&&n[2]?", replaced "+n[1]+" instances, and updated "+n[2]+" overrides.":n[1]>0?" and replaced "+n[1]+" instances.":n[2]>0?" and updated "+n[2]+" overrides.":".",o.clog("Completed merge. Removed "+n[0]+" layer styles"+f),a.message("Hey ho! You just removed "+n[0]+" layer styles"+f+" Amazing!")}}))}function u(e){o.clog("----- Merge selected text styles -----");var t,i,s={identifier:"merge-layerstylesfromlist.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},c=new r.a(s),u=c.webContents;o.clog("Get layer styles list. Libraries included:"+o.getLibrariesEnabled()),i=(t=o.getAllLayerStyles(o.getLibrariesEnabled())).length,o.getLibrariesEnabled(),o.clog("allLayerStyles:"+t.length),i>1?c.loadURL(n(35)):(1==i?a.message("There's only 1 layer style. No need to merge."):a.message("Looks like there are no layer styles."),onShutdown("merge-layerstylesfromlist.webview")),c.once("ready-to-show",(function(){c.show()})),u.on("did-finish-load",(function(){o.clog("Webview loaded"),u.executeJavaScript("DrawStyleList(".concat(JSON.stringify(t),",").concat(o.getLibrariesEnabled(),")")).catch(console.error)})),u.on("nativeLog",(function(e){o.clog(e)})),u.on("GetStylesList",(function(e){o.clog("Get styles list"),t=o.getAllLayerStyles(e),e,u.executeJavaScript("DrawStyleList(".concat(JSON.stringify(t),")")).catch(console.error)})),u.on("Cancel",(function(){onShutdown("merge-layerstylesfromlist.webview")})),u.on("ExecuteMerge",(function(e){o.clog("Executing Merge");for(var n=-1,i=[],r=0;r<t.length;r++)t[r].isSelected=e[r].isSelected,t[r].isChosen=e[r].isChosen,t[r].isSelected&&(t[r].isChosen&&(n=i.length),i.push(t[r]));var s=l(i,n,0,1,u);if(onShutdown("merge-layerstylesfromlist.webview"),s[0]<=0)o.clog("No styles were merged"),a.message("No styles were merged");else{var c="";c=s[1]>0&&s[2]?", replaced "+s[1]+" instances, and updated "+s[2]+" overrides.":s[1]>0?" and replaced "+s[1]+" instances.":s[2]>0?" and updated "+s[2]+" overrides.":".",o.clog("Completed merge. Removed "+s[0]+" layer styles"+c),a.message("Hey ho! You just removed "+s[0]+" layer styles"+c+" Amazing!")}}))}function d(e){o.clog("----- Merge similar layer styles -----");var t,i={identifier:"merge-similarlayerstyles.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},s=new r.a(i),c=s.webContents;o.clog("Loading webview"),s.loadURL(n(36)),s.once("ready-to-show",(function(){s.show()})),c.on("did-finish-load",(function(){o.clog("Webview loaded"),c.executeJavaScript("UpdateSettings(".concat(o.getLibrariesEnabled(),")")).catch(console.error)})),c.on("nativeLog",(function(e){o.clog(e)})),c.on("Cancel",(function(){onShutdown("merge-similarlayerstyles.webview")})),c.on("ExecuteMerge",(function(e){o.clog("Execute merge");for(var n=0,i=[0,0,0],r=e.filter((function(e){return!e.isUnchecked&&e.selectedIndex>=0})).length,s=0;s<e.length;s++)if(!e[s].isUnchecked&&e[s].selectedIndex>=0){var u=100*n/e.length,d=l(t[s].similarStyles,e[s].selectedIndex,u,r,c);i[0]+=d[0],i[1]+=d[1],i[2]+=d[2],n++}if(onShutdown("merge-similarlayerstyles.webview"),i[0]<=0)o.clog("No styles were merged"),a.message("No styles were merged");else{var h="";h=i[1]>0&&i[2]?", replaced "+i[1]+" instances, and updated "+i[2]+" overrides.":i[1]>0?" and replaced "+i[1]+" instances.":i[2]>0?" and updated "+i[2]+" overrides.":".",o.clog("Completed merge. Removed "+i[0]+" layer styles"+h),a.message("Hey ho! You just removed "+i[0]+" layer styles"+h+" Amazing!")}})),c.on("RecalculateStyles",(function(n,i,r,a,s,l){o.clog("RecalculateStyles"),t=o.FindAllSimilarLayerStyles(e,n,i,r,a,s,l),c.executeJavaScript("DrawResultsList(".concat(JSON.stringify(t),")")).catch(console.error)}))}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/f3e074f5fed7f21c576004882d96fd73.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/0ff6f8d9c1f854554c9c5548fdc39fd3.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/32538aa661ea8cecc1a1d76e8eb54974.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"MergeDuplicateTextStyles",(function(){return l})),n.d(t,"MergeSelectedTextStyles",(function(){return c})),n.d(t,"MergeSimilarTextStyles",(function(){return u}));var i=n(0),r=n.n(i),a=(n(2),n(3)),o=n(4);function s(e,t,n,i,r){a.clog("-- Starting Merge Layer Styles ("+e.length+"). Style to keep is:"+t);var o,s=[],l=0,c=0,u=0,d=new Map;(a.clog("---- Processing styles to remove"),o=e[t].textStyle,e[t].isForeign)&&(a.document.sharedTextStyles.filter((function(n){return n.id==e[t].textStyle.id})).length>0||(o=a.importTextStyleFromLibrary(e[t])));var h,g=0,m=n,f=0,y=0,p=new Map;a.clog("---- Getting all related styles instances and overrides");for(var S=0;S<e.length;S++)if(S!=t){d.set(e[S].textStyle.id),s.push(e[S].textStyle);var b=a.getTextStyleInstances(e[S].textStyle),v=a.getTextStyleOverrides(e[S].textStyle,d);p.set(e[S],{instancesOfStyle:b,styleOverrides:v}),f+=b.length,y+=v.length}h=f+y,a.ctime("Merging text style:"+e[t].name),r.executeJavaScript("ShowMergeProgress()").catch(console.error);for(S=0;S<e.length;S++)if(S!=t){e[S].isForeign||u++,a.ctime("-- Taking instances and overrides");b=p.get(e[S]).instancesOfStyle,v=p.get(e[S]).styleOverrides;a.ctimeEnd("-- Taking instances and overrides"),a.ctime("-- Unlinking from library"),a.clog("------ Checking if symbol to merge is foreign"),e[S].isForeign&&e[S].textStyle.unlinkFromLibrary(),a.ctimeEnd("-- Unlinking from library");var w="Merging "+e[t].name;a.ctime("-- Updating overrides"),a.clog("---- Updating overrides ("+v.length+")"),v.forEach((function(e){try{a.clog("------ Updating override for "+e.instance.name),e.instance.setOverrideValue(e.override,o.id.toString()),c++,g++,m=Math.floor(n+100*g/h/i);var t="Updating overrides ("+c+" of "+y+")";r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),", ").concat(JSON.stringify(t),")")).catch(console.error)}catch(s){a.clog("---- ERROR: Couldn't update override for "+e.instance.name),a.clog(s)}})),a.ctimeEnd("-- Updating overrides"),a.ctime("-- Updating instances"),a.clog("---- Updating instances ("+b.length+")"),b.forEach((function(e){try{a.clog("------ Updating instance "+e.name+", in artboard "+e.getParentArtboard().name)}catch(s){a.clog("------ Updating instance "+e.name+". Instance doesn't belong to any specific artboard.")}e.sharedStyle=o,e.style.syncWithSharedStyle(o),g++,l++,m=Math.floor(n+100*g/h/i);var t="Updating instances ("+l+" of "+f+")";r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),", ").concat(JSON.stringify(t),")")).catch(console.error)})),a.ctimeEnd("-- Updating instances")}a.ctimeEnd("Merging text style:"+e[t].name),a.clog("---- Finalized instance and override replacement.");var x=a.document.sharedTextStyles.filter((function(e){return function(e,t){var n=e.style.id,i=e.id.indexOf("[")>=0?e.id.substring(e.id.indexOf("[")+1,e.id.length-1):null;return t.filter((function(t){return t.id==e.id||t.id==n||t.id==i})).length>0}(e,s)}));return a.clog("---- Removing discarded text styles ("+x.length+")."),r.executeJavaScript("UpdateMergeProgress(".concat(m,", ").concat(JSON.stringify(w),', "Removing discarded text styles")')).catch(console.error),a.ctime("Removing discarded styles"),x.forEach((function(e){a.clog("------ Removing "+e.name+" ("+e.id+") from sharedTextStyles."),e.unlinkFromLibrary(),a.clog("-------- Unlinked from library.");var t=a.document.sharedTextStyles.findIndex((function(t){return t.id==e.id}));a.clog("-------- Located in sharedTextStyles ("+t+")."),a.document.sharedTextStyles.splice(t,1),a.clog("-------- Removed from sharedTextStyles.")})),a.ctimeEnd("Removing discarded styles"),a.clog("---- Merge completed."),[u,l,c]}function l(e){a.clog("----- Merge duplicate text styles -----");var t,i,l={identifier:"merge-duplicatetextstyles.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},c=new r.a(l),u=c.webContents,d=[],h=new Map;function g(n){a.clog("Finding duplicate text styles. Including libraries:"+n),t=a.getAllDuplicateTextStylesByName(e,n),i=a.getTextStylesMap(e,t),t.length>0&&(a.GetSpecificTextStyleData(t[0],i),d=[],t.forEach((function(e){var t=a.getReducedTextStyleData(e);h.set(t,e),d.push({textStyleWithDuplicates:t,selectedIndex:-1,isUnchecked:!1,isProcessed:0==d.length})})))}g(a.getLibrariesEnabled()),t.length>0?c.loadURL(n(38)):(o.message("Looks like there are no text styles with the same name."),onShutdown("merge-duplicatetextstyles.webview")),c.once("ready-to-show",(function(){c.show()})),u.on("did-finish-load",(function(){a.clog("Webview loaded"),u.executeJavaScript("DrawStylesList(".concat(JSON.stringify(d),", ").concat(a.getLibrariesEnabled(),")")).catch(console.error)})),u.on("nativeLog",(function(e){a.clog(e)})),u.on("Cancel",(function(){onShutdown("merge-duplicatetextstyles.webview")})),u.on("RecalculateDuplicates",(function(e){a.clog("Recalculating duplicates"),g(e),u.executeJavaScript("DrawStylesList(".concat(JSON.stringify(d),")")).catch(console.error)})),u.on("GetSelectedStyleData",(function(e){a.GetSpecificTextStyleData(t[e],i);var n=JSON.stringify(a.getReducedTextStyleData(t[e]));u.executeJavaScript("ReDrawAfterGettingData(".concat(n,",").concat(e,")")).catch(console.error)})),u.on("ExecuteMerge",(function(e){a.clog("Executing Merge");for(var t=0,n=[0,0,0],i=e.filter((function(e){return!e.isUnchecked&&e.selectedIndex>=0})).length,r=0;r<e.length;r++)if(a.clog("-- Merging "+d[r].textStyleWithDuplicates.name),!e[r].isUnchecked&&e[r].selectedIndex>=0){a.clog("-- Merging "+d[r].textStyleWithDuplicates.name),d[r].selectedIndex=e[r].selectedIndex;var l=h.get(d[r].textStyleWithDuplicates),c=100*t/e.length,g=s(l.duplicates,d[r].selectedIndex,c,i,u);n[0]+=g[0],n[1]+=g[1],n[2]+=g[2],t++}if(onShutdown("merge-duplicatetextstyles.webview"),n[0]<=0)a.clog("No styles were merged"),o.message("No styles were merged");else{var m="";m=n[1]>0&&n[2]?", replaced "+n[1]+" instances, and updated "+n[2]+" overrides.":n[1]>0?" and replaced "+n[1]+" instances.":n[2]>0?" and updated "+n[2]+" overrides.":".",a.clog("Completed merge. Removed "+n[0]+" text styles"+m),o.message("Hey ho! You just removed "+n[0]+" text styles"+m+" Amazing!")}}))}function c(e){a.clog("----- Merge selected text styles -----");var t,i,l={identifier:"merge-textstylesfromlist.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},c=new r.a(l),u=c.webContents;a.clog("Get text styles list. Libraries included:"+a.getLibrariesEnabled()),i=(t=a.getAllTextStyles(a.getLibrariesEnabled())).length,a.getLibrariesEnabled(),a.clog("allTextStyles:"+t.length),i>1?c.loadURL(n(39)):(1==i?o.message("There's only 1 text style. No need to merge."):o.message("Looks like there are no text styles."),onShutdown("merge-textstylesfromlist.webview")),c.once("ready-to-show",(function(){c.show()})),u.on("did-finish-load",(function(){a.clog("Webview loaded"),u.executeJavaScript("DrawStyleList(".concat(JSON.stringify(t),",").concat(a.getLibrariesEnabled(),")")).catch(console.error)})),u.on("nativeLog",(function(e){a.clog(e)})),u.on("GetStylesList",(function(e){a.clog("Get styles list"),t=a.getAllTextStyles(e),e,u.executeJavaScript("DrawStyleList(".concat(JSON.stringify(t),")")).catch(console.error)})),u.on("Cancel",(function(){onShutdown("merge-textstylesfromlist.webview")})),u.on("ExecuteMerge",(function(e){a.clog("Executing Merge");for(var n=-1,i=[],r=0;r<t.length;r++)t[r].isSelected=e[r].isSelected,t[r].isChosen=e[r].isChosen,t[r].isSelected&&(t[r].isChosen&&(n=i.length),i.push(t[r]));var l=s(i,n,0,1,u);if(onShutdown("merge-textstylesfromlist.webview"),l[0]<=0)a.clog("No styles were merged"),o.message("No styles were merged");else{var c="";c=l[1]>0&&l[2]?", replaced "+l[1]+" instances, and updated "+l[2]+" overrides.":l[1]>0?" and replaced "+l[1]+" instances.":l[2]>0?" and updated "+l[2]+" overrides.":".",a.clog("Completed merge. Removed "+l[0]+" text styles"+c),o.message("Hey ho! You just removed "+l[0]+" text styles"+c+" Amazing!")}}))}function u(e){a.clog("----- Merge similar text styles -----");var t,i={identifier:"merge-similartextstyles.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},l=new r.a(i),c=l.webContents;a.clog("Loading webview"),l.loadURL(n(40)),l.once("ready-to-show",(function(){l.show()})),c.on("did-finish-load",(function(){a.clog("Webview loaded"),c.executeJavaScript("UpdateSettings(".concat(a.getLibrariesEnabled(),")")).catch(console.error)})),c.on("nativeLog",(function(e){a.clog(e)})),c.on("Cancel",(function(){onShutdown("merge-similartextstyles.webview")})),c.on("ExecuteMerge",(function(e){a.clog("Execute merge");for(var n=0,i=[0,0,0],r=e.filter((function(e){return!e.isUnchecked&&e.selectedIndex>=0})).length,l=0;l<e.length;l++)if(!e[l].isUnchecked&&e[l].selectedIndex>=0){var u=100*n/e.length,d=s(t[l].similarStyles,e[l].selectedIndex,u,r,c);i[0]+=d[0],i[1]+=d[1],i[2]+=d[2],n++}if(onShutdown("merge-similartextstyles.webview"),i[0]<=0)a.clog("No styles were merged"),o.message("No styles were merged");else{var h="";h=i[1]>0&&i[2]?", replaced "+i[1]+" instances, and updated "+i[2]+" overrides.":i[1]>0?" and replaced "+i[1]+" instances.":i[2]>0?" and updated "+i[2]+" overrides.":".",a.clog("Completed merge. Removed "+i[0]+" text styles"+h),o.message("Hey ho! You just removed "+i[0]+" text styles"+h+" Amazing!")}})),c.on("RecalculateStyles",(function(n,i,r,o,s,l,u,d,h){a.clog("RecalculateStyles"),t=a.FindAllSimilarTextStyles(e,n,i,r,o,s,l,u,d,h),c.executeJavaScript("DrawResultsList(".concat(JSON.stringify(t),")")).catch(console.error)}))}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/67ec0cfb26ada0c359c09e173b228673.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/f105516cb124aea211c34dfa69e84db3.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/cb776087d712914496ececb408a9eabf.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"MergeDuplicateColorVariables",(function(){return g})),n.d(t,"MergeSelectedColorVariables",(function(){return m})),n.d(t,"MergeSimilarColorVariables",(function(){return f}));var i=n(0),r=n.n(i),a=(n(2),n(3),n(6)),o=n(4),s=n(3),l="merge-duplicatecolorvariables.webview",c="merge-colorvariablesfromlist.webview",u=!1,d=[];function h(e,t){var n,i,r=d[t],o=r.colorVariable,l=[];(s.clog("Merging color variables. Keep '"+r.name+"'"),r.isForeign)&&(s.document.swatches.filter((function(e){return e.id==r.colorVariable.id})).length<=0?(s.clog("Importing color variable from library "+r.libraryName),o=s.importColorVariableFromLibrary(r)):s.clog("Color variable not imported (as it's already in document)"));for(var c=0;c<d.length;c++)c!=t&&l.push(d[c].colorVariable);return n=function(e,t){var n=a.find("*"),i=new Map;return n.forEach((function(n){n.style.fills.concat(n.style.borders).filter((function(e){return"Color"==e.fillType})).forEach((function(r){t.forEach((function(t){r.color==t.color&&(r.color=e.referencingColor,i.has(n)||i.set(n,!0))}))})),n.style.textColor&&t.forEach((function(t){n.style.textColor==t.color&&(n.style.textColor=e.referencingColor)}))})),s.clog("Affected layers "+i.size),i.size}(o,l),i=function(e,t){var n=[],i=new Map,r=new Map;return s.document.sharedLayerStyles.forEach((function(r){r.getAllInstances().forEach((function(e){e.isOutOfSyncWithSharedStyle(r)||n.push({instance:e,style:r})})),r.style.fills.concat(r.style.borders).forEach((function(n){"Color"==n.fillType&&t.forEach((function(t){n.color==t.color&&(n.color=e.referencingColor,i.has(r)||i.set(r,!0))}))}))})),s.document.sharedTextStyles.forEach((function(i){i.getAllInstances().forEach((function(e){e.isOutOfSyncWithSharedStyle(i)||n.push({instance:e,style:i})}));var a=i.style;t.forEach((function(t){a.textColor==t.color&&(a.textColor=e.referencingColor,r.has(i)||r.set(i,!0))}))})),n.forEach((function(e){e.instance.syncWithSharedStyle(e.style)})),s.clog("Affected layer styles mapsize:"+i.size),s.clog("Affected text styles mapsize:"+r.size),[i.size,r.size]}(o,l),l.forEach((function(e){var t=-1;s.clog("Removing color variable "+e.name);for(var n=0;n<s.document.swatches.length;n++)s.document.swatches[n].id==e.id&&(t=n);t>-1&&s.document.swatches.splice(t,1)})),{layersUpdated:n,layerStylesUpdated:i[0],textStylesUpdated:i[1]}}function g(e){s.clog("----- Merge duplicate color variables -----");var t,i={identifier:l,width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},a=new r.a(i),c=a.webContents,u=[];function g(n){if(s.clog("Finding duplicate color variables. Including libraries:"+n),(t=s.getDuplicateColorVariables(e,n)).length>0){u=[];for(var i=0;i<t.length;i++)u.push({colorVariableWithDuplicates:t[i],selectedIndex:-1,isUnchecked:!1,isProcessed:0==i})}}g(s.getLibrariesEnabled()),t.length>0?a.loadURL(n(42)):(o.message("Looks like there are no color variables with the same name."),onShutdown(l)),a.once("ready-to-show",(function(){a.show()})),c.on("did-finish-load",(function(){s.clog("Webview loaded"),c.executeJavaScript("DrawColorVariablesList(".concat(JSON.stringify(u),", ").concat(s.getLibrariesEnabled(),")")).catch(console.error)})),c.on("nativeLog",(function(e){s.clog(e)})),c.on("Cancel",(function(){onShutdown(l)})),c.on("RecalculateDuplicates",(function(e){s.clog("Recalculating duplicates"),g(e),c.executeJavaScript("DrawColorVariablesList(".concat(JSON.stringify(u),")")).catch(console.error)})),c.on("GetSelectedStyleData",(function(e){c.executeJavaScript("ReDrawAfterGettingData(".concat(JSON.stringify(u[e].colorVariableWithDuplicates),",").concat(e,")")).catch(console.error)})),c.on("ExecuteMerge",(function(e){s.clog("Executing Merge");for(var t=0,n={layersUpdated:0,layerStylesUpdated:0,textStylesUpdated:0},i=0;i<e.length;i++)if(s.clog("-- Merging "+u[i].colorVariableWithDuplicates.name),!e[i].isUnchecked&&e[i].selectedIndex>=0){u[i].selectedIndex=e[i].selectedIndex,d=[];for(var r=0;r<u[i].colorVariableWithDuplicates.duplicates.length;r++)d.push(u[i].colorVariableWithDuplicates.duplicates[r]);var a=h(0,e[i].selectedIndex);n.layersUpdated+=a.layersUpdated,n.layerStylesUpdated+=a.layerStylesUpdated,n.textStylesUpdated+=a.textStylesUpdated,t++}if(onShutdown(l),t<=0)s.clog("No color variables were merged"),o.message("No color variables were merged");else{var c=y(n.layersUpdated,n.layerStylesUpdated,n.textStylesUpdated);s.clog(c),o.message(c)}}))}function m(e){s.clog("----- Merge selected color variables -----");var t,i,a={identifier:c,width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},l=new r.a(a),g=l.webContents,m=0;s.getLibrariesEnabled()||(s.clog("Get local color variables list"),m=(t=s.getDefinedColorVariables(e,!1)).length,u=!1),s.getLibrariesEnabled()&&(s.clog("Get all (including libraries) color variables list"),m=(i=s.getDefinedColorVariables(e,!0)).length,u=!0),m>1?l.loadURL(n(43)):(1==m?o.message("There's only 1 color variable. No need to merge."):o.message("Looks like there are no color variables."),onShutdown(c)),l.once("ready-to-show",(function(){l.show()})),g.on("did-finish-load",(function(){s.clog("Webview loaded"),s.getLibrariesEnabled()?g.executeJavaScript("DrawColorVariableList(".concat(JSON.stringify(i),",").concat(s.getLibrariesEnabled(),")")).catch(console.error):g.executeJavaScript("DrawColorVariableList(".concat(JSON.stringify(t),",").concat(s.getLibrariesEnabled(),")")).catch(console.error)})),g.on("nativeLog",(function(e){s.clog(e)})),g.on("GetLocalColorVariablesList",(function(){s.clog("Get local color variables list"),null==t&&(t=s.getDefinedColorVariables(e,!1)),u=!1,g.executeJavaScript("DrawColorVariableList(".concat(JSON.stringify(t),")")).catch(console.error)})),g.on("GetAllColorVariablesList",(function(){s.clog("Get all (including libraries) color variables list"),null==i&&(i=s.getDefinedColorVariables(e,!0)),u=!0,g.executeJavaScript("DrawStyleList(".concat(JSON.stringify(i),")")).catch(console.error)})),g.on("Cancel",(function(){onShutdown(c)})),g.on("ExecuteMerge",(function(e){s.clog("Executing Merge"),d=[];var n=-1,r=0;if(u)for(a=0;a<i.length;a++)i[a].isSelected=e[a].isSelected,i[a].isChosen=e[a].isChosen,e[a].isChosen&&(n=r),e[a].isSelected&&(d.push(i[a]),r++);else for(var a=0;a<t.length;a++)t[a].isSelected=e[a].isSelected,t[a].isChosen=e[a].isChosen,e[a].isChosen&&(n=r),e[a].isSelected&&(d.push(t[a]),r++);var l=h(0,n),g=y(l.layersUpdated,l.layerStylesUpdated,l.textStylesUpdated);s.clog(g),o.message(g),onShutdown(c)}))}function f(e){s.clog("----- Merge similar color variables -----");var t,i={identifier:"merge-similarcolorvariables.webview",width:1200,height:700,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},a=new r.a(i),l=a.webContents;s.clog("Loading webview"),a.loadURL(n(44)),a.once("ready-to-show",(function(){a.show()})),l.on("did-finish-load",(function(){s.clog("Webview loaded"),l.executeJavaScript("UpdateSettings(".concat(s.getLibrariesEnabled(),")")).catch(console.error),t=s.FindAllSimilarColorVariables(e,s.getLibrariesEnabled(),30),l.executeJavaScript("DrawResultsList(".concat(JSON.stringify(t),")")).catch(console.error)})),l.on("nativeLog",(function(e){s.clog(e)})),l.on("Cancel",(function(){onShutdown("merge-similarcolorvariables.webview")})),l.on("ExecuteMerge",(function(e){s.clog("Execute merge");for(var n=0,i={layersUpdated:0,layerStylesUpdated:0,textStylesUpdated:0},r=0;r<e.length;r++)if(!e[r].isUnchecked&&e[r].selectedIndex>=0){d=[];for(var a=0;a<e[r].similarStyles.length;a++)d.push(t[r].similarStyles[a]);var l=h(0,e[r].selectedIndex);i.layersUpdated+=l.layersUpdated,i.layerStylesUpdated+=l.layerStylesUpdated,i.textStylesUpdated+=l.textStylesUpdated,n++}if(onShutdown("merge-similarcolorvariables.webview"),n<=0)s.clog("No styles were merged"),o.message("No styles were merged");else{var c=y(i.layersUpdated,i.layerStylesUpdated,i.textStylesUpdated);s.clog(c),o.message(c)}})),l.on("RecalculateVariables",(function(n,i){s.clog("Recalculate similar variables with tolerance: "+i),t=s.FindAllSimilarColorVariables(e,n,i),l.executeJavaScript("DrawResultsList(".concat(JSON.stringify(t),")")).catch(console.error)}))}function y(e,t,n){var i="Wow how! ";return i+=e>0&&t+n==0?"We updated "+e+" layer"+(e>1?"s":"")+", and no styles. Awesome!":e>0&&t+n>0?"We updated "+e+" layer"+(e>1?"s":"")+", and "+(t+n)+" style"+(t+n>1?"s":"")+". Awesome!":0==e&&t+n>0?"We updated "+(t+n)+" style"+(t+n>1?"s":"")+", and no layers. Awesome!":"We completed the merge. There were no layers or styles to update, though."}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/5b9dca5b970519309b935c62f9a34d96.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/7a50c71683330da060e9c8ee3faedb1b.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/9fc15b34bf9387522a40eb07674b617e.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"EditSettings",(function(){return l})),n.d(t,"onShutdown",(function(){return c}));var i,r=n(0),a=n.n(r),o=n(2),s=n(3);function l(e){var t={identifier:"merge-duplicates.webviewSettings",width:500,height:600,show:!1,remembersWindowFrame:!0,titleBarStyle:"hidden"},r=new a.a(t),o=r.webContents;r.loadURL(n(46)),i=s.getSettings(),r.once("ready-to-show",(function(){r.show()})),o.on("did-finish-load",(function(){o.executeJavaScript("AssignSettings(".concat(s.getLogsEnabled(),",").concat(s.getLibrariesEnabled(),")")).catch(console.error)})),o.on("nativeLog",(function(e){s.clog(e)})),o.on("Cancel",(function(){c("merge-duplicates.webviewSettings")})),o.on("AcceptSettings",(function(e,t){var n,r=["licenseKey","","startTime","path","mainPluginsFolderURL","/merge.json","writeTextToFile"];null!=i&&null!=i[r[0]]?n={licenseKey:r[1]+i[r[0]],logs:e,librariesEnabledByDefault:t}:null!=i&&null!=i[r[2]]&&(n={startTime:r[1]+i[r[2]],logs:e,librariesEnabledByDefault:t}),s[r[6]](n,MSPluginManager[r[4]]()[r[3]]()+r[5]),c("merge-duplicates.webviewSettings")}))}function c(e){var t=Object(o.getWebview)(e);t&&t.close()}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/f3f11743bb33d3bc3aea9ff156d55959.html"},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/c1070e84f51788918e5b101b8ffa03f0.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"color",(function(){return b})),n.d(t,"rgb",(function(){return M})),n.d(t,"hsl",(function(){return _})),n.d(t,"lab",(function(){return A})),n.d(t,"hcl",(function(){return q})),n.d(t,"lch",(function(){return G})),n.d(t,"gray",(function(){return U})),n.d(t,"cubehelix",(function(){return ae}));var i=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function r(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function a(){}var o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),h=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),g=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),m=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),f=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function S(){return this.rgb().formatRgb()}function b(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?v(t):3===n?new N(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?new N(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?new N(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new N(t[1],t[2],t[3],1):(t=d.exec(e))?new N(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=h.exec(e))?w(t[1],t[2],t[3],t[4]):(t=g.exec(e))?w(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=m.exec(e))?L(t[1],t[2]/100,t[3]/100,1):(t=f.exec(e))?L(t[1],t[2]/100,t[3]/100,t[4]):y.hasOwnProperty(e)?v(y[e]):"transparent"===e?new N(NaN,NaN,NaN,0):null}function v(e){return new N(e>>16&255,e>>8&255,255&e,1)}function w(e,t,n,i){return i<=0&&(e=t=n=NaN),new N(e,t,n,i)}function x(e){return e instanceof a||(e=b(e)),e?new N((e=e.rgb()).r,e.g,e.b,e.opacity):new N}function M(e,t,n,i){return 1===arguments.length?x(e):new N(e,t,n,null==i?1:i)}function N(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function C(){return"#"+E(this.r)+E(this.g)+E(this.b)}function k(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function E(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function L(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new D(e,t,n,i)}function F(e){if(e instanceof D)return new D(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=b(e)),!e)return new D;if(e instanceof D)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,c=(o+r)/2;return l?(s=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=c<.5?o+r:2-o-r,s*=60):l=c>0&&c<1?0:s,new D(s,l,c,e.opacity)}function _(e,t,n,i){return 1===arguments.length?F(e):new D(e,t,n,null==i?1:i)}function D(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function R(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}i(a,b,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return F(this).formatHsl()},formatRgb:S,toString:S}),i(N,M,r(a,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new N(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new N(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:k,toString:k})),i(D,_,r(a,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new D(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new D(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new N(R(e>=240?e-240:e+120,r,i),R(e,r,i),R(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var O=Math.PI/180,I=180/Math.PI,T=6/29,P=3*T*T;function W(e){if(e instanceof B)return new B(e.l,e.a,e.b,e.opacity);if(e instanceof K)return Z(e);e instanceof N||(e=x(e));var t,n,i=H(e.r),r=H(e.g),a=H(e.b),o=V((.2225045*i+.7168786*r+.0606169*a)/1);return i===r&&r===a?t=n=o:(t=V((.4360747*i+.3850649*r+.1430804*a)/.96422),n=V((.0139322*i+.0971045*r+.7141733*a)/.82521)),new B(116*o-16,500*(t-o),200*(o-n),e.opacity)}function U(e,t){return new B(e,0,0,null==t?1:t)}function A(e,t,n,i){return 1===arguments.length?W(e):new B(e,t,n,null==i?1:i)}function B(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function V(e){return e>.008856451679035631?Math.pow(e,1/3):e/P+4/29}function J(e){return e>T?e*e*e:P*(e-4/29)}function z(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function H(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function j(e){if(e instanceof K)return new K(e.h,e.c,e.l,e.opacity);if(e instanceof B||(e=W(e)),0===e.a&&0===e.b)return new K(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*I;return new K(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function G(e,t,n,i){return 1===arguments.length?j(e):new K(n,t,e,null==i?1:i)}function q(e,t,n,i){return 1===arguments.length?j(e):new K(e,t,n,null==i?1:i)}function K(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function Z(e){if(isNaN(e.h))return new B(e.l,0,0,e.opacity);var t=e.h*O;return new B(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}i(B,A,r(a,{brighter:function(e){return new B(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new B(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new N(z(3.1338561*(t=.96422*J(t))-1.6168667*(e=1*J(e))-.4906146*(n=.82521*J(n))),z(-.9787684*t+1.9161415*e+.033454*n),z(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),i(K,q,r(a,{brighter:function(e){return new K(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new K(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Z(this).rgb()}}));var X=-.14861,Y=1.78277,$=-.29227,Q=-.90649,ee=1.97294,te=ee*Q,ne=ee*Y,ie=Y*$-Q*X;function re(e){if(e instanceof oe)return new oe(e.h,e.s,e.l,e.opacity);e instanceof N||(e=x(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(ie*i+te*t-ne*n)/(ie+te-ne),a=i-r,o=(ee*(n-r)-$*a)/Q,s=Math.sqrt(o*o+a*a)/(ee*r*(1-r)),l=s?Math.atan2(o,a)*I-120:NaN;return new oe(l<0?l+360:l,s,r,e.opacity)}function ae(e,t,n,i){return 1===arguments.length?re(e):new oe(e,t,n,null==i?1:i)}function oe(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}i(oe,ae,r(a,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new oe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new oe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*O,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new N(255*(t+n*(X*i+Y*r)),255*(t+n*($*i+Q*r)),255*(t+n*(ee*i)),this.opacity)}}))}]);if("default"===key&&"function"==typeof exports)exports(context);else{if("function"!=typeof exports[key])throw new Error('Missing export named "'+key+'". Your command should contain something like `export function " + key +"() {}`.');exports[key](context)}}catch(err){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw err;process.emit("uncaughtException",err,"uncaughtException")}}globalThis.MergeDuplicateSymbols=__skpm_run.bind(this,"MergeDuplicateSymbols"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.onRun=__skpm_run.bind(this,"default"),globalThis.MergeSelectedSymbols=__skpm_run.bind(this,"MergeSelectedSymbols"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSelectedTextStyles=__skpm_run.bind(this,"MergeSelectedTextStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSimilarTextStyles=__skpm_run.bind(this,"MergeSimilarTextStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSimilarLayerStyles=__skpm_run.bind(this,"MergeSimilarLayerStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSelectedLayerStyles=__skpm_run.bind(this,"MergeSelectedLayerStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeDuplicateLayerStyles=__skpm_run.bind(this,"MergeDuplicateLayerStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeDuplicateTextStyles=__skpm_run.bind(this,"MergeDuplicateTextStyles"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeDuplicateColorVariables=__skpm_run.bind(this,"MergeDuplicateColorVariables"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSelectedColorVariables=__skpm_run.bind(this,"MergeSelectedColorVariables"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.MergeSimilarColorVariables=__skpm_run.bind(this,"MergeSimilarColorVariables"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.EditSettings=__skpm_run.bind(this,"EditSettings"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown");